<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Updating: A Set of Bayesian Notes</title>
  <meta name="description" content="Updating: A Set of Bayesian Notes">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Updating: A Set of Bayesian Notes" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://jrnold.github.io/bayesian_notes" />
  
  
  <meta name="github-repo" content="jrnold/bayesian_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Updating: A Set of Bayesian Notes" />
  <meta name="twitter:site" content="@jrnld" />
  
  

<meta name="author" content="Jeffrey B. Arnold">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="model-comparison.html">
<link rel="next" href="generalized-linear-models.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/d3-3.3.8/d3.min.js"></script>
<script src="libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/chromatography-0.1/chromatography.js"></script>
<script src="libs/DiagrammeR-binding-1.0.0/DiagrammeR.js"></script>
<script src="libs/viz-0.3/viz.js"></script>
<script src="libs/grViz-binding-1.0.0/grViz.js"></script>



<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Bayesian Notes</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>1</b> Bayesian Inference</a><ul>
<li class="chapter" data-level="1.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html#bayesian-analysis"><i class="fa fa-check"></i><b>1.1</b> Bayesian Analysis</a></li>
<li class="chapter" data-level="1.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html#posterior-predictive-distribution"><i class="fa fa-check"></i><b>1.2</b> Posterior Predictive Distribution</a></li>
</ul></li>
<li class="part"><span><b>I Theory</b></span></li>
<li class="chapter" data-level="2" data-path="bayes-theorem.html"><a href="bayes-theorem.html"><i class="fa fa-check"></i><b>2</b> Bayes Theorem</a><ul>
<li class="chapter" data-level="" data-path="bayes-theorem.html"><a href="bayes-theorem.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="2.1" data-path="bayes-theorem.html"><a href="bayes-theorem.html#introduction-to-bayes-theorem"><i class="fa fa-check"></i><b>2.1</b> Introduction to Bayes’ Theorem</a></li>
<li class="chapter" data-level="2.2" data-path="bayes-theorem.html"><a href="bayes-theorem.html#examples"><i class="fa fa-check"></i><b>2.2</b> Examples</a><ul>
<li class="chapter" data-level="2.2.1" data-path="bayes-theorem.html"><a href="bayes-theorem.html#taxi-cab-problem"><i class="fa fa-check"></i><b>2.2.1</b> Taxi-Cab Problem</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="bayes-theorem.html"><a href="bayes-theorem.html#why-most-research-findings-are-false"><i class="fa fa-check"></i><b>2.3</b> Why most research findings are false</a><ul>
<li class="chapter" data-level="2.3.1" data-path="bayes-theorem.html"><a href="bayes-theorem.html#questions"><i class="fa fa-check"></i><b>2.3.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="bayes-theorem.html"><a href="bayes-theorem.html#measurement-error-and-rare-events-in-surveys"><i class="fa fa-check"></i><b>2.4</b> Measurement Error and Rare Events in Surveys</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html"><i class="fa fa-check"></i><b>3</b> Example: Predicting Names from Ages</a><ul>
<li class="chapter" data-level="" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="3.1" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#statement-of-the-problem"><i class="fa fa-check"></i><b>3.1</b> Statement of the problem</a></li>
<li class="chapter" data-level="3.2" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#data-wrangling"><i class="fa fa-check"></i><b>3.2</b> Data Wrangling</a></li>
<li class="chapter" data-level="3.3" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#probability-of-age-given-name-and-sex"><i class="fa fa-check"></i><b>3.3</b> Probability of age given name and sex</a><ul>
<li class="chapter" data-level="3.3.1" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#questions-1"><i class="fa fa-check"></i><b>3.3.1</b> Questions</a></li>
<li class="chapter" data-level="3.3.2" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#references"><i class="fa fa-check"></i><b>3.3.2</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i><b>4</b> Naive Bayes</a><ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#prerequisites-2"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="4.1" data-path="naive-bayes.html"><a href="naive-bayes.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="naive-bayes.html"><a href="naive-bayes.html#examples-1"><i class="fa fa-check"></i><b>4.2</b> Examples</a><ul>
<li class="chapter" data-level="4.2.1" data-path="naive-bayes.html"><a href="naive-bayes.html#federalist-papers"><i class="fa fa-check"></i><b>4.2.1</b> Federalist Papers</a></li>
<li class="chapter" data-level="4.2.2" data-path="naive-bayes.html"><a href="naive-bayes.html#extensions"><i class="fa fa-check"></i><b>4.2.2</b> Extensions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="naive-bayes.html"><a href="naive-bayes.html#details"><i class="fa fa-check"></i><b>4.3</b> Details</a><ul>
<li class="chapter" data-level="4.3.1" data-path="naive-bayes.html"><a href="naive-bayes.html#generative-vs.discriminative-models"><i class="fa fa-check"></i><b>4.3.1</b> Generative vs. Discriminative Models</a></li>
<li class="chapter" data-level="4.3.2" data-path="naive-bayes.html"><a href="naive-bayes.html#estimation"><i class="fa fa-check"></i><b>4.3.2</b> Estimation</a></li>
<li class="chapter" data-level="4.3.3" data-path="naive-bayes.html"><a href="naive-bayes.html#prediction"><i class="fa fa-check"></i><b>4.3.3</b> Prediction</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="naive-bayes.html"><a href="naive-bayes.html#references-1"><i class="fa fa-check"></i><b>4.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="priors.html"><a href="priors.html"><i class="fa fa-check"></i><b>5</b> Priors</a><ul>
<li class="chapter" data-level="5.1" data-path="priors.html"><a href="priors.html#levels-of-priors"><i class="fa fa-check"></i><b>5.1</b> Levels of Priors</a></li>
<li class="chapter" data-level="5.2" data-path="priors.html"><a href="priors.html#conjugate-priors"><i class="fa fa-check"></i><b>5.2</b> Conjugate Priors</a><ul>
<li class="chapter" data-level="5.2.1" data-path="priors.html"><a href="priors.html#binomial-beta"><i class="fa fa-check"></i><b>5.2.1</b> Binomial-Beta</a></li>
<li class="chapter" data-level="5.2.2" data-path="priors.html"><a href="priors.html#categorical-dirichlet"><i class="fa fa-check"></i><b>5.2.2</b> Categorical-Dirichlet</a></li>
<li class="chapter" data-level="5.2.3" data-path="priors.html"><a href="priors.html#poisson-gamma"><i class="fa fa-check"></i><b>5.2.3</b> Poisson-Gamma</a></li>
<li class="chapter" data-level="5.2.4" data-path="priors.html"><a href="priors.html#normal-with-known-variance"><i class="fa fa-check"></i><b>5.2.4</b> Normal with known variance</a></li>
<li class="chapter" data-level="5.2.5" data-path="priors.html"><a href="priors.html#exponential-family"><i class="fa fa-check"></i><b>5.2.5</b> Exponential Family</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="priors.html"><a href="priors.html#improper-priors"><i class="fa fa-check"></i><b>5.3</b> Improper Priors</a></li>
<li class="chapter" data-level="5.4" data-path="priors.html"><a href="priors.html#cromwells-rule"><i class="fa fa-check"></i><b>5.4</b> Cromwell’s Rule</a></li>
<li class="chapter" data-level="5.5" data-path="priors.html"><a href="priors.html#asymptotics"><i class="fa fa-check"></i><b>5.5</b> Asymptotics</a></li>
<li class="chapter" data-level="5.6" data-path="priors.html"><a href="priors.html#proper-and-improper-priors"><i class="fa fa-check"></i><b>5.6</b> Proper and Improper Priors</a></li>
<li class="chapter" data-level="5.7" data-path="priors.html"><a href="priors.html#hyperpriors-and-hyperparameters"><i class="fa fa-check"></i><b>5.7</b> Hyperpriors and Hyperparameters</a></li>
<li class="chapter" data-level="5.8" data-path="priors.html"><a href="priors.html#references-2"><i class="fa fa-check"></i><b>5.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="estimation-1.html"><a href="estimation-1.html"><i class="fa fa-check"></i><b>6</b> Estimation</a><ul>
<li class="chapter" data-level="6.1" data-path="estimation-1.html"><a href="estimation-1.html#point-estimates"><i class="fa fa-check"></i><b>6.1</b> Point Estimates</a></li>
<li class="chapter" data-level="6.2" data-path="estimation-1.html"><a href="estimation-1.html#credible-intervals"><i class="fa fa-check"></i><b>6.2</b> Credible Intervals</a><ul>
<li class="chapter" data-level="6.2.1" data-path="estimation-1.html"><a href="estimation-1.html#compared-to-confidence-intervals"><i class="fa fa-check"></i><b>6.2.1</b> Compared to confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="estimation-1.html"><a href="estimation-1.html#bayesian-decision-theory"><i class="fa fa-check"></i><b>6.3</b> Bayesian Decision Theory</a></li>
</ul></li>
<li class="part"><span><b>II Computation</b></span></li>
<li class="chapter" data-level="7" data-path="bayesian-computation.html"><a href="bayesian-computation.html"><i class="fa fa-check"></i><b>7</b> Bayesian Computation</a><ul>
<li class="chapter" data-level="7.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#how-to-calculate-a-posterior"><i class="fa fa-check"></i><b>7.1</b> How to calculate a posterior?</a></li>
<li class="chapter" data-level="7.2" data-path="bayesian-computation.html"><a href="bayesian-computation.html#example-globe-tossing-model"><i class="fa fa-check"></i><b>7.2</b> Example: Globe-tossing model</a></li>
<li class="chapter" data-level="7.3" data-path="bayesian-computation.html"><a href="bayesian-computation.html#quadrature"><i class="fa fa-check"></i><b>7.3</b> Quadrature</a><ul>
<li class="chapter" data-level="7.3.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#grid-approximation"><i class="fa fa-check"></i><b>7.3.1</b> Grid approximation</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="bayesian-computation.html"><a href="bayesian-computation.html#functional-approximations"><i class="fa fa-check"></i><b>7.4</b> Functional Approximations</a><ul>
<li class="chapter" data-level="7.4.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#maximum-a-posteriori"><i class="fa fa-check"></i><b>7.4.1</b> Maximum A Posteriori</a></li>
<li class="chapter" data-level="7.4.2" data-path="bayesian-computation.html"><a href="bayesian-computation.html#laplace-approximation"><i class="fa fa-check"></i><b>7.4.2</b> Laplace Approximation</a></li>
<li class="chapter" data-level="7.4.3" data-path="bayesian-computation.html"><a href="bayesian-computation.html#variational-inference"><i class="fa fa-check"></i><b>7.4.3</b> Variational Inference</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="bayesian-computation.html"><a href="bayesian-computation.html#sampling-methods"><i class="fa fa-check"></i><b>7.5</b> Sampling Methods</a><ul>
<li class="chapter" data-level="7.5.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#numerical-integration"><i class="fa fa-check"></i><b>7.5.1</b> Numerical Integration</a></li>
<li class="chapter" data-level="7.5.2" data-path="bayesian-computation.html"><a href="bayesian-computation.html#inverse-transform-sampling"><i class="fa fa-check"></i><b>7.5.2</b> Inverse transform sampling</a></li>
<li class="chapter" data-level="7.5.3" data-path="bayesian-computation.html"><a href="bayesian-computation.html#direct-approximation"><i class="fa fa-check"></i><b>7.5.3</b> Direct approximation</a></li>
<li class="chapter" data-level="7.5.4" data-path="bayesian-computation.html"><a href="bayesian-computation.html#rejection-sampling"><i class="fa fa-check"></i><b>7.5.4</b> Rejection sampling</a></li>
<li class="chapter" data-level="7.5.5" data-path="bayesian-computation.html"><a href="bayesian-computation.html#importance-sampling"><i class="fa fa-check"></i><b>7.5.5</b> Importance Sampling</a></li>
<li class="chapter" data-level="7.5.6" data-path="bayesian-computation.html"><a href="bayesian-computation.html#mcmc-methods"><i class="fa fa-check"></i><b>7.5.6</b> MCMC Methods</a></li>
<li class="chapter" data-level="7.5.7" data-path="bayesian-computation.html"><a href="bayesian-computation.html#discarding-early-iterations"><i class="fa fa-check"></i><b>7.5.7</b> Discarding early iterations</a></li>
<li class="chapter" data-level="7.5.8" data-path="bayesian-computation.html"><a href="bayesian-computation.html#monte-carlo-sampling"><i class="fa fa-check"></i><b>7.5.8</b> Monte Carlo Sampling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html"><i class="fa fa-check"></i><b>8</b> MCMC Diagnostics</a><ul>
<li class="chapter" data-level="" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="8.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#reparameterize-models"><i class="fa fa-check"></i><b>8.1</b> Reparameterize Models</a></li>
<li class="chapter" data-level="8.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#convergence-diagnostics"><i class="fa fa-check"></i><b>8.2</b> Convergence Diagnostics</a><ul>
<li class="chapter" data-level="8.2.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#potential-scale-reduction-hatr"><i class="fa fa-check"></i><b>8.2.1</b> Potential Scale Reduction (<span class="math inline">\(\hat{R}\)</span>)</a></li>
<li class="chapter" data-level="8.2.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#references-3"><i class="fa fa-check"></i><b>8.2.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#autocorrelation-effective-sample-size-and-mcse"><i class="fa fa-check"></i><b>8.3</b> Autocorrelation, Effective Sample Size, and MCSE</a><ul>
<li class="chapter" data-level="8.3.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#effective-sample-size"><i class="fa fa-check"></i><b>8.3.1</b> Effective Sample Size</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#thinning"><i class="fa fa-check"></i><b>8.4</b> Thinning</a><ul>
<li class="chapter" data-level="8.4.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#traceplots"><i class="fa fa-check"></i><b>8.4.1</b> Traceplots</a></li>
<li class="chapter" data-level="8.4.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#monte-carlo-standard-error-mcse"><i class="fa fa-check"></i><b>8.4.2</b> Monte Carlo Standard Error (MCSE)</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#hmc-nut-specific-diagnostics"><i class="fa fa-check"></i><b>8.5</b> HMC-NUT Specific Diagnostics</a><ul>
<li class="chapter" data-level="8.5.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#divergent-transitions"><i class="fa fa-check"></i><b>8.5.1</b> Divergent transitions</a></li>
<li class="chapter" data-level="8.5.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#maximum-tree-depth"><i class="fa fa-check"></i><b>8.5.2</b> Maximum Tree-depth</a></li>
<li class="chapter" data-level="8.5.3" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#bayesian-fraction-of-missing-information"><i class="fa fa-check"></i><b>8.5.3</b> Bayesian Fraction of Missing Information</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#debugging-bayesian-computing"><i class="fa fa-check"></i><b>8.6</b> Debugging Bayesian Computing</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="model-checking.html"><a href="model-checking.html"><i class="fa fa-check"></i><b>9</b> Model Checking</a><ul>
<li class="chapter" data-level="9.1" data-path="model-checking.html"><a href="model-checking.html#why-check-models"><i class="fa fa-check"></i><b>9.1</b> Why check models?</a></li>
<li class="chapter" data-level="9.2" data-path="model-checking.html"><a href="model-checking.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>9.2</b> Posterior Predictive Checks</a><ul>
<li class="chapter" data-level="9.2.1" data-path="model-checking.html"><a href="model-checking.html#bayesian-p-values"><i class="fa fa-check"></i><b>9.2.1</b> Bayesian p-values</a></li>
<li class="chapter" data-level="9.2.2" data-path="model-checking.html"><a href="model-checking.html#test-quantities"><i class="fa fa-check"></i><b>9.2.2</b> Test quantities</a></li>
<li class="chapter" data-level="9.2.3" data-path="model-checking.html"><a href="model-checking.html#p-values-vs.u-values"><i class="fa fa-check"></i><b>9.2.3</b> p-values vs. u-values</a></li>
<li class="chapter" data-level="9.2.4" data-path="model-checking.html"><a href="model-checking.html#marginal-predictive-checks"><i class="fa fa-check"></i><b>9.2.4</b> Marginal predictive checks</a></li>
<li class="chapter" data-level="9.2.5" data-path="model-checking.html"><a href="model-checking.html#outliers"><i class="fa fa-check"></i><b>9.2.5</b> Outliers</a></li>
<li class="chapter" data-level="9.2.6" data-path="model-checking.html"><a href="model-checking.html#graphical-posterior-predictive-checks"><i class="fa fa-check"></i><b>9.2.6</b> Graphical Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="model-checking.html"><a href="model-checking.html#references-4"><i class="fa fa-check"></i><b>9.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>10</b> Model Comparison</a><ul>
<li class="chapter" data-level="10.1" data-path="model-comparison.html"><a href="model-comparison.html#models"><i class="fa fa-check"></i><b>10.1</b> Models</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison.html"><a href="model-comparison.html#classes-of-model-spaces"><i class="fa fa-check"></i><b>10.2</b> Classes of Model Spaces</a></li>
<li class="chapter" data-level="10.3" data-path="model-comparison.html"><a href="model-comparison.html#continuous-model-expansion"><i class="fa fa-check"></i><b>10.3</b> Continuous model expansion</a></li>
<li class="chapter" data-level="10.4" data-path="model-comparison.html"><a href="model-comparison.html#discrete-model-expansion"><i class="fa fa-check"></i><b>10.4</b> Discrete Model Expansion</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison.html"><a href="model-comparison.html#out-of-sample-predictive-accuracy"><i class="fa fa-check"></i><b>10.5</b> Out-of-sample predictive accuracy</a></li>
<li class="chapter" data-level="10.6" data-path="model-comparison.html"><a href="model-comparison.html#stacking"><i class="fa fa-check"></i><b>10.6</b> Stacking</a></li>
<li class="chapter" data-level="10.7" data-path="model-comparison.html"><a href="model-comparison.html#posterior-predictive-criteria"><i class="fa fa-check"></i><b>10.7</b> Posterior Predictive Criteria</a><ul>
<li class="chapter" data-level="10.7.1" data-path="model-comparison.html"><a href="model-comparison.html#summary-and-advice"><i class="fa fa-check"></i><b>10.7.1</b> Summary and Advice</a></li>
<li class="chapter" data-level="10.7.2" data-path="model-comparison.html"><a href="model-comparison.html#expected-log-predictive-density"><i class="fa fa-check"></i><b>10.7.2</b> Expected Log Predictive Density</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="model-comparison.html"><a href="model-comparison.html#bayesian-model-averaging"><i class="fa fa-check"></i><b>10.8</b> Bayesian Model Averaging</a></li>
<li class="chapter" data-level="10.9" data-path="model-comparison.html"><a href="model-comparison.html#pseudo-bma"><i class="fa fa-check"></i><b>10.9</b> Pseudo-BMA</a></li>
<li class="chapter" data-level="10.10" data-path="model-comparison.html"><a href="model-comparison.html#loo-cv-via-importance-sampling"><i class="fa fa-check"></i><b>10.10</b> LOO-CV via importance sampling</a></li>
<li class="chapter" data-level="10.11" data-path="model-comparison.html"><a href="model-comparison.html#selection-induced-bias"><i class="fa fa-check"></i><b>10.11</b> Selection induced Bias</a></li>
</ul></li>
<li class="part"><span><b>III Models</b></span></li>
<li class="chapter" data-level="11" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html"><i class="fa fa-check"></i><b>11</b> Introduction to Stan and Linear Regression</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#prerequisites-4"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="11.1" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#ols-and-mle-linear-regression"><i class="fa fa-check"></i><b>11.1</b> OLS and MLE Linear Regression</a><ul>
<li class="chapter" data-level="11.1.1" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#bayesian-model-with-improper-priors"><i class="fa fa-check"></i><b>11.1.1</b> Bayesian Model with Improper priors</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#stan-model"><i class="fa fa-check"></i><b>11.2</b> Stan Model</a></li>
<li class="chapter" data-level="11.3" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#sampling-model-with-stan"><i class="fa fa-check"></i><b>11.3</b> Sampling Model with Stan</a><ul>
<li class="chapter" data-level="11.3.1" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#sampling"><i class="fa fa-check"></i><b>11.3.1</b> Sampling</a></li>
<li class="chapter" data-level="11.3.2" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#convergence-diagnostics-and-model-fit"><i class="fa fa-check"></i><b>11.3.2</b> Convergence Diagnostics and Model Fit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>12</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#prerequisites-5"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="12.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#introduction-1"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#count-models"><i class="fa fa-check"></i><b>12.2</b> Count Models</a><ul>
<li class="chapter" data-level="12.2.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#poisson"><i class="fa fa-check"></i><b>12.2.1</b> Poisson</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#example-3"><i class="fa fa-check"></i><b>12.3</b> Example</a></li>
<li class="chapter" data-level="12.4" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#negative-binomial"><i class="fa fa-check"></i><b>12.4</b> Negative Binomial</a></li>
<li class="chapter" data-level="12.5" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#multinomial-categorical-models"><i class="fa fa-check"></i><b>12.5</b> Multinomial / Categorical Models</a></li>
<li class="chapter" data-level="12.6" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#gamma-regression"><i class="fa fa-check"></i><b>12.6</b> Gamma Regression</a></li>
<li class="chapter" data-level="12.7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#beta-regression"><i class="fa fa-check"></i><b>12.7</b> Beta Regression</a></li>
<li class="chapter" data-level="12.8" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#references-5"><i class="fa fa-check"></i><b>12.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="binomial-models.html"><a href="binomial-models.html"><i class="fa fa-check"></i><b>13</b> Binomial Models</a><ul>
<li class="chapter" data-level="" data-path="binomial-models.html"><a href="binomial-models.html#prerequisites-6"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="13.1" data-path="binomial-models.html"><a href="binomial-models.html#introduction-2"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="binomial-models.html"><a href="binomial-models.html#link-functions-link-function"><i class="fa fa-check"></i><b>13.2</b> Link Functions {link-function}</a><ul>
<li class="chapter" data-level="13.2.1" data-path="binomial-models.html"><a href="binomial-models.html#stan"><i class="fa fa-check"></i><b>13.2.1</b> Stan</a></li>
<li class="chapter" data-level="13.2.2" data-path="binomial-models.html"><a href="binomial-models.html#example-vote-turnout"><i class="fa fa-check"></i><b>13.2.2</b> Example: Vote Turnout</a></li>
<li class="chapter" data-level="13.2.3" data-path="binomial-models.html"><a href="binomial-models.html#stan-1"><i class="fa fa-check"></i><b>13.2.3</b> Stan</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="binomial-models.html"><a href="binomial-models.html#references-6"><i class="fa fa-check"></i><b>13.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="separtion.html"><a href="separtion.html"><i class="fa fa-check"></i><b>14</b> Separation</a><ul>
<li class="chapter" data-level="" data-path="separtion.html"><a href="separtion.html#prerequisites-7"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="14.1" data-path="separtion.html"><a href="separtion.html#introduction-3"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="separtion.html"><a href="separtion.html#complete-separation"><i class="fa fa-check"></i><b>14.2</b> Complete Separation</a></li>
<li class="chapter" data-level="14.3" data-path="separtion.html"><a href="separtion.html#quasi-separation"><i class="fa fa-check"></i><b>14.3</b> Quasi-Separation</a></li>
<li class="chapter" data-level="14.4" data-path="separtion.html"><a href="separtion.html#weak-priors"><i class="fa fa-check"></i><b>14.4</b> Weak Priors</a></li>
<li class="chapter" data-level="14.5" data-path="separtion.html"><a href="separtion.html#example-support-of-aca-medicaid-expansion"><i class="fa fa-check"></i><b>14.5</b> Example: Support of ACA Medicaid Expansion</a></li>
<li class="chapter" data-level="14.6" data-path="separtion.html"><a href="separtion.html#questions-2"><i class="fa fa-check"></i><b>14.6</b> Questions</a></li>
<li class="chapter" data-level="14.7" data-path="separtion.html"><a href="separtion.html#references-7"><i class="fa fa-check"></i><b>14.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="robust-regression.html"><a href="robust-regression.html"><i class="fa fa-check"></i><b>15</b> Robust Regression</a><ul>
<li class="chapter" data-level="" data-path="robust-regression.html"><a href="robust-regression.html#prerequisites-8"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="15.1" data-path="robust-regression.html"><a href="robust-regression.html#wide-tailed-distributions"><i class="fa fa-check"></i><b>15.1</b> Wide Tailed Distributions</a></li>
<li class="chapter" data-level="15.2" data-path="robust-regression.html"><a href="robust-regression.html#student-t-distribution"><i class="fa fa-check"></i><b>15.2</b> Student-t distribution</a><ul>
<li class="chapter" data-level="15.2.1" data-path="robust-regression.html"><a href="robust-regression.html#examples-2"><i class="fa fa-check"></i><b>15.2.1</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="robust-regression.html"><a href="robust-regression.html#robit"><i class="fa fa-check"></i><b>15.3</b> Robit</a></li>
<li class="chapter" data-level="15.4" data-path="robust-regression.html"><a href="robust-regression.html#quantile-regression"><i class="fa fa-check"></i><b>15.4</b> Quantile regression</a><ul>
<li class="chapter" data-level="15.4.1" data-path="robust-regression.html"><a href="robust-regression.html#questions-3"><i class="fa fa-check"></i><b>15.4.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="robust-regression.html"><a href="robust-regression.html#references-8"><i class="fa fa-check"></i><b>15.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html"><i class="fa fa-check"></i><b>16</b> Heteroskedasticity</a><ul>
<li class="chapter" data-level="" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#prerequisites-9"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="16.1" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#introduction-4"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#weighted-regression"><i class="fa fa-check"></i><b>16.2</b> Weighted Regression</a></li>
<li class="chapter" data-level="16.3" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#modeling-the-scale-with-covariates"><i class="fa fa-check"></i><b>16.3</b> Modeling the Scale with Covariates</a></li>
<li class="chapter" data-level="16.4" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#prior-distributions"><i class="fa fa-check"></i><b>16.4</b> Prior Distributions</a><ul>
<li class="chapter" data-level="16.4.1" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#examples-duncan"><i class="fa fa-check"></i><b>16.4.1</b> Examples: Duncan</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#exercises"><i class="fa fa-check"></i><b>16.5</b> Exercises</a></li>
<li class="chapter" data-level="16.6" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#references-9"><i class="fa fa-check"></i><b>16.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="rare-events.html"><a href="rare-events.html"><i class="fa fa-check"></i><b>17</b> Rare Events</a><ul>
<li class="chapter" data-level="" data-path="rare-events.html"><a href="rare-events.html#prerequisites-10"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="17.1" data-path="rare-events.html"><a href="rare-events.html#introduction-5"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="rare-events.html"><a href="rare-events.html#finite-sample-bias"><i class="fa fa-check"></i><b>17.2</b> Finite-Sample Bias</a></li>
<li class="chapter" data-level="17.3" data-path="rare-events.html"><a href="rare-events.html#case-control"><i class="fa fa-check"></i><b>17.3</b> Case Control</a></li>
<li class="chapter" data-level="17.4" data-path="rare-events.html"><a href="rare-events.html#questions-4"><i class="fa fa-check"></i><b>17.4</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="shrinkage-and-hierarchical-models.html"><a href="shrinkage-and-hierarchical-models.html"><i class="fa fa-check"></i><b>18</b> Shrinkage and Hierarchical Models</a><ul>
<li class="chapter" data-level="18.1" data-path="shrinkage-and-hierarchical-models.html"><a href="shrinkage-and-hierarchical-models.html#hierarchical-models"><i class="fa fa-check"></i><b>18.1</b> Hierarchical Models</a></li>
<li class="chapter" data-level="18.2" data-path="shrinkage-and-hierarchical-models.html"><a href="shrinkage-and-hierarchical-models.html#baseball-hits"><i class="fa fa-check"></i><b>18.2</b> Baseball Hits</a><ul>
<li class="chapter" data-level="18.2.1" data-path="shrinkage-and-hierarchical-models.html"><a href="shrinkage-and-hierarchical-models.html#references-10"><i class="fa fa-check"></i><b>18.2.1</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html"><i class="fa fa-check"></i><b>19</b> Shrinkage and Regularized Regression</a><ul>
<li class="chapter" data-level="" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#prerequisites-11"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="19.1" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#introduction-6"><i class="fa fa-check"></i><b>19.1</b> Introduction</a></li>
<li class="chapter" data-level="19.2" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#penalized-maximum-likelihood-regression"><i class="fa fa-check"></i><b>19.2</b> Penalized Maximum Likelihood Regression</a><ul>
<li class="chapter" data-level="19.2.1" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#ridge-regression"><i class="fa fa-check"></i><b>19.2.1</b> Ridge Regression</a></li>
<li class="chapter" data-level="19.2.2" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#lasso"><i class="fa fa-check"></i><b>19.2.2</b> Lasso</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#bayesian-shrinkage"><i class="fa fa-check"></i><b>19.3</b> Bayesian Shrinkage</a><ul>
<li class="chapter" data-level="19.3.1" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#priors-1"><i class="fa fa-check"></i><b>19.3.1</b> Priors</a></li>
<li class="chapter" data-level="19.3.2" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#hiearchical-coefficient-priors"><i class="fa fa-check"></i><b>19.3.2</b> Hiearchical Coefficient Priors</a></li>
<li class="chapter" data-level="19.3.3" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#laplace-distribution"><i class="fa fa-check"></i><b>19.3.3</b> Laplace Distribution</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#student-t-and-cauchy-distributions"><i class="fa fa-check"></i><b>19.4</b> Student-t and Cauchy Distributions</a></li>
<li class="chapter" data-level="19.5" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#horseshore-and-hierarchical-priors"><i class="fa fa-check"></i><b>19.5</b> Horseshore and Hierarchical Priors</a></li>
<li class="chapter" data-level="19.6" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#understanding-shrinkage-models"><i class="fa fa-check"></i><b>19.6</b> Understanding Shrinkage Models</a></li>
<li class="chapter" data-level="19.7" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#spike-and-slab-prior"><i class="fa fa-check"></i><b>19.7</b> Spike and Slab prior</a></li>
<li class="chapter" data-level="19.8" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#number-of-effective-zeros"><i class="fa fa-check"></i><b>19.8</b> Number of effective zeros</a></li>
<li class="chapter" data-level="19.9" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#choice-of-hyperparameter-on-tau"><i class="fa fa-check"></i><b>19.9</b> Choice of Hyperparameter on <span class="math inline">\(\tau\)</span></a></li>
<li class="chapter" data-level="19.10" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#all-coefficients"><i class="fa fa-check"></i><b>19.10</b> All Coefficients</a><ul>
<li class="chapter" data-level="19.10.1" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#zellners-g-prior"><i class="fa fa-check"></i><b>19.10.1</b> Zellner’s g-prior</a></li>
<li class="chapter" data-level="19.10.2" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#q-r-prior"><i class="fa fa-check"></i><b>19.10.2</b> Q-R Prior</a></li>
</ul></li>
<li class="chapter" data-level="19.11" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#differences-between-bayesian-and-penalized-ml"><i class="fa fa-check"></i><b>19.11</b> Differences between Bayesian and Penalized ML</a></li>
<li class="chapter" data-level="19.12" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#references-11"><i class="fa fa-check"></i><b>19.12</b> References</a></li>
</ul></li>
<li class="part"><span><b>IV Appendix</b></span><ul>
<li class="chapter" data-level="" data-path=""><a href="#prerequisites-12"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="19.13" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#parameters"><i class="fa fa-check"></i><b>19.13</b> Parameters</a></li>
<li class="chapter" data-level="19.14" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#miscellaneous-mathematical-background"><i class="fa fa-check"></i><b>19.14</b> Miscellaneous Mathematical Background</a><ul>
<li class="chapter" data-level="19.14.1" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#location-scale-families"><i class="fa fa-check"></i><b>19.14.1</b> Location-Scale Families</a></li>
<li class="chapter" data-level="19.14.2" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#scale-mixtures-of-normal-distributions"><i class="fa fa-check"></i><b>19.14.2</b> Scale Mixtures of Normal Distributions</a></li>
<li class="chapter" data-level="19.14.3" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#covariance-correlation-matrix-decomposition"><i class="fa fa-check"></i><b>19.14.3</b> Covariance-Correlation Matrix Decomposition</a></li>
<li class="chapter" data-level="19.14.4" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#qr-factorization"><i class="fa fa-check"></i><b>19.14.4</b> QR Factorization</a></li>
<li class="chapter" data-level="19.14.5" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#cholesky-decomposition"><i class="fa fa-check"></i><b>19.14.5</b> Cholesky Decomposition</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="scaled-and-unscaled-variables.html"><a href="scaled-and-unscaled-variables.html"><i class="fa fa-check"></i><b>20</b> Scaled and Unscaled Variables</a></li>
<li class="chapter" data-level="21" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>21</b> Distributions</a></li>
<li class="chapter" data-level="22" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html"><i class="fa fa-check"></i><b>22</b> Annotated Bibliography</a><ul>
<li class="chapter" data-level="22.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#textbooks"><i class="fa fa-check"></i><b>22.1</b> Textbooks</a></li>
<li class="chapter" data-level="22.2" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#syllabi"><i class="fa fa-check"></i><b>22.2</b> Syllabi</a></li>
<li class="chapter" data-level="22.3" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#topics"><i class="fa fa-check"></i><b>22.3</b> Topics</a></li>
<li class="chapter" data-level="22.4" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayes-theorem-1"><i class="fa fa-check"></i><b>22.4</b> Bayes’ Theorem</a></li>
<li class="chapter" data-level="22.5" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#article-length-introductions-to-bayesian-statistics"><i class="fa fa-check"></i><b>22.5</b> Article Length Introductions to Bayesian Statistics</a><ul>
<li class="chapter" data-level="22.5.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#why-bayesian"><i class="fa fa-check"></i><b>22.5.1</b> Why Bayesian</a></li>
<li class="chapter" data-level="22.5.2" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#modern-statistical-workflow"><i class="fa fa-check"></i><b>22.5.2</b> Modern Statistical Workflow</a></li>
<li class="chapter" data-level="22.5.3" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-philosophy"><i class="fa fa-check"></i><b>22.5.3</b> Bayesian Philosophy</a></li>
<li class="chapter" data-level="22.5.4" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-hypothesis-testing"><i class="fa fa-check"></i><b>22.5.4</b> Bayesian Hypothesis Testing</a></li>
<li class="chapter" data-level="22.5.5" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-frequentist-debates"><i class="fa fa-check"></i><b>22.5.5</b> Bayesian Frequentist Debates</a></li>
<li class="chapter" data-level="22.5.6" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#categorical"><i class="fa fa-check"></i><b>22.5.6</b> Categorical</a></li>
<li class="chapter" data-level="22.5.7" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#variable-selection"><i class="fa fa-check"></i><b>22.5.7</b> Variable Selection</a></li>
<li class="chapter" data-level="22.5.8" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#multiple-testing"><i class="fa fa-check"></i><b>22.5.8</b> Multiple Testing</a></li>
<li class="chapter" data-level="22.5.9" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#rare-events-1"><i class="fa fa-check"></i><b>22.5.9</b> Rare Events</a></li>
<li class="chapter" data-level="22.5.10" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#identifiability"><i class="fa fa-check"></i><b>22.5.10</b> Identifiability</a></li>
<li class="chapter" data-level="22.5.11" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#shrinkage"><i class="fa fa-check"></i><b>22.5.11</b> Shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#software"><i class="fa fa-check"></i><b>22.6</b> Software</a><ul>
<li class="chapter" data-level="22.6.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#stan-2"><i class="fa fa-check"></i><b>22.6.1</b> Stan</a></li>
<li class="chapter" data-level="22.6.2" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#diagrams"><i class="fa fa-check"></i><b>22.6.2</b> Diagrams</a></li>
<li class="chapter" data-level="22.6.3" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#priors-2"><i class="fa fa-check"></i><b>22.6.3</b> Priors</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-model-averaging-1"><i class="fa fa-check"></i><b>22.7</b> Bayesian Model Averaging</a></li>
<li class="chapter" data-level="22.8" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#multilevel-modeling"><i class="fa fa-check"></i><b>22.8</b> Multilevel Modeling</a></li>
<li class="chapter" data-level="22.9" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#mixture-models"><i class="fa fa-check"></i><b>22.9</b> Mixture Models</a></li>
<li class="chapter" data-level="22.10" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#inference"><i class="fa fa-check"></i><b>22.10</b> Inference</a><ul>
<li class="chapter" data-level="22.10.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#discussion-of-bayesian-inference"><i class="fa fa-check"></i><b>22.10.1</b> Discussion of Bayesian Inference</a></li>
</ul></li>
<li class="chapter" data-level="22.11" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#model-checking-1"><i class="fa fa-check"></i><b>22.11</b> Model Checking</a><ul>
<li class="chapter" data-level="22.11.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#posterior-predictive-checks-1"><i class="fa fa-check"></i><b>22.11.1</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="22.11.2" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#prediction-criteria"><i class="fa fa-check"></i><b>22.11.2</b> Prediction Criteria</a></li>
<li class="chapter" data-level="22.11.3" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#software-validation"><i class="fa fa-check"></i><b>22.11.3</b> Software Validation</a></li>
</ul></li>
<li class="chapter" data-level="22.12" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#hierarchical-modeling"><i class="fa fa-check"></i><b>22.12</b> Hierarchical Modeling</a></li>
<li class="chapter" data-level="22.13" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#shrinkageregularization"><i class="fa fa-check"></i><b>22.13</b> Shrinkage/Regularization</a></li>
<li class="chapter" data-level="22.14" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#empirical-bayes"><i class="fa fa-check"></i><b>22.14</b> Empirical Bayes</a></li>
<li class="chapter" data-level="22.15" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#history-of-bayesian-statistics"><i class="fa fa-check"></i><b>22.15</b> History of Bayesian Statistics</a></li>
<li class="chapter" data-level="22.16" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#sampling-difficulties"><i class="fa fa-check"></i><b>22.16</b> Sampling Difficulties</a></li>
<li class="chapter" data-level="22.17" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#complicated-estimation-and-testing"><i class="fa fa-check"></i><b>22.17</b> Complicated Estimation and Testing</a></li>
<li class="chapter" data-level="22.18" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#pooling-polls"><i class="fa fa-check"></i><b>22.18</b> Pooling Polls</a></li>
<li class="chapter" data-level="22.19" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#visualizing-mcmc-methods"><i class="fa fa-check"></i><b>22.19</b> Visualizing MCMC Methods</a></li>
<li class="chapter" data-level="22.20" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-point-estimation-decision"><i class="fa fa-check"></i><b>22.20</b> Bayesian point estimation / Decision</a></li>
<li class="chapter" data-level="22.21" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#stan-modeling-language"><i class="fa fa-check"></i><b>22.21</b> Stan Modeling Language</a></li>
<li class="chapter" data-level="22.22" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayes-factors"><i class="fa fa-check"></i><b>22.22</b> Bayes Factors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-12.html"><a href="references-12.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Updating: A Set of Bayesian Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
\[
\DeclareMathOperator{\E}{E}
\DeclareMathOperator{\mean}{mean}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Cor}{Cor}
\DeclareMathOperator{\Bias}{Bias}
\DeclareMathOperator{\MSE}{MSE}
\DeclareMathOperator{\RMSE}{RMSE}
\DeclareMathOperator{\sd}{sd}
\DeclareMathOperator{\se}{se}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\median}{median}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator{\logistic}{Logistic}
\DeclareMathOperator{\logit}{Logit}

\newcommand{\mat}[1]{\boldsymbol{#1}}
\newcommand{\vec}[1]{\boldsymbol{#1}}
\newcommand{\T}{'}

% This follows BDA
\newcommand{\dunif}{\mathrm{U}}
\newcommand{\dnorm}{\mathrm{N}}
\newcommand{\dlnorm}{\mathrm{lognormal}}
\newcommand{\dmvnorm}{\mathrm{N}}
\newcommand{\dgamma}{\mathrm{Gamma}}
\newcommand{\dinvgamma}{\mathrm{Inv-Gamma}}
\newcommand{\dchisq}[1]{\chi^2_{#1}}
\newcommand{\dinvchisq}[1]{\mathrm{Inv-}\chi^2_{#1}}
\newcommand{\dexp}{\mathrm{Expon}}
\newcommand{\dlaplace}{\mathrm{Laplace}}
\newcommand{\dweibull}{\mathrm{Weibull}}
\newcommand{\dwishart}[1]{\mathrm{Wishart}_{#1}}
\newcommand{\dinvwishart}[1]{\mathrm{Inv-Wishart}_{#1}}
\newcommand{\dlkj}{\mathrm{LkjCorr}}
\newcommand{\dt}{\mathrm{Student-t}}
\newcommand{\dbeta}{\mathrm{Beta}}
\newcommand{\ddirichlet}{\mathrm{Dirichlet}}
\newcommand{\dlogistic}{\mathrm{Logistic}}
\newcommand{\dllogistic}{\mathrm{Log-logistic}}
\newcommand{\dpois}{\mathrm{Poisson}}
\newcommand{\dBinom}{\mathrm{Bin}}
\newcommand{\dBinom}{\mathrm{Bin}}
\newcommand{\dmultinom}{\mathrm{Multinom}}
\newcommand{\dnbinom}{\mathrm{Neg-bin}}
\newcommand{\dnbinomalt}{\mathrm{Neg-bin2}}
\newcommand{\dbetabinom}{\mathrm{Beta-bin}}
\newcommand{\dcauchy}{\mathrm{Cauchy}}
\newcommand{\dhalfcauchy}{\mathrm{Cauchy}^{+}}
\newcommand{\dlkjcorr}{\mathrm{LKJ}^{+}}
\newcommand{\dbernoulli}{\mathrm{Bernoulli}}

\newcommand{\R}{\mathbb{R}}
\newcommand{\Reals}{\R}
\newcommand{\RealPos}{\R^{+}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Nats}{\N}

\newcommand{\cia}{\perp\!\!\!\perp}
\DeclareMathOperator*{\plim}{plim}

\DeclareMathOperator{\invlogit}{Inv-Logit}
\DeclareMathOperator{\logit}{Logit}

\]
<div id="introduction-to-stan-and-linear-regression" class="section level1">
<h1><span class="header-section-number">11</span> Introduction to Stan and Linear Regression</h1>
<p>This chapter is an introduction to writing and running a Stan model in R. Also see the <strong>rstan</strong> <a href="https://cran.r-project.org/web/packages/rstan/vignettes/rstan.html">vignette</a> for similar content.</p>
<div id="prerequisites-4" class="section level2 unnumbered">
<h2>Prerequisites</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;rstan&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;recipes&quot;</span>)</code></pre></div>
<p>For this section we will use the <code>duncan</code> dataset included in the <strong>carData</strong> package. Duncan’s occupational prestige data is an example dataset used throughout the popular Fox regression text, <em>Applied Regression Analysis and Generalized Linear Models</em> <span class="citation">(Fox 2016)</span>. It is originally from <span class="citation">Duncan (1961)</span> consists of survey data on the prestige of occupations in the US in 1950, and several predictors: type of occupation, income, and education of that</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;Duncan&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;carData&quot;</span>)</code></pre></div>
</div>
<div id="ols-and-mle-linear-regression" class="section level2">
<h2><span class="header-section-number">11.1</span> OLS and MLE Linear Regression</h2>
<p>The first step in running a Stan model is defining the Bayesian statistical model that will be used for inference.</p>
<p>We will model <code>prestige</code> of each occupation as a function of its <code>education</code>, <code>occupation</code>, and <code>type</code>.</p>
<p>A standard way to do this is with the OLS estimator: <span class="math display">\[
\begin{multline}
y_i = \beta_0 + \beta_1 I(\mathtt{type} = \mathtt{&quot;prof&quot;}) + \beta_2 I(\mathtt{type} = \mathtt{&quot;wc&quot;}) \\
\quad + \beta_3 \mathtt{income} + \beta_4 \mathtt{education} + \epsilon_i
\end{multline}
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">duncan_lm &lt;-<span class="st"> </span><span class="kw">lm</span>(prestige <span class="op">~</span><span class="st"> </span>type <span class="op">+</span><span class="st"> </span>income <span class="op">+</span><span class="st"> </span>education, <span class="dt">data =</span> Duncan)</code></pre></div>
<p><span class="math display">\[
y_i = x_i&#39; \beta + \epsilon_i
\]</span> OLS finds <span class="math inline">\(\hat{\beta}_{OLS}\)</span> by minimizing the squared errors, <span class="math display">\[
\hat{\beta}_{\text{OLS}} = \arg \min_{b} \sum_{i = 1}^n (y_i - x_i&#39; b)^2 .
\]</span> OLS is an estimator of the (linear approximation of) the conditional expectation function, <span class="math display">\[
\mathrm{CEF}(y_i | x_i) = E(y_i, x_i&#39; \beta) .
\]</span></p>
<p>For valid inference we need to make assumptions about <span class="math inline">\(\epsilon_i\)</span>, namely that they are uncorrelated with <span class="math inline">\(X\)</span>, <span class="math inline">\(\Cov(\epsilon, X) = 0\)</span>, and that they are i.i.d, <span class="math inline">\(\Cov(\epsilon_i, \epsilon_j) = 0\)</span>, <span class="math inline">\(\Var(\epsilon_i) = \sigma^2\)</span> for all <span class="math inline">\(i\)</span>. However, no specific distributional form is or needs to be assumed for <span class="math inline">\(\epsilon\)</span> since CLT results show that, asymptotically the sampling distribution of <span class="math inline">\(\beta\)</span> approaches the normal. Additionally, although <span class="math inline">\(\hat\sigma^2 = \sum_{i = 1}^n \epsilon_i / (n - k - 1)\)</span> is a estimator of <span class="math inline">\(\sigma^2\)</span>, standard errors of the standard error of the regression are not directly provided.</p>
<p>However, the OLS estimator is also the same as the MLE estimator for <span class="math inline">\(\beta\)</span> (but not <span class="math inline">\(\sigma\)</span>): <span class="math display">\[
\begin{aligned}[t]
p(y_1, \dots, y_n | \beta, \sigma, x_1, \dots, x_n) &amp;= \prod_{i = 1}^n p(y_i | \beta, x_i) \\
&amp;= \prod_{i = 1}^n N(y_i | x_i&#39; \beta) \\
&amp;= \prod_{i = 1}^n \frac{1}{\sigma \sqrt{2 \pi}} \left( \frac{-(y_i - x_i&#39; \beta)}{2 \sigma^2} \right)
\end{aligned}
\]</span> so, <span class="math display">\[
\hat{\beta}_{MLE}, \hat{\sigma}_{MLE} = \arg\max_{b,s} \prod_{i = 1}^n N(y_i | x_i&#39; b, s^2)  .
\]</span> And <span class="math inline">\(\hat{\beta}_{MLE} = \hat{\beta}_{OLS}\)</span>.</p>
<p>Note that the OLS estimator is equivalent to the MLE estimator of <span class="math inline">\(\beta\)</span>, <span class="math display">\[
\begin{aligned}[t]
\hat{\beta}_{MLE} &amp;= \arg \max_{b} \prod_{i = 1}^n N(y_i | x_i&#39; b, \sigma^2) \\
&amp;=  \arg \max_{b} \prod_{i = 1}^n \frac{1}{\sigma \sqrt{2 \pi}} \exp \left( \frac{-(y_i - x_i&#39; \beta)^2}{2 \sigma^2} \right) \\
&amp;= \arg \max_{b} \log \left( \prod_{i = 1}^n \frac{1}{\sigma \sqrt{2 \pi}} \exp \left( \frac{-(y_i - x_i&#39; \beta)}{2 \sigma^2} \right) \right) \\
&amp;= \arg \max_{b} \sum_{i = 1}^n - \log \sigma - \frac{1}{2} \log 2 \pi + \frac{-(y_i - x_i&#39; \beta)^2}{2 \sigma^2} \\
&amp;= \arg \max_{b} \sum_{i = 1}^n  -(y_i - x_i&#39; \beta)^2 \\
&amp;= \arg \min_{b} \sum_{i = 1}^n  (y_i - x_i&#39; \beta)^2  \\
&amp;= \hat{\beta}_{OLS}
\end{aligned}
\]</span> However, the estimator of <span class="math inline">\(\sigma^2_{MLE} \neq \sigma^2_{OLS}\)</span>.</p>
<div id="bayesian-model-with-improper-priors" class="section level3">
<h3><span class="header-section-number">11.1.1</span> Bayesian Model with Improper priors</h3>
<p>In Bayesian inference, our target is the posterior distribution of the parameters, <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\sigma\)</span>: <span class="math inline">\(p(\beta, \sigma^2 | y, X)\)</span>.</p>
<p><span class="math display">\[
p(\beta, \sigma | y, X) \propto p(y | \beta, \sigma) p(\beta, \sigma)
\]</span></p>
<p>For a Bayesian linear regression model, we’ll need to specify distributions for <span class="math inline">\(p(y | \beta, \sigma)\)</span> and <span class="math inline">\(p(\beta, \sigma)\)</span>.</p>
<p><strong>Likelihood:</strong> <span class="math inline">\(p(y_i | x_i, \beta, \sigma)\)</span> suppose that the observations are distributed independent normal: <span class="math display">\[
y_i \sim \dnorm(\beta&#39;x_i, \sigma^2)
\]</span></p>
<p><strong>Priors:</strong> The model needs to specify a prior distribution for the parameters <span class="math inline">\((\beta, \sigma)\)</span>. Rather than specify a single distribution for <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\sigma\)</span>, it will be easier to specify independent (separate) distributions for <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\sigma\)</span>.</p>
<p>We will use what are called an <em>improper uniform priors</em>. An improper prior is, <span class="math display">\[
p(\theta) \propto C
\]</span> where <span class="math inline">\(C\)</span> is some constants. This function puts an equal density on all values of the support of <span class="math inline">\(\theta\)</span>. This function is not a proper probability density function since <span class="math inline">\(\int_{\theta \in \Theta} C d \theta = \infty\)</span>. However, for some Bayesian models, the prior does not need to be a proper probability function for the posterior to be a probability function. In this example we will put improper prior distributions on <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\sigma\)</span>. <span class="math display">\[
p(\beta, \sigma) = C
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
p(\beta, \sigma | x, y) &amp;\propto p(y| \beta, \sigma, x) p(\beta, \sigma, x) \\
&amp;= \prod_{i = 1}^n N(y_i | x_i&#39; \beta, \sigma^2) \cdot C \\
&amp;\propto \prod_{i = 1}^n N(y_i | x_i&#39; \beta, \sigma^2)
\end{aligned}
\]</span></p>
<p>Note that under the improper priors, the posterior is proportional to the likelihood, <span class="math display">\[
p(\beta, \sigma | x, y) \propto p(y | x, \beta, \sigma)
\]</span> Thus the MAP (maximum a posterior) estimator is the same as the MLE, <span class="math display">\[
\hat{\beta}_{MAP}, \hat{\sigma}_{MAP} = \arg\max_{\beta, \sigma} p(\beta, \sigma | x, y) = \arg \max_{\beta, \sigma} p(y | x, \beta, \sigma) = \hat{\beta}_{MLE}, \hat{\sigma}_{MLE}
\]</span></p>
</div>
</div>
<div id="stan-model" class="section level2">
<h2><span class="header-section-number">11.2</span> Stan Model</h2>
<p>Let’s write and estimate our model in Stan. Stan models are written in its own domain-specific language that focuses on declaring the statistical model (parameters, variables, distributions) while leaving the details of the sampling algorithm to Stan.</p>
<p>A Stan model consists of <em>blocks</em> which contain declarations of variables and/or statements. Each block has a specific purpose in the model.</p>
</div>
<div id="sampling-model-with-stan" class="section level2">
<h2><span class="header-section-number">11.3</span> Sampling Model with Stan</h2>
<pre class="stan"><code>functions {
    // OPTIONAL: user-defined functions
}
data {
    // read in data ...
}
transformed data {
    // Create new variables/auxiliary variables from the data
}
parameters {
    // Declare parameters that will be estimated
}
transformed parameters {
    // Create new variables/auxiliary variables from the parameters
}
model {
    // Declare your probability model: priors, hyperpriors &amp; likelihood
}
generated quantities {
    // Declare any quantities other than simulated parameters to be generated
}</code></pre>
<p>The file <code>lm0.stan</code> is a Stan model for the linear regression model previously defined.</p>
<pre class="stan">
<code>// lm_normal_1.stan
// Linear Model with Normal Errors
data {
  // number of observations
  int<lower=0> N;
  // response
  vector[N] y;
  // number of columns in the design matrix X
  int<lower=0> K;
  // design matrix X
  // should not include an intercept
  matrix [N, K] X;
  // priors on alpha
  real<lower=0.> scale_alpha;
  vector<lower=0.>[K] scale_beta;
  real<lower=0.> loc_sigma;
  // keep responses
  int<lower=0, upper=1> use_y_rep;
  int<lower=0, upper=1> use_log_lik;
}
parameters {
  // regression coefficient vector
  real alpha;
  vector[K] beta;
  real<lower=0.> sigma;
}
transformed parameters {
  vector[N] mu;

  mu = alpha + X * beta;
}
model {
  // priors
  alpha ~ normal(0., scale_alpha);
  beta ~ normal(0., scale_beta);
  sigma ~ exponential(loc_sigma);
  // likelihood
  y ~ normal(mu, sigma);
}
generated quantities {
  // simulate data from the posterior
  vector[N * use_y_rep] y_rep;
  // log-likelihood posterior
  vector[N * use_log_lik] log_lik;
  for (i in 1:num_elements(y_rep)) {
    y_rep[i] = normal_rng(mu[i], sigma);
  }
  for (i in 1:num_elements(log_lik)) {
    log_lik[i] = normal_lpdf(y[i] | mu[i], sigma);
  }
}</code>
</pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod1 &lt;-<span class="st"> </span><span class="kw">stan_model</span>(<span class="st">&quot;stan/lm_normal_1.stan&quot;</span>)</code></pre></div>
<p>See the <a href="http://mc-stan.org/documentation/">Stan Modeling Language User’s Guide and Reference Manual</a> for details of the Stan Language.</p>
<p><strong>Note</strong>Since a Stan model compiles to C++ code, you may receive some warning messages such as</p>
<pre><code>/Library/Frameworks/R.framework/Versions/3.3/Resources/library/StanHeaders/include/stan/math/rev/core/set_zero_all_adjoints.hpp:14:17: warning: unused function &#39;set_zero_all_adjoints&#39; [-Wunused-function]
    static void set_zero_all_adjoints() {
                ^
In file included from file1d4a4d50faa.cpp:8:
In file included from /Library/Frameworks/R.framework/Versions/3.3/Resources/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</code></pre>
<p>As long as your model compiles, you can ignore these compiler warnings (On the other hard, warnings that occur during sampling should not be ignored). If the Stan model does not give you a syntax error when parsing the model, it should compile to valid C++.[^bugs][^c-warnings] See</p>
<p>[bugs]: In the rare case that the Stan parser transpiles the Stan model to C++ but cannot compile the C++ code, it is a bug in Stan. Follow the <a href="http://mc-stan.org/issues/">instructions</a> on how to inform the Stan developers about bugs. [c-warnings]: The extended installation instructions for <a href="https://github.com/stan-dev/rstan/wiki/Installing-RStan-on-Mac-or-Linux">MacOS/Linux</a> and <a href="https://github.com/stan-dev/rstan/wiki/Installing-RStan-on-Windows">Windows</a> have instructions for adding compiler options to the R <a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Using-Makevars">Makevars</a> file.</p>
<div id="sampling" class="section level3">
<h3><span class="header-section-number">11.3.1</span> Sampling</h3>
<p>In order to sample from the model, we need to at least give it the values for the data to use: `<code>,</code>k<code>,</code>y<code>,</code>X`, and the data associated with the priors.</p>
<p>The data types in Stan are all numeric (either integers or reals), but they include matrices and vectors. However, there is nothing like a data frame in Stan. Whereas in the R function <code>lm</code> we can provide a formula and a data set for where to look for objects, and the function will create the appropriate <span class="math inline">\(X\)</span> matrix for the regression, we will need to create that matrix ourselves—expanding categorical variables to indicator variables, and expanding interactions and other functions of the predictors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rec &lt;-<span class="st"> </span><span class="kw">recipe</span>(prestige <span class="op">~</span><span class="st"> </span>income <span class="op">+</span><span class="st"> </span>education <span class="op">+</span><span class="st"> </span>type, <span class="dt">data =</span> Duncan) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">step_dummy</span>(type) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">prep</span>(<span class="dt">data =</span> Duncan, <span class="dt">retain =</span> <span class="ot">TRUE</span>) 
X &lt;-<span class="st"> </span><span class="kw">juice</span>(rec, <span class="kw">all_predictors</span>(), <span class="dt">composition =</span> <span class="st">&quot;matrix&quot;</span>)
y &lt;-<span class="st"> </span><span class="kw">drop</span>(<span class="kw">juice</span>(rec, <span class="kw">all_outcomes</span>(), <span class="dt">composition =</span> <span class="st">&quot;matrix&quot;</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod1_data &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">X =</span> X,
  <span class="dt">K =</span> <span class="kw">ncol</span>(X),
  <span class="dt">N =</span> <span class="kw">nrow</span>(X),
  <span class="dt">y =</span> y,
  <span class="dt">use_y_rep =</span> <span class="ot">FALSE</span>,
  <span class="dt">use_log_lik =</span> <span class="ot">FALSE</span>
)</code></pre></div>
<p>We still need to provide the values for the prior distributions. For specific values of the prior distributions, assume uninformative priors for <code>beta</code> by setting the mean to zero and the variances to large numbers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod1_data<span class="op">$</span>scale_alpha &lt;-<span class="st"> </span><span class="kw">sd</span>(y) <span class="op">*</span><span class="st"> </span><span class="dv">10</span>
mod1_data<span class="op">$</span>scale_beta &lt;-<span class="st"> </span><span class="kw">apply</span>(X, <span class="dv">2</span>, sd) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(y) <span class="op">*</span><span class="st"> </span><span class="fl">2.5</span>
mod1_data<span class="op">$</span>loc_sigma &lt;-<span class="st"> </span><span class="kw">sd</span>(y)</code></pre></div>
<p>Now, sample from the posterior, using the function <code>sampling</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod1_fit &lt;-<span class="st"> </span><span class="kw">sampling</span>(mod1, <span class="dt">data =</span> mod1_data)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mod1_fit)
<span class="co">#&gt; $summary</span>
<span class="co">#&gt;             mean  se_mean     sd     2.5%      25%      50%      75%</span>
<span class="co">#&gt; alpha     -0.249 0.036791 1.7422   -3.688   -1.452   -0.252    0.940</span>
<span class="co">#&gt; beta[1]    0.598 0.000843 0.0422    0.515    0.569    0.597    0.628</span>
<span class="co">#&gt; beta[2]    0.346 0.001233 0.0534    0.243    0.310    0.347    0.382</span>
<span class="co">#&gt; beta[3]   16.611 0.075172 3.2519   10.426   14.343   16.633   18.818</span>
<span class="co">#&gt; beta[4]  -14.567 0.059498 2.8363  -20.022  -16.467  -14.560  -12.681</span>
<span class="co">#&gt; sigma      4.569 0.004019 0.2087    4.168    4.428    4.561    4.706</span>
<span class="co">#&gt; mu[1]     83.207 0.017079 1.0801   81.060   82.506   83.230   83.902</span>
<span class="co">#&gt; mu[2]     85.722 0.020394 1.2438   83.209   84.894   85.741   86.532</span>
<span class="co">#&gt; mu[3]     93.056 0.022266 1.2739   90.549   92.218   93.074   93.883</span>
<span class="co">#&gt; mu[4]     80.408 0.018851 1.1923   78.056   79.647   80.415   81.197</span>
<span class="co">#&gt; mu[5]     84.403 0.017152 1.0848   82.236   83.700   84.420   85.094</span>
<span class="co">#&gt; mu[6]     58.006 0.036938 1.9884   54.086   56.631   58.023   59.369</span>
<span class="co">#&gt; mu[7]     86.827 0.020598 1.2088   84.468   86.023   86.835   87.614</span>
<span class="co">#&gt; mu[8]     98.815 0.030008 1.5203   95.783   97.793   98.823   99.839</span>
<span class="co">#&gt; mu[9]     55.364 0.035656 2.2551   50.985   53.853   55.320   56.856</span>
<span class="co">#&gt; mu[10]    89.185 0.018434 1.1658   86.880   88.405   89.215   89.950</span>
<span class="co">#&gt; mu[11]    67.096 0.022881 1.2851   64.629   66.208   67.095   67.954</span>
<span class="co">#&gt; mu[12]    95.732 0.026991 1.4133   92.916   94.764   95.732   96.683</span>
<span class="co">#&gt; mu[13]    95.385 0.026176 1.3884   92.604   94.440   95.391   96.311</span>
<span class="co">#&gt; mu[14]    69.961 0.022823 1.3524   67.311   69.054   69.972   70.856</span>
<span class="co">#&gt; mu[15]    76.570 0.022464 1.3341   74.003   75.688   76.569   77.461</span>
<span class="co">#&gt; mu[16]    42.389 0.051593 2.7231   36.996   40.566   42.395   44.286</span>
<span class="co">#&gt; mu[17]    63.628 0.047609 2.1508   59.454   62.188   63.662   65.076</span>
<span class="co">#&gt; mu[18]    71.622 0.035577 1.7183   68.240   70.487   71.639   72.781</span>
<span class="co">#&gt; mu[19]    56.706 0.049320 2.1788   52.484   55.207   56.729   58.155</span>
<span class="co">#&gt; mu[20]    91.386 0.021486 1.2981   88.875   90.498   91.411   92.230</span>
<span class="co">#&gt; mu[21]    27.454 0.034915 2.2082   23.001   25.980   27.454   28.943</span>
<span class="co">#&gt; mu[22]    32.924 0.029232 1.8488   29.263   31.714   32.917   34.144</span>
<span class="co">#&gt; mu[23]    42.650 0.029833 1.8868   38.934   41.400   42.651   43.895</span>
<span class="co">#&gt; mu[24]    19.835 0.032524 2.0570   15.834   18.428   19.827   21.196</span>
<span class="co">#&gt; mu[25]    20.269 0.016000 1.0119   18.350   19.563   20.266   20.950</span>
<span class="co">#&gt; mu[26]    41.353 0.028318 1.4324   38.527   40.378   41.357   42.303</span>
<span class="co">#&gt; mu[27]    57.867 0.050996 2.5800   52.801   56.069   57.819   59.663</span>
<span class="co">#&gt; mu[28]    32.353 0.019296 1.1310   30.120   31.610   32.341   33.098</span>
<span class="co">#&gt; mu[29]    20.521 0.016079 1.0169   18.581   19.816   20.510   21.212</span>
<span class="co">#&gt; mu[30]    34.711 0.022190 1.3210   32.196   33.806   34.711   35.629</span>
<span class="co">#&gt; mu[31]    18.761 0.018306 1.1024   16.642   18.008   18.737   19.509</span>
<span class="co">#&gt; mu[32]     6.359 0.028275 1.4339    3.523    5.362    6.361    7.340</span>
<span class="co">#&gt; mu[33]    33.861 0.020852 1.2577   31.419   33.018   33.862   34.729</span>
<span class="co">#&gt; mu[34]    11.711 0.020253 1.1748    9.478   10.868   11.702   12.500</span>
<span class="co">#&gt; mu[35]    17.499 0.018971 1.1363   15.259   16.727   17.484   18.283</span>
<span class="co">#&gt; mu[36]    19.230 0.016443 1.0399   17.249   18.520   19.224   19.943</span>
<span class="co">#&gt; mu[37]    18.320 0.016698 1.0561   16.293   17.604   18.299   19.036</span>
<span class="co">#&gt; mu[38]    19.012 0.017476 1.0740   16.937   18.276   18.983   19.740</span>
<span class="co">#&gt; mu[39]    11.018 0.020919 1.1939    8.742   10.173   11.018   11.829</span>
<span class="co">#&gt; mu[40]    15.739 0.017428 1.0772   13.705   14.982   15.727   16.479</span>
<span class="co">#&gt; mu[41]    17.314 0.020183 1.1740   15.053   16.506   17.305   18.096</span>
<span class="co">#&gt; mu[42]    18.571 0.016428 1.0390   16.581   17.854   18.556   19.271</span>
<span class="co">#&gt; mu[43]    10.862 0.021082 1.2097    8.570    9.998   10.846   11.674</span>
<span class="co">#&gt; mu[44]    36.352 0.031209 1.4842   33.485   35.353   36.354   37.313</span>
<span class="co">#&gt; mu[45]    15.615 0.023464 1.3057   13.125   14.715   15.594   16.460</span>
<span class="co">#&gt; lp__    -305.014 0.042628 1.7186 -309.155 -305.916 -304.721 -303.763</span>
<span class="co">#&gt;            97.5% n_eff  Rhat</span>
<span class="co">#&gt; alpha      3.172  2243 1.001</span>
<span class="co">#&gt; beta[1]    0.680  2503 1.000</span>
<span class="co">#&gt; beta[2]    0.452  1874 1.001</span>
<span class="co">#&gt; beta[3]   23.024  1871 1.002</span>
<span class="co">#&gt; beta[4]   -9.028  2273 1.000</span>
<span class="co">#&gt; sigma      4.996  2695 1.000</span>
<span class="co">#&gt; mu[1]     85.286  4000 1.000</span>
<span class="co">#&gt; mu[2]     88.241  3720 1.000</span>
<span class="co">#&gt; mu[3]     95.525  3273 1.000</span>
<span class="co">#&gt; mu[4]     82.752  4000 1.000</span>
<span class="co">#&gt; mu[5]     86.505  4000 1.000</span>
<span class="co">#&gt; mu[6]     61.814  2898 1.000</span>
<span class="co">#&gt; mu[7]     89.168  3444 1.000</span>
<span class="co">#&gt; mu[8]    101.770  2567 1.001</span>
<span class="co">#&gt; mu[9]     59.817  4000 1.001</span>
<span class="co">#&gt; mu[10]    91.461  4000 1.000</span>
<span class="co">#&gt; mu[11]    69.581  3154 1.000</span>
<span class="co">#&gt; mu[12]    98.508  2742 1.000</span>
<span class="co">#&gt; mu[13]    98.092  2813 1.000</span>
<span class="co">#&gt; mu[14]    72.633  3511 1.000</span>
<span class="co">#&gt; mu[15]    79.200  3527 1.000</span>
<span class="co">#&gt; mu[16]    47.731  2786 0.999</span>
<span class="co">#&gt; mu[17]    67.882  2041 1.001</span>
<span class="co">#&gt; mu[18]    74.960  2333 1.001</span>
<span class="co">#&gt; mu[19]    61.041  1952 1.001</span>
<span class="co">#&gt; mu[20]    93.967  3651 1.000</span>
<span class="co">#&gt; mu[21]    31.767  4000 1.000</span>
<span class="co">#&gt; mu[22]    36.475  4000 0.999</span>
<span class="co">#&gt; mu[23]    46.405  4000 1.000</span>
<span class="co">#&gt; mu[24]    23.826  4000 1.000</span>
<span class="co">#&gt; mu[25]    22.312  4000 0.999</span>
<span class="co">#&gt; mu[26]    44.236  2559 1.000</span>
<span class="co">#&gt; mu[27]    62.900  2560 1.000</span>
<span class="co">#&gt; mu[28]    34.632  3435 1.000</span>
<span class="co">#&gt; mu[29]    22.541  4000 0.999</span>
<span class="co">#&gt; mu[30]    37.252  3544 1.000</span>
<span class="co">#&gt; mu[31]    21.000  3627 0.999</span>
<span class="co">#&gt; mu[32]     9.154  2572 1.001</span>
<span class="co">#&gt; mu[33]    36.328  3638 1.000</span>
<span class="co">#&gt; mu[34]    14.047  3365 1.000</span>
<span class="co">#&gt; mu[35]    19.720  3587 1.000</span>
<span class="co">#&gt; mu[36]    21.266  4000 0.999</span>
<span class="co">#&gt; mu[37]    20.456  4000 0.999</span>
<span class="co">#&gt; mu[38]    21.177  3776 0.999</span>
<span class="co">#&gt; mu[39]    13.388  3257 1.000</span>
<span class="co">#&gt; mu[40]    17.900  3820 0.999</span>
<span class="co">#&gt; mu[41]    19.714  3383 0.999</span>
<span class="co">#&gt; mu[42]    20.695  4000 0.999</span>
<span class="co">#&gt; mu[43]    13.284  3292 1.000</span>
<span class="co">#&gt; mu[44]    39.315  2262 1.001</span>
<span class="co">#&gt; mu[45]    18.219  3096 0.999</span>
<span class="co">#&gt; lp__    -302.587  1625 1.004</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $c_summary</span>
<span class="co">#&gt; , , chains = chain:1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;          stats</span>
<span class="co">#&gt; parameter     mean     sd     2.5%      25%      50%      75%    97.5%</span>
<span class="co">#&gt;   alpha     -0.273 1.7465   -3.582   -1.478   -0.347    0.898    3.215</span>
<span class="co">#&gt;   beta[1]    0.599 0.0443    0.512    0.569    0.598    0.630    0.686</span>
<span class="co">#&gt;   beta[2]    0.347 0.0544    0.237    0.312    0.349    0.385    0.457</span>
<span class="co">#&gt;   beta[3]   16.478 3.2400   10.523   14.089   16.510   18.708   22.733</span>
<span class="co">#&gt;   beta[4]  -14.672 2.8448  -20.174  -16.561  -14.659  -12.731   -9.082</span>
<span class="co">#&gt;   sigma      4.570 0.2104    4.187    4.424    4.568    4.707    4.993</span>
<span class="co">#&gt;   mu[1]     83.189 1.0871   81.194   82.475   83.182   83.864   85.389</span>
<span class="co">#&gt;   mu[2]     85.703 1.2674   83.356   84.840   85.680   86.455   88.358</span>
<span class="co">#&gt;   mu[3]     93.056 1.2873   90.592   92.174   93.032   93.835   95.747</span>
<span class="co">#&gt;   mu[4]     80.388 1.2089   78.086   79.586   80.358   81.187   82.780</span>
<span class="co">#&gt;   mu[5]     84.387 1.0920   82.375   83.662   84.381   85.080   86.616</span>
<span class="co">#&gt;   mu[6]     57.949 2.0619   53.892   56.516   57.930   59.358   61.932</span>
<span class="co">#&gt;   mu[7]     86.817 1.2197   84.524   86.001   86.788   87.627   89.205</span>
<span class="co">#&gt;   mu[8]     98.827 1.5330   95.938   97.793   98.831   99.759  101.948</span>
<span class="co">#&gt;   mu[9]     55.380 2.2082   50.881   53.912   55.407   56.852   59.693</span>
<span class="co">#&gt;   mu[10]    89.176 1.1799   86.989   88.386   89.142   89.937   91.765</span>
<span class="co">#&gt;   mu[11]    67.048 1.2911   64.637   66.122   67.046   67.936   69.520</span>
<span class="co">#&gt;   mu[12]    95.738 1.4247   93.031   94.766   95.728   96.602   98.607</span>
<span class="co">#&gt;   mu[13]    95.391 1.4001   92.758   94.437   95.382   96.243   98.239</span>
<span class="co">#&gt;   mu[14]    69.922 1.3823   67.201   69.031   69.915   70.824   72.651</span>
<span class="co">#&gt;   mu[15]    76.544 1.3645   73.916   75.644   76.552   77.462   79.146</span>
<span class="co">#&gt;   mu[16]    42.362 2.7670   36.976   40.482   42.352   44.170   47.893</span>
<span class="co">#&gt;   mu[17]    63.563 2.1602   59.605   62.105   63.492   64.990   68.186</span>
<span class="co">#&gt;   mu[18]    71.574 1.7331   68.283   70.446   71.511   72.739   75.297</span>
<span class="co">#&gt;   mu[19]    56.630 2.1709   52.661   55.088   56.589   58.040   61.234</span>
<span class="co">#&gt;   mu[20]    91.379 1.3273   88.954   90.451   91.353   92.207   94.144</span>
<span class="co">#&gt;   mu[21]    27.421 2.2469   22.905   25.872   27.393   28.846   31.848</span>
<span class="co">#&gt;   mu[22]    32.892 1.8324   29.160   31.713   32.849   34.115   36.342</span>
<span class="co">#&gt;   mu[23]    42.639 1.8551   38.864   41.446   42.654   43.811   46.099</span>
<span class="co">#&gt;   mu[24]    19.781 2.0728   15.693   18.411   19.813   21.049   23.845</span>
<span class="co">#&gt;   mu[25]    20.287 1.0145   18.360   19.595   20.272   20.956   22.323</span>
<span class="co">#&gt;   mu[26]    41.409 1.4287   38.470   40.495   41.408   42.344   44.273</span>
<span class="co">#&gt;   mu[27]    57.944 2.6612   53.017   56.085   57.861   59.795   63.236</span>
<span class="co">#&gt;   mu[28]    32.393 1.1264   30.100   31.676   32.370   33.107   34.642</span>
<span class="co">#&gt;   mu[29]    20.538 1.0177   18.626   19.813   20.507   21.218   22.564</span>
<span class="co">#&gt;   mu[30]    34.751 1.3326   32.176   33.817   34.780   35.677   37.259</span>
<span class="co">#&gt;   mu[31]    18.779 1.1260   16.604   18.022   18.774   19.563   21.000</span>
<span class="co">#&gt;   mu[32]     6.349 1.4379    3.627    5.396    6.270    7.320    9.243</span>
<span class="co">#&gt;   mu[33]    33.901 1.2645   31.413   33.043   33.937   34.765   36.331</span>
<span class="co">#&gt;   mu[34]    11.714 1.1934    9.476   10.851   11.706   12.510   14.130</span>
<span class="co">#&gt;   mu[35]    17.509 1.1356   15.334   16.733   17.476   18.263   19.850</span>
<span class="co">#&gt;   mu[36]    19.245 1.0405   17.313   18.530   19.215   19.923   21.392</span>
<span class="co">#&gt;   mu[37]    18.335 1.0719   16.250   17.624   18.316   19.079   20.513</span>
<span class="co">#&gt;   mu[38]    19.030 1.0932   16.926   18.292   19.017   19.789   21.171</span>
<span class="co">#&gt;   mu[39]    11.019 1.2088    8.795   10.159   10.997   11.816   13.484</span>
<span class="co">#&gt;   mu[40]    15.749 1.0906   13.677   14.998   15.734   16.496   17.909</span>
<span class="co">#&gt;   mu[41]    17.330 1.2076   15.001   16.535   17.326   18.160   19.710</span>
<span class="co">#&gt;   mu[42]    18.587 1.0510   16.539   17.872   18.573   19.312   20.728</span>
<span class="co">#&gt;   mu[43]    10.864 1.2349    8.514    9.995   10.849   11.677   13.350</span>
<span class="co">#&gt;   mu[44]    36.404 1.4875   33.430   35.432   36.395   37.395   39.310</span>
<span class="co">#&gt;   mu[45]    15.630 1.3544   12.997   14.742   15.644   16.519   18.268</span>
<span class="co">#&gt;   lp__    -305.082 1.7492 -309.131 -305.956 -304.829 -303.811 -302.648</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , chains = chain:2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;          stats</span>
<span class="co">#&gt; parameter     mean     sd     2.5%      25%      50%      75%    97.5%</span>
<span class="co">#&gt;   alpha     -0.336 1.7754   -4.005   -1.520   -0.331    0.848    3.029</span>
<span class="co">#&gt;   beta[1]    0.598 0.0407    0.521    0.569    0.596    0.628    0.679</span>
<span class="co">#&gt;   beta[2]    0.349 0.0532    0.239    0.313    0.349    0.385    0.453</span>
<span class="co">#&gt;   beta[3]   16.431 3.2666   10.200   14.212   16.509   18.488   23.105</span>
<span class="co">#&gt;   beta[4]  -14.646 2.8421  -20.106  -16.539  -14.643  -12.729   -9.187</span>
<span class="co">#&gt;   sigma      4.568 0.2119    4.167    4.426    4.555    4.721    5.001</span>
<span class="co">#&gt;   mu[1]     83.222 1.1105   80.940   82.509   83.249   83.924   85.314</span>
<span class="co">#&gt;   mu[2]     85.709 1.2323   83.171   84.915   85.731   86.576   88.103</span>
<span class="co">#&gt;   mu[3]     93.093 1.2978   90.524   92.258   93.126   93.960   95.558</span>
<span class="co">#&gt;   mu[4]     80.433 1.2278   78.023   79.672   80.449   81.239   82.890</span>
<span class="co">#&gt;   mu[5]     84.418 1.1132   82.129   83.695   84.435   85.128   86.493</span>
<span class="co">#&gt;   mu[6]     58.002 1.9738   54.102   56.708   57.968   59.335   61.772</span>
<span class="co">#&gt;   mu[7]     86.864 1.2474   84.355   86.034   86.869   87.706   89.254</span>
<span class="co">#&gt;   mu[8]     98.879 1.5517   95.893   97.841   98.866   99.947  101.862</span>
<span class="co">#&gt;   mu[9]     55.485 2.2927   51.219   53.972   55.352   57.035   60.272</span>
<span class="co">#&gt;   mu[10]    89.203 1.1811   86.737   88.418   89.251   89.999   91.433</span>
<span class="co">#&gt;   mu[11]    67.068 1.3009   64.589   66.182   67.038   67.891   69.581</span>
<span class="co">#&gt;   mu[12]    95.788 1.4472   92.931   94.842   95.794   96.779   98.599</span>
<span class="co">#&gt;   mu[13]    95.438 1.4206   92.636   94.513   95.446   96.387   98.203</span>
<span class="co">#&gt;   mu[14]    69.964 1.3707   67.293   69.066   69.977   70.835   72.668</span>
<span class="co">#&gt;   mu[15]    76.596 1.3629   73.923   75.706   76.584   77.479   79.348</span>
<span class="co">#&gt;   mu[16]    42.351 2.6233   37.081   40.532   42.387   44.170   47.541</span>
<span class="co">#&gt;   mu[17]    63.515 2.1323   59.299   62.001   63.580   64.878   67.740</span>
<span class="co">#&gt;   mu[18]    71.545 1.6972   68.304   70.331   71.626   72.700   74.859</span>
<span class="co">#&gt;   mu[19]    56.587 2.1740   52.353   55.078   56.659   57.996   60.887</span>
<span class="co">#&gt;   mu[20]    91.394 1.2889   88.647   90.524   91.408   92.261   93.853</span>
<span class="co">#&gt;   mu[21]    27.517 2.1919   23.001   26.097   27.549   28.966   31.887</span>
<span class="co">#&gt;   mu[22]    32.941 1.8152   29.364   31.786   32.868   34.089   36.437</span>
<span class="co">#&gt;   mu[23]    42.718 1.8905   39.095   41.449   42.680   43.966   46.602</span>
<span class="co">#&gt;   mu[24]    19.831 2.0136   15.870   18.494   19.848   21.117   23.747</span>
<span class="co">#&gt;   mu[25]    20.259 1.0624   18.326   19.490   20.274   20.980   22.383</span>
<span class="co">#&gt;   mu[26]    41.400 1.4851   38.463   40.397   41.394   42.350   44.424</span>
<span class="co">#&gt;   mu[27]    57.891 2.5800   52.873   56.130   57.787   59.665   63.223</span>
<span class="co">#&gt;   mu[28]    32.375 1.1900   30.093   31.600   32.363   33.112   34.810</span>
<span class="co">#&gt;   mu[29]    20.508 1.0713   18.574   19.714   20.517   21.247   22.640</span>
<span class="co">#&gt;   mu[30]    34.714 1.3790   32.106   33.770   34.714   35.643   37.362</span>
<span class="co">#&gt;   mu[31]    18.767 1.1189   16.685   17.984   18.757   19.476   21.101</span>
<span class="co">#&gt;   mu[32]     6.296 1.4725    3.323    5.285    6.322    7.277    9.090</span>
<span class="co">#&gt;   mu[33]    33.867 1.3181   31.352   32.987   33.865   34.768   36.485</span>
<span class="co">#&gt;   mu[34]    11.685 1.1963    9.493   10.838   11.677   12.466   14.113</span>
<span class="co">#&gt;   mu[35]    17.464 1.1953   15.134   16.596   17.474   18.310   19.869</span>
<span class="co">#&gt;   mu[36]    19.211 1.0948   17.230   18.419   19.223   19.959   21.370</span>
<span class="co">#&gt;   mu[37]    18.317 1.0842   16.334   17.591   18.291   19.006   20.648</span>
<span class="co">#&gt;   mu[38]    19.016 1.0968   16.972   18.265   18.988   19.707   21.291</span>
<span class="co">#&gt;   mu[39]    10.986 1.2202    8.732   10.134   10.975   11.786   13.486</span>
<span class="co">#&gt;   mu[40]    15.723 1.1085   13.750   14.948   15.694   16.476   18.036</span>
<span class="co">#&gt;   mu[41]    17.322 1.1767   15.152   16.508   17.324   18.076   19.815</span>
<span class="co">#&gt;   mu[42]    18.566 1.0732   16.574   17.826   18.539   19.261   20.830</span>
<span class="co">#&gt;   mu[43]    10.838 1.2217    8.638    9.955   10.830   11.638   13.369</span>
<span class="co">#&gt;   mu[44]    36.419 1.5142   33.443   35.431   36.468   37.397   39.417</span>
<span class="co">#&gt;   mu[45]    15.629 1.2889   13.207   14.728   15.614   16.438   18.223</span>
<span class="co">#&gt;   lp__    -305.064 1.7399 -309.226 -306.059 -304.800 -303.783 -302.564</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , chains = chain:3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;          stats</span>
<span class="co">#&gt; parameter     mean     sd     2.5%      25%      50%      75%    97.5%</span>
<span class="co">#&gt;   alpha     -0.245 1.7515   -3.561   -1.516   -0.252    1.010    3.252</span>
<span class="co">#&gt;   beta[1]    0.597 0.0426    0.513    0.567    0.598    0.629    0.674</span>
<span class="co">#&gt;   beta[2]    0.346 0.0546    0.247    0.306    0.346    0.381    0.462</span>
<span class="co">#&gt;   beta[3]   16.693 3.3838   10.106   14.392   16.630   19.042   23.353</span>
<span class="co">#&gt;   beta[4]  -14.460 2.8932  -19.856  -16.338  -14.480  -12.604   -8.568</span>
<span class="co">#&gt;   sigma      4.579 0.2143    4.168    4.437    4.570    4.714    5.014</span>
<span class="co">#&gt;   mu[1]     83.192 1.1147   81.015   82.465   83.181   83.953   85.268</span>
<span class="co">#&gt;   mu[2]     85.705 1.2809   83.011   84.892   85.763   86.488   88.234</span>
<span class="co">#&gt;   mu[3]     93.027 1.2884   90.467   92.128   93.051   93.881   95.504</span>
<span class="co">#&gt;   mu[4]     80.396 1.2278   77.996   79.604   80.393   81.233   82.765</span>
<span class="co">#&gt;   mu[5]     84.386 1.1170   82.185   83.662   84.381   85.146   86.485</span>
<span class="co">#&gt;   mu[6]     58.024 2.0479   54.073   56.552   58.098   59.514   61.979</span>
<span class="co">#&gt;   mu[7]     86.806 1.2326   84.383   85.993   86.829   87.638   89.170</span>
<span class="co">#&gt;   mu[8]     98.777 1.5303   95.613   97.729   98.839   99.857  101.719</span>
<span class="co">#&gt;   mu[9]     55.370 2.3067   51.053   53.742   55.287   56.916   59.899</span>
<span class="co">#&gt;   mu[10]    89.162 1.1886   86.793   88.382   89.190   89.922   91.465</span>
<span class="co">#&gt;   mu[11]    67.104 1.3588   64.478   66.168   67.113   68.017   69.736</span>
<span class="co">#&gt;   mu[12]    95.698 1.4254   92.771   94.706   95.737   96.677   98.397</span>
<span class="co">#&gt;   mu[13]    95.352 1.4005   92.514   94.375   95.387   96.302   98.027</span>
<span class="co">#&gt;   mu[14]    69.964 1.4067   67.217   69.032   69.979   70.924   72.594</span>
<span class="co">#&gt;   mu[15]    76.563 1.3733   73.980   75.668   76.589   77.520   79.216</span>
<span class="co">#&gt;   mu[16]    42.420 2.8201   36.772   40.673   42.438   44.431   48.066</span>
<span class="co">#&gt;   mu[17]    63.645 2.2517   58.970   62.198   63.608   65.202   68.010</span>
<span class="co">#&gt;   mu[18]    71.627 1.7995   67.782   70.475   71.662   72.794   74.994</span>
<span class="co">#&gt;   mu[19]    56.732 2.2910   52.024   55.192   56.745   58.278   61.092</span>
<span class="co">#&gt;   mu[20]    91.361 1.3194   88.739   90.489   91.410   92.184   93.953</span>
<span class="co">#&gt;   mu[21]    27.499 2.2523   23.019   25.895   27.478   29.136   31.730</span>
<span class="co">#&gt;   mu[22]    32.964 1.9250   29.342   31.639   32.954   34.258   36.678</span>
<span class="co">#&gt;   mu[23]    42.675 1.9440   38.934   41.374   42.664   43.971   46.528</span>
<span class="co">#&gt;   mu[24]    19.893 2.1336   15.819   18.369   19.830   21.351   24.175</span>
<span class="co">#&gt;   mu[25]    20.243 0.9853   18.350   19.581   20.225   20.899   22.116</span>
<span class="co">#&gt;   mu[26]    41.296 1.4356   38.527   40.282   41.275   42.287   43.953</span>
<span class="co">#&gt;   mu[27]    57.791 2.5920   52.575   55.974   57.772   59.762   62.659</span>
<span class="co">#&gt;   mu[28]    32.309 1.1164   30.184   31.565   32.311   33.088   34.496</span>
<span class="co">#&gt;   mu[29]    20.495 0.9903   18.544   19.844   20.472   21.182   22.379</span>
<span class="co">#&gt;   mu[30]    34.665 1.3069   32.135   33.794   34.698   35.528   37.135</span>
<span class="co">#&gt;   mu[31]    18.736 1.0817   16.699   17.963   18.691   19.469   20.895</span>
<span class="co">#&gt;   mu[32]     6.354 1.4291    3.619    5.291    6.341    7.333    9.163</span>
<span class="co">#&gt;   mu[33]    33.817 1.2422   31.419   32.981   33.843   34.666   36.176</span>
<span class="co">#&gt;   mu[34]    11.697 1.1551    9.526   10.818   11.675   12.456   14.044</span>
<span class="co">#&gt;   mu[35]    17.478 1.1154   15.260   16.740   17.445   18.243   19.686</span>
<span class="co">#&gt;   mu[36]    19.206 1.0142   17.243   18.561   19.184   19.895   21.182</span>
<span class="co">#&gt;   mu[37]    18.296 1.0321   16.302   17.564   18.253   19.008   20.444</span>
<span class="co">#&gt;   mu[38]    18.987 1.0517   17.011   18.229   18.937   19.708   21.154</span>
<span class="co">#&gt;   mu[39]    11.005 1.1755    8.802   10.120   10.991   11.807   13.298</span>
<span class="co">#&gt;   mu[40]    15.719 1.0532   13.676   14.963   15.680   16.424   17.773</span>
<span class="co">#&gt;   mu[41]    17.290 1.1560   15.134   16.478   17.271   18.055   19.633</span>
<span class="co">#&gt;   mu[42]    18.547 1.0140   16.581   17.839   18.501   19.230   20.567</span>
<span class="co">#&gt;   mu[43]    10.848 1.1910    8.612    9.965   10.800   11.643   13.265</span>
<span class="co">#&gt;   mu[44]    36.301 1.4970   33.549   35.271   36.317   37.306   39.241</span>
<span class="co">#&gt;   mu[45]    15.594 1.2924   13.222   14.672   15.559   16.413   18.117</span>
<span class="co">#&gt;   lp__    -305.130 1.7550 -309.380 -306.032 -304.854 -303.840 -302.631</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , chains = chain:4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;          stats</span>
<span class="co">#&gt; parameter     mean     sd     2.5%      25%       50%      75%    97.5%</span>
<span class="co">#&gt;   alpha     -0.144 1.6916   -3.612   -1.288   -0.0695    0.989    3.246</span>
<span class="co">#&gt;   beta[1]    0.597 0.0411    0.514    0.572    0.5959    0.625    0.679</span>
<span class="co">#&gt;   beta[2]    0.343 0.0512    0.250    0.307    0.3423    0.377    0.440</span>
<span class="co">#&gt;   beta[3]   16.841 3.0989   10.868   14.746   16.8713   18.958   22.758</span>
<span class="co">#&gt;   beta[4]  -14.490 2.7618  -19.896  -16.382  -14.3964  -12.591   -9.266</span>
<span class="co">#&gt;   sigma      4.557 0.1973    4.166    4.429    4.5541    4.679    4.962</span>
<span class="co">#&gt;   mu[1]     83.225 1.0058   81.142   82.585   83.2811   83.852   85.133</span>
<span class="co">#&gt;   mu[2]     85.769 1.1934   83.289   84.973   85.7763   86.561   88.147</span>
<span class="co">#&gt;   mu[3]     93.048 1.2215   90.662   92.246   93.1082   93.874   95.346</span>
<span class="co">#&gt;   mu[4]     80.416 1.1012   78.180   79.698   80.4268   81.150   82.597</span>
<span class="co">#&gt;   mu[5]     84.420 1.0149   82.295   83.773   84.4535   85.055   86.357</span>
<span class="co">#&gt;   mu[6]     58.049 1.8657   54.347   56.751   58.1326   59.300   61.617</span>
<span class="co">#&gt;   mu[7]     86.821 1.1331   84.532   86.050   86.8482   87.525   89.058</span>
<span class="co">#&gt;   mu[8]     98.778 1.4648   95.794   97.827   98.7768   99.765  101.537</span>
<span class="co">#&gt;   mu[9]     55.223 2.2063   50.847   53.813   55.2694   56.667   59.470</span>
<span class="co">#&gt;   mu[10]    89.199 1.1134   86.895   88.473   89.2594   89.927   91.342</span>
<span class="co">#&gt;   mu[11]    67.163 1.1823   64.948   66.366   67.1623   67.981   69.530</span>
<span class="co">#&gt;   mu[12]    95.703 1.3546   92.966   94.810   95.7020   96.634   98.242</span>
<span class="co">#&gt;   mu[13]    95.360 1.3312   92.625   94.472   95.3717   96.266   97.838</span>
<span class="co">#&gt;   mu[14]    69.996 1.2452   67.609   69.086   70.0372   70.825   72.341</span>
<span class="co">#&gt;   mu[15]    76.577 1.2319   74.147   75.756   76.5656   77.403   78.957</span>
<span class="co">#&gt;   mu[16]    42.423 2.6812   37.163   40.680   42.4185   44.348   47.491</span>
<span class="co">#&gt;   mu[17]    63.788 2.0474   59.709   62.445   63.8845   65.180   67.719</span>
<span class="co">#&gt;   mu[18]    71.742 1.6353   68.436   70.662   71.7618   72.871   74.843</span>
<span class="co">#&gt;   mu[19]    56.875 2.0653   52.736   55.465   56.9432   58.275   60.921</span>
<span class="co">#&gt;   mu[20]    91.411 1.2572   88.981   90.574   91.4599   92.229   93.847</span>
<span class="co">#&gt;   mu[21]    27.380 2.1404   23.015   26.056   27.3857   28.813   31.589</span>
<span class="co">#&gt;   mu[22]    32.900 1.8222   29.430   31.745   32.9799   34.096   36.377</span>
<span class="co">#&gt;   mu[23]    42.568 1.8560   38.926   41.339   42.6209   43.817   46.215</span>
<span class="co">#&gt;   mu[24]    19.836 2.0071   15.991   18.453   19.8217   21.219   23.659</span>
<span class="co">#&gt;   mu[25]    20.288 0.9844   18.393   19.594   20.3032   20.952   22.253</span>
<span class="co">#&gt;   mu[26]    41.305 1.3765   38.666   40.335   41.3098   42.238   44.058</span>
<span class="co">#&gt;   mu[27]    57.842 2.4851   52.803   56.064   57.8607   59.472   62.820</span>
<span class="co">#&gt;   mu[28]    32.334 1.0883   30.206   31.600   32.3099   33.075   34.583</span>
<span class="co">#&gt;   mu[29]    20.542 0.9869   18.642   19.866   20.5526   21.217   22.478</span>
<span class="co">#&gt;   mu[30]    34.712 1.2637   32.416   33.843   34.6562   35.613   37.234</span>
<span class="co">#&gt;   mu[31]    18.761 1.0835   16.620   18.049   18.7359   19.533   20.873</span>
<span class="co">#&gt;   mu[32]     6.438 1.3934    3.589    5.494    6.5225    7.389    9.101</span>
<span class="co">#&gt;   mu[33]    33.860 1.2037   31.643   33.053   33.7998   34.704   36.329</span>
<span class="co">#&gt;   mu[34]    11.748 1.1544    9.394   10.980   11.7778   12.566   13.889</span>
<span class="co">#&gt;   mu[35]    17.544 1.0965   15.332   16.805   17.5618   18.322   19.658</span>
<span class="co">#&gt;   mu[36]    19.259 1.0086   17.267   18.580   19.2692   19.966   21.164</span>
<span class="co">#&gt;   mu[37]    18.330 1.0362   16.319   17.649   18.3306   19.071   20.343</span>
<span class="co">#&gt;   mu[38]    19.016 1.0545   16.931   18.329   19.0145   19.775   21.082</span>
<span class="co">#&gt;   mu[39]    11.062 1.1709    8.620   10.280   11.0811   11.899   13.165</span>
<span class="co">#&gt;   mu[40]    15.764 1.0563   13.718   15.019   15.7748   16.516   17.795</span>
<span class="co">#&gt;   mu[41]    17.312 1.1562   15.046   16.530   17.2973   18.131   19.626</span>
<span class="co">#&gt;   mu[42]    18.584 1.0178   16.640   17.877   18.6085   19.292   20.577</span>
<span class="co">#&gt;   mu[43]    10.896 1.1914    8.490   10.075   10.9136   11.734   13.085</span>
<span class="co">#&gt;   mu[44]    36.284 1.4340   33.520   35.312   36.2728   37.187   39.210</span>
<span class="co">#&gt;   mu[45]    15.609 1.2874   13.173   14.706   15.5590   16.472   18.222</span>
<span class="co">#&gt;   lp__    -304.779 1.6064 -308.599 -305.579 -304.4984 -303.639 -302.573</span></code></pre></div>
</div>
<div id="convergence-diagnostics-and-model-fit" class="section level3">
<h3><span class="header-section-number">11.3.2</span> Convergence Diagnostics and Model Fit</h3>
<ul>
<li><p><strong>Convergence Diagnostics:</strong> Is this the posterior distribution that you were looking for? These don’t directly say anything about how “good” the model is in terms representing the data, they are only evaluating how well the sampler is doing at sampling the posterior distribution of the given model. If there are problems with these, then the sample results do not represent the posterior distribution, and your inferences will be biased.</p>
<ul>
<li><code>mcse</code>:</li>
<li><code>n_eff</code>:</li>
<li><code>Rhat</code></li>
<li><code>divergences</code></li>
</ul></li>
<li><p><strong>Model fit:</strong> Is this statistical model appropriate for the data? Or better than other models?</p>
<ul>
<li><p>Posterior predictive checks</p></li>
<li><p>Information criteria:</p>
<ul>
<li>WAIC</li>
<li>Leave-one-out Cross-Validation</li>
</ul></li>
</ul></li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-comparison.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="generalized-linear-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jrnold/bayesian_notes/edit/master/intro-regression.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
