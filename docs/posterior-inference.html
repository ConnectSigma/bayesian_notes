<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Updating: A Set of Bayesian Notes</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Updating: A Set of Bayesian Notes">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Updating: A Set of Bayesian Notes" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://jrnold.github.io/bayesian_notes" />
  
  
  <meta name="github-repo" content="jrnold/bayesian_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Updating: A Set of Bayesian Notes" />
  <meta name="twitter:site" content="@jrnld" />
  
  

<meta name="author" content="Jeffrey B. Arnold">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="mcmc-diagnostics.html">
<link rel="next" href="model-checking.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>

\[
\DeclareMathOperator{\E}{E}
\DeclareMathOperator{\mean}{mean}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Cor}{Cor}
\DeclareMathOperator{\Bias}{Bias}
\DeclareMathOperator{\MSE}{MSE}
\DeclareMathOperator{\RMSE}{RMSE}
\DeclareMathOperator{\sd}{sd}
\DeclareMathOperator{\se}{se}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\median}{median}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator{\logistic}{Logistic}
\DeclareMathOperator{\logit}{Logit}

\newcommand{\mat}[1]{\boldsymbol{#1}}
\newcommand{\vec}[1]{\boldsymbol{#1}}
\newcommand{\T}{'}

% This follows BDA
\newcommand{\dunif}{\mathrm{U}}
\newcommand{\dnorm}{\mathrm{N}}
\newcommand{\dlnorm}{\mathrm{lognormal}}
\newcommand{\dmvnorm}{\mathrm{N}}
\newcommand{\dgamma}{\mathrm{Gamma}}
\newcommand{\dinvgamma}{\mathrm{Inv-Gamma}}
\newcommand{\dchisq}[1]{\chi^2_{#1}}
\newcommand{\dinvchisq}[1]{\mathrm{Inv-}\chi^2_{#1}}
\newcommand{\dexp}{\mathrm{Expon}}
\newcommand{\dlaplace}{\mathrm{Laplace}}
\newcommand{\dweibull}{\mathrm{Weibull}}
\newcommand{\dwishart}[1]{\mathrm{Wishart}_{#1}}
\newcommand{\dinvwishart}[1]{\mathrm{Inv-Wishart}_{#1}}
\newcommand{\dlkj}{\mathrm{LkjCorr}}
\newcommand{\dt}[1]{t_{#1}}
\newcommand{\dbeta}{\mathrm{Beta}}
\newcommand{\ddirichlet}{\mathrm{Dirichlet}}
\newcommand{\dlogistic}{\mathrm{Logistic}}
\newcommand{\dllogistic}{\mathrm{Log-logistic}}
\newcommand{\dpois}{\mathrm{Poisson}}
\newcommand{\dbin}{\mathrm{Bin}}
\newcommand{\dmultinom}{\mathrm{Multinom}}
\newcommand{\dnbinom}{\mathrm{Neg-bin}}
\newcommand{\dnbinomalt}{\mathrm{Neg-bin2}}
\newcommand{\dbetabinom}{\mathrm{Beta-bin}}
\newcommand{\dcauchy}{\mathrm{Cauchy}}
\newcommand{\dhalfcauchy}{\mathrm{Cauchy}^{+}}
\newcommand{\dlkjcorr}{\mathrm{LKJ}^{+}}



\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}

\newcommand{\cia}{\perp\!\!\!\perp}
\DeclareMathOperator*{\plim}{plim}
\]

  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Bayesian Notes</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Theory</b></span></li>
<li class="chapter" data-level="1" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>1</b> Bayesian Inference</a></li>
<li class="part"><span><b>II Computation</b></span></li>
<li class="chapter" data-level="2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>2</b> Markov Chain Monte Carlo</a><ul>
<li class="chapter" data-level="2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#monte-carlo-sampling"><i class="fa fa-check"></i><b>2.1</b> Monte Carlo Sampling</a></li>
<li class="chapter" data-level="2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#markov-chain-monte-carlo-sampling"><i class="fa fa-check"></i><b>2.2</b> Markov Chain Monte Carlo Sampling</a></li>
<li class="chapter" data-level="2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#references"><i class="fa fa-check"></i><b>2.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html"><i class="fa fa-check"></i><b>3</b> MCMC Diagnostics</a><ul>
<li class="chapter" data-level="3.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#reparameterize-models"><i class="fa fa-check"></i><b>3.1</b> Reparameterize Models</a></li>
<li class="chapter" data-level="3.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#convergence-diagnostics"><i class="fa fa-check"></i><b>3.2</b> Convergence Diagnostics</a><ul>
<li class="chapter" data-level="3.2.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#potential-scale-reduction-hatr"><i class="fa fa-check"></i><b>3.2.1</b> Potential Scale Reduction (<span class="math inline">\(\hat{R}\)</span>)</a></li>
<li class="chapter" data-level="3.2.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#references-1"><i class="fa fa-check"></i><b>3.2.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#autocorrelation-effective-sample-size-and-mcse"><i class="fa fa-check"></i><b>3.3</b> Autocorrelation, Effective Sample Size, and MCSE</a><ul>
<li class="chapter" data-level="3.3.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#effective-sample-size"><i class="fa fa-check"></i><b>3.3.1</b> Effective Sample Size</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#thinning"><i class="fa fa-check"></i><b>3.4</b> Thinning</a><ul>
<li class="chapter" data-level="3.4.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#traceplots"><i class="fa fa-check"></i><b>3.4.1</b> Traceplots</a></li>
<li class="chapter" data-level="3.4.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#monte-carlo-standard-error-mcse"><i class="fa fa-check"></i><b>3.4.2</b> Monte Carlo Standard Error (MCSE)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#hmc-nut-specific-diagnostics"><i class="fa fa-check"></i><b>3.5</b> HMC-NUT Specific Diagnostics</a><ul>
<li class="chapter" data-level="3.5.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#divergent-transitions"><i class="fa fa-check"></i><b>3.5.1</b> Divergent transitions</a></li>
<li class="chapter" data-level="3.5.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#maximum-treedepth"><i class="fa fa-check"></i><b>3.5.2</b> Maximum Treedepth</a></li>
<li class="chapter" data-level="3.5.3" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#bayesian-fraction-of-missing-information"><i class="fa fa-check"></i><b>3.5.3</b> Bayesian Fraction of Missing Information</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="posterior-inference.html"><a href="posterior-inference.html"><i class="fa fa-check"></i><b>4</b> Posterior Inference</a><ul>
<li class="chapter" data-level="4.1" data-path="posterior-inference.html"><a href="posterior-inference.html#prerequisites"><i class="fa fa-check"></i><b>4.1</b> Prerequisites</a></li>
<li class="chapter" data-level="4.2" data-path="posterior-inference.html"><a href="posterior-inference.html#introduction"><i class="fa fa-check"></i><b>4.2</b> Introduction</a></li>
<li class="chapter" data-level="4.3" data-path="posterior-inference.html"><a href="posterior-inference.html#functions-of-the-posterior-distribution"><i class="fa fa-check"></i><b>4.3</b> Functions of the Posterior Distribution</a></li>
<li class="chapter" data-level="4.4" data-path="posterior-inference.html"><a href="posterior-inference.html#marginal-effects"><i class="fa fa-check"></i><b>4.4</b> Marginal Effects</a><ul>
<li class="chapter" data-level="4.4.1" data-path="posterior-inference.html"><a href="posterior-inference.html#example-marginal-effect-plot-for-x"><i class="fa fa-check"></i><b>4.4.1</b> Example: Marginal Effect Plot for X</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="model-checking.html"><a href="model-checking.html"><i class="fa fa-check"></i><b>5</b> Model Checking</a><ul>
<li class="chapter" data-level="5.1" data-path="model-checking.html"><a href="model-checking.html#why-check-models"><i class="fa fa-check"></i><b>5.1</b> Why check models?</a></li>
<li class="chapter" data-level="5.2" data-path="model-checking.html"><a href="model-checking.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>5.2</b> Posterior Predictive Checks</a><ul>
<li class="chapter" data-level="5.2.1" data-path="model-checking.html"><a href="model-checking.html#bayesian-p-values"><i class="fa fa-check"></i><b>5.2.1</b> Bayesian p-values</a></li>
<li class="chapter" data-level="5.2.2" data-path="model-checking.html"><a href="model-checking.html#test-quantities"><i class="fa fa-check"></i><b>5.2.2</b> Test quantities</a></li>
<li class="chapter" data-level="5.2.3" data-path="model-checking.html"><a href="model-checking.html#p-values-vs.u-values"><i class="fa fa-check"></i><b>5.2.3</b> p-values vs. u-values</a></li>
<li class="chapter" data-level="5.2.4" data-path="model-checking.html"><a href="model-checking.html#marginal-predictive-checks"><i class="fa fa-check"></i><b>5.2.4</b> Marginal predictive checks</a></li>
<li class="chapter" data-level="5.2.5" data-path="model-checking.html"><a href="model-checking.html#outliers"><i class="fa fa-check"></i><b>5.2.5</b> Outliers</a></li>
<li class="chapter" data-level="5.2.6" data-path="model-checking.html"><a href="model-checking.html#grapical-posterior-predictive-checks"><i class="fa fa-check"></i><b>5.2.6</b> Grapical Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="model-checking.html"><a href="model-checking.html#sources"><i class="fa fa-check"></i><b>5.3</b> Sources</a></li>
</ul></li>
<li class="part"><span><b>III Models</b></span></li>
<li class="chapter" data-level="6" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html"><i class="fa fa-check"></i><b>6</b> Introduction to Stan and Linear Regression</a><ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#prerequites"><i class="fa fa-check"></i><b>6.1</b> Prerequites</a></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#the-statistical-model"><i class="fa fa-check"></i><b>6.2</b> The Statistical Model</a><ul>
<li class="chapter" data-level="6.2.1" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#sampling"><i class="fa fa-check"></i><b>6.2.1</b> Sampling</a></li>
<li class="chapter" data-level="6.2.2" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#convergence-diagnostics-and-model-fit"><i class="fa fa-check"></i><b>6.2.2</b> Convergence Diagnostics and Model Fit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="heteroskedasticity-and-robust-regression.html"><a href="heteroskedasticity-and-robust-regression.html"><i class="fa fa-check"></i><b>7</b> Heteroskedasticity and Robust Regression</a><ul>
<li class="chapter" data-level="7.1" data-path="heteroskedasticity-and-robust-regression.html"><a href="heteroskedasticity-and-robust-regression.html#prerequisites-1"><i class="fa fa-check"></i><b>7.1</b> Prerequisites</a></li>
<li class="chapter" data-level="7.2" data-path="heteroskedasticity-and-robust-regression.html"><a href="heteroskedasticity-and-robust-regression.html#linear-regression-with-student-t-distributed-errors"><i class="fa fa-check"></i><b>7.2</b> Linear Regression with Student t distributed errors</a><ul>
<li class="chapter" data-level="7.2.1" data-path="heteroskedasticity-and-robust-regression.html"><a href="heteroskedasticity-and-robust-regression.html#double-exponential-laplace-errors"><i class="fa fa-check"></i><b>7.2.1</b> Double Exponential (Laplace) Errors</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="heteroskedasticity-and-robust-regression.html"><a href="heteroskedasticity-and-robust-regression.html#heteroskedasticity"><i class="fa fa-check"></i><b>7.3</b> Heteroskedasticity</a><ul>
<li class="chapter" data-level="7.3.1" data-path="heteroskedasticity-and-robust-regression.html"><a href="heteroskedasticity-and-robust-regression.html#covariates"><i class="fa fa-check"></i><b>7.3.1</b> Covariates</a></li>
<li class="chapter" data-level="7.3.2" data-path="heteroskedasticity-and-robust-regression.html"><a href="heteroskedasticity-and-robust-regression.html#student-t-error"><i class="fa fa-check"></i><b>7.3.2</b> Student-t Error</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="heteroskedasticity-and-robust-regression.html"><a href="heteroskedasticity-and-robust-regression.html#references-2"><i class="fa fa-check"></i><b>7.4</b> References</a><ul>
<li class="chapter" data-level="7.4.1" data-path="heteroskedasticity-and-robust-regression.html"><a href="heteroskedasticity-and-robust-regression.html#robust-regression"><i class="fa fa-check"></i><b>7.4.1</b> Robust regression</a></li>
<li class="chapter" data-level="7.4.2" data-path="heteroskedasticity-and-robust-regression.html"><a href="heteroskedasticity-and-robust-regression.html#heteroskedasticity-1"><i class="fa fa-check"></i><b>7.4.2</b> Heteroskedasticity</a></li>
<li class="chapter" data-level="7.4.3" data-path="heteroskedasticity-and-robust-regression.html"><a href="heteroskedasticity-and-robust-regression.html#qunatile-regression"><i class="fa fa-check"></i><b>7.4.3</b> Qunatile regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>8</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="8.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#generalized-linear-models-1"><i class="fa fa-check"></i><b>8.1</b> Generalized Linear Models</a></li>
<li class="chapter" data-level="8.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#count-models"><i class="fa fa-check"></i><b>8.2</b> Count Models</a><ul>
<li class="chapter" data-level="8.2.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#poisson"><i class="fa fa-check"></i><b>8.2.1</b> Poisson</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#example"><i class="fa fa-check"></i><b>8.3</b> Example</a></li>
<li class="chapter" data-level="8.4" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#negative-binomial"><i class="fa fa-check"></i><b>8.4</b> Negative Binomial</a><ul>
<li class="chapter" data-level="8.4.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#references-3"><i class="fa fa-check"></i><b>8.4.1</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#multinomial-categorical-models"><i class="fa fa-check"></i><b>8.5</b> Multinomial / Categorical Models</a></li>
<li class="chapter" data-level="8.6" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#gamma-regression"><i class="fa fa-check"></i><b>8.6</b> Gamma Regression</a></li>
<li class="chapter" data-level="8.7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#beta-regression"><i class="fa fa-check"></i><b>8.7</b> Beta Regression</a></li>
<li class="chapter" data-level="8.8" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#ordered-logistic"><i class="fa fa-check"></i><b>8.8</b> Ordered Logistic</a></li>
<li class="chapter" data-level="8.9" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#references-4"><i class="fa fa-check"></i><b>8.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="binomial-models.html"><a href="binomial-models.html"><i class="fa fa-check"></i><b>9</b> Binomial Models</a><ul>
<li class="chapter" data-level="9.0.1" data-path="binomial-models.html"><a href="binomial-models.html#link-functions-link-function"><i class="fa fa-check"></i><b>9.0.1</b> Link Functions {link-function}</a></li>
<li class="chapter" data-level="9.0.2" data-path="binomial-models.html"><a href="binomial-models.html#stan"><i class="fa fa-check"></i><b>9.0.2</b> Stan</a></li>
<li class="chapter" data-level="9.0.3" data-path="binomial-models.html"><a href="binomial-models.html#example-vote-turnout"><i class="fa fa-check"></i><b>9.0.3</b> Example: Vote Turnout</a></li>
<li class="chapter" data-level="9.0.4" data-path="binomial-models.html"><a href="binomial-models.html#separation"><i class="fa fa-check"></i><b>9.0.4</b> Separation</a></li>
<li class="chapter" data-level="9.1" data-path="binomial-models.html"><a href="binomial-models.html#rare-events-logit"><i class="fa fa-check"></i><b>9.1</b> Rare Events Logit</a></li>
<li class="chapter" data-level="9.2" data-path="binomial-models.html"><a href="binomial-models.html#case-control"><i class="fa fa-check"></i><b>9.2</b> Case Control</a><ul>
<li class="chapter" data-level="9.2.1" data-path="binomial-models.html"><a href="binomial-models.html#references-6"><i class="fa fa-check"></i><b>9.2.1</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="unbounded-count-models.html"><a href="unbounded-count-models.html"><i class="fa fa-check"></i><b>10</b> Unbounded Count Models</a><ul>
<li class="chapter" data-level="10.1" data-path="unbounded-count-models.html"><a href="unbounded-count-models.html#poisson-1"><i class="fa fa-check"></i><b>10.1</b> Poisson</a></li>
<li class="chapter" data-level="10.2" data-path="unbounded-count-models.html"><a href="unbounded-count-models.html#negative-binomial-1"><i class="fa fa-check"></i><b>10.2</b> Negative Binomial</a><ul>
<li class="chapter" data-level="10.2.1" data-path="unbounded-count-models.html"><a href="unbounded-count-models.html#stan-1"><i class="fa fa-check"></i><b>10.2.1</b> Stan</a></li>
<li class="chapter" data-level="10.2.2" data-path="unbounded-count-models.html"><a href="unbounded-count-models.html#example-number-of-number-o"><i class="fa fa-check"></i><b>10.2.2</b> Example: Number of Number o</a></li>
<li class="chapter" data-level="10.2.3" data-path="unbounded-count-models.html"><a href="unbounded-count-models.html#references-7"><i class="fa fa-check"></i><b>10.2.3</b> References</a></li>
<li class="chapter" data-level="10.2.4" data-path="unbounded-count-models.html"><a href="unbounded-count-models.html#link-functions"><i class="fa fa-check"></i><b>10.2.4</b> Link functions</a></li>
<li class="chapter" data-level="10.2.5" data-path="unbounded-count-models.html"><a href="unbounded-count-models.html#stan-2"><i class="fa fa-check"></i><b>10.2.5</b> Stan</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="unbounded-count-models.html"><a href="unbounded-count-models.html#example-bilateral-sanctions"><i class="fa fa-check"></i><b>10.3</b> Example: Bilateral Sanctions</a></li>
<li class="chapter" data-level="10.4" data-path="unbounded-count-models.html"><a href="unbounded-count-models.html#negative-binomial-2"><i class="fa fa-check"></i><b>10.4</b> Negative Binomial</a><ul>
<li class="chapter" data-level="10.4.1" data-path="unbounded-count-models.html"><a href="unbounded-count-models.html#example-economic-sanctions-ii-ex-econ-sanctions-2"><i class="fa fa-check"></i><b>10.4.1</b> Example: Economic Sanctions II {ex-econ-sanctions-2}</a></li>
<li class="chapter" data-level="10.4.2" data-path="unbounded-count-models.html"><a href="unbounded-count-models.html#references-8"><i class="fa fa-check"></i><b>10.4.2</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="categorical-variables.html"><a href="categorical-variables.html"><i class="fa fa-check"></i><b>11</b> Categorical Variables</a><ul>
<li class="chapter" data-level="11.1" data-path="categorical-variables.html"><a href="categorical-variables.html#example-mexico-vote-choice"><i class="fa fa-check"></i><b>11.1</b> Example: Mexico Vote Choice</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ordered-categorical-outcomes.html"><a href="ordered-categorical-outcomes.html"><i class="fa fa-check"></i><b>12</b> Ordered Categorical Outcomes</a></li>
<li class="chapter" data-level="13" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html"><i class="fa fa-check"></i><b>13</b> Shrinkage and Regularization</a><ul>
<li class="chapter" data-level="13.1" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#normal-linear-regression-model"><i class="fa fa-check"></i><b>13.1</b> Normal Linear Regression Model</a></li>
<li class="chapter" data-level="13.2" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#penalized-regression"><i class="fa fa-check"></i><b>13.2</b> Penalized Regression</a><ul>
<li class="chapter" data-level="13.2.1" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#ridge-regression"><i class="fa fa-check"></i><b>13.2.1</b> Ridge Regression</a></li>
<li class="chapter" data-level="13.2.2" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#lasso"><i class="fa fa-check"></i><b>13.2.2</b> Lasso</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#bayesian-shrinkage-priors"><i class="fa fa-check"></i><b>13.3</b> Bayesian Shrinkage Priors</a></li>
<li class="chapter" data-level="13.4" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#differences-between-bayesian-shrinkage-and-penalized-likelihood"><i class="fa fa-check"></i><b>13.4</b> Differences between Bayesian Shrinkage and Penalized Likelihood</a></li>
<li class="chapter" data-level="13.5" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#hierarchical-shrinkage-priors"><i class="fa fa-check"></i><b>13.5</b> Hierarchical Shrinkage Priors</a></li>
<li class="chapter" data-level="13.6" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#example-1"><i class="fa fa-check"></i><b>13.6</b> Example</a><ul>
<li class="chapter" data-level="13.6.1" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#double-exponential-laplace-prior"><i class="fa fa-check"></i><b>13.6.1</b> Double Exponential (Laplace) Prior</a></li>
<li class="chapter" data-level="13.6.2" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#hierarchical-prior-hs"><i class="fa fa-check"></i><b>13.6.2</b> Hierarchical Prior (HS)</a></li>
<li class="chapter" data-level="13.6.3" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#comparison"><i class="fa fa-check"></i><b>13.6.3</b> Comparison</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#shrinkage-parameters"><i class="fa fa-check"></i><b>13.7</b> Shrinkage Parameters</a></li>
<li class="chapter" data-level="13.8" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#choice-of-hyperparameter-on-tau"><i class="fa fa-check"></i><b>13.8</b> Choice of Hyperparameter on <span class="math inline">\(\tau\)</span></a></li>
<li class="chapter" data-level="13.9" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#r-implementations"><i class="fa fa-check"></i><b>13.9</b> R Implementations</a></li>
<li class="chapter" data-level="13.10" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#bayesian-model-averaging"><i class="fa fa-check"></i><b>13.10</b> Bayesian Model Averaging</a><ul>
<li class="chapter" data-level="13.10.1" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#zellners-g-prior"><i class="fa fa-check"></i><b>13.10.1</b> Zellner’s g-prior</a></li>
</ul></li>
<li class="chapter" data-level="13.11" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#slab-and-spike-priors"><i class="fa fa-check"></i><b>13.11</b> Slab and Spike Priors</a></li>
<li class="chapter" data-level="13.12" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#technical-notes"><i class="fa fa-check"></i><b>13.12</b> Technical Notes</a></li>
<li class="chapter" data-level="13.13" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#multiple-comparisons-and-thresholding-rules"><i class="fa fa-check"></i><b>13.13</b> Multiple Comparisons and Thresholding rules</a></li>
<li class="chapter" data-level="13.14" data-path="shrinkage-regularization.html"><a href="shrinkage-regularization.html#examples-of-applications-of-sensitivity-analysis"><i class="fa fa-check"></i><b>13.14</b> Examples of Applications of Sensitivity Analysis</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>14</b> Hierarchical Models</a><ul>
<li class="chapter" data-level="14.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#baseball-hitting"><i class="fa fa-check"></i><b>14.1</b> Baseball Hitting</a><ul>
<li class="chapter" data-level="14.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#other-examples"><i class="fa fa-check"></i><b>14.1.1</b> Other Examples</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#equivalent-models"><i class="fa fa-check"></i><b>14.2</b> Equivalent Models</a><ul>
<li class="chapter" data-level="14.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#group-varying-intercepts"><i class="fa fa-check"></i><b>14.2.1</b> Group Varying Intercepts</a></li>
<li class="chapter" data-level="14.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#separate-local-regressions"><i class="fa fa-check"></i><b>14.2.2</b> Separate local regressions</a></li>
<li class="chapter" data-level="14.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#modeling-the-coefficients-of-a-large-regression-model"><i class="fa fa-check"></i><b>14.2.3</b> Modeling the coefficients of a large regression model</a></li>
<li class="chapter" data-level="14.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#regression-with-multiple-error-terms"><i class="fa fa-check"></i><b>14.2.4</b> Regression with multiple error terms</a></li>
<li class="chapter" data-level="14.2.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#regresion-with-correlated-errors"><i class="fa fa-check"></i><b>14.2.5</b> Regresion with correlated errors</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Appendix</b></span><ul>
<li class="chapter" data-level="14.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#miscellaneous-mathematical-background"><i class="fa fa-check"></i><b>14.3</b> Miscellaneous Mathematical Background</a><ul>
<li class="chapter" data-level="14.3.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#location-scale-families"><i class="fa fa-check"></i><b>14.3.1</b> Location-Scale Families</a></li>
<li class="chapter" data-level="14.3.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#scale-mixtures-of-normal-distributions"><i class="fa fa-check"></i><b>14.3.2</b> Scale Mixtures of Normal Distributions</a></li>
<li class="chapter" data-level="14.3.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#covariance-correlation-matrix-decomposition"><i class="fa fa-check"></i><b>14.3.3</b> Covariance-Correlation Matrix Decomposition</a></li>
<li class="chapter" data-level="14.3.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#qr-factorization"><i class="fa fa-check"></i><b>14.3.4</b> QR Factorization</a></li>
<li class="chapter" data-level="14.3.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#cholesky-decomposition"><i class="fa fa-check"></i><b>14.3.5</b> Cholesky Decomposition</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="notes.html"><a href="notes.html"><i class="fa fa-check"></i><b>15</b> Notes</a><ul>
<li class="chapter" data-level="15.1" data-path="notes.html"><a href="notes.html#syllabi"><i class="fa fa-check"></i><b>15.1</b> Syllabi</a></li>
<li class="chapter" data-level="15.2" data-path="notes.html"><a href="notes.html#textbooks"><i class="fa fa-check"></i><b>15.2</b> Textbooks</a></li>
<li class="chapter" data-level="15.3" data-path="notes.html"><a href="notes.html#topics"><i class="fa fa-check"></i><b>15.3</b> Topics</a><ul>
<li class="chapter" data-level="15.3.1" data-path="notes.html"><a href="notes.html#overviews"><i class="fa fa-check"></i><b>15.3.1</b> Overviews</a></li>
<li class="chapter" data-level="15.3.2" data-path="notes.html"><a href="notes.html#bayesian-philosophy"><i class="fa fa-check"></i><b>15.3.2</b> Bayesian Philosophy</a></li>
<li class="chapter" data-level="15.3.3" data-path="notes.html"><a href="notes.html#bayesian-frequentist-debates"><i class="fa fa-check"></i><b>15.3.3</b> Bayesian Frequentist Debates</a></li>
<li class="chapter" data-level="15.3.4" data-path="notes.html"><a href="notes.html#categorical"><i class="fa fa-check"></i><b>15.3.4</b> Categorical</a></li>
<li class="chapter" data-level="15.3.5" data-path="notes.html"><a href="notes.html#identifiability"><i class="fa fa-check"></i><b>15.3.5</b> Identifiability</a></li>
<li class="chapter" data-level="15.3.6" data-path="notes.html"><a href="notes.html#time-series"><i class="fa fa-check"></i><b>15.3.6</b> Time Series</a></li>
<li class="chapter" data-level="15.3.7" data-path="notes.html"><a href="notes.html#topic-models"><i class="fa fa-check"></i><b>15.3.7</b> Topic Models</a></li>
<li class="chapter" data-level="15.3.8" data-path="notes.html"><a href="notes.html#nonparametric-bayesian-methods"><i class="fa fa-check"></i><b>15.3.8</b> Nonparametric Bayesian Methods</a></li>
<li class="chapter" data-level="15.3.9" data-path="notes.html"><a href="notes.html#prior-elicitation"><i class="fa fa-check"></i><b>15.3.9</b> Prior Elicitation</a></li>
<li class="chapter" data-level="15.3.10" data-path="notes.html"><a href="notes.html#variable-selection"><i class="fa fa-check"></i><b>15.3.10</b> Variable Selection</a></li>
<li class="chapter" data-level="15.3.11" data-path="notes.html"><a href="notes.html#shrinkage"><i class="fa fa-check"></i><b>15.3.11</b> Shrinkage</a></li>
<li class="chapter" data-level="15.3.12" data-path="notes.html"><a href="notes.html#applied-bayes-rule"><i class="fa fa-check"></i><b>15.3.12</b> Applied Bayes Rule</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="notes.html"><a href="notes.html#computation-methods"><i class="fa fa-check"></i><b>15.4</b> Computation Methods</a><ul>
<li class="chapter" data-level="15.4.1" data-path="notes.html"><a href="notes.html#software"><i class="fa fa-check"></i><b>15.4.1</b> Software</a></li>
<li class="chapter" data-level="15.4.2" data-path="notes.html"><a href="notes.html#stan-3"><i class="fa fa-check"></i><b>15.4.2</b> Stan</a></li>
<li class="chapter" data-level="15.4.3" data-path="notes.html"><a href="notes.html#diagrams"><i class="fa fa-check"></i><b>15.4.3</b> Diagrams</a></li>
<li class="chapter" data-level="15.4.4" data-path="notes.html"><a href="notes.html#political-science-bayesian-works"><i class="fa fa-check"></i><b>15.4.4</b> Political Science Bayesian Works</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="notes.html"><a href="notes.html#model-checking-1"><i class="fa fa-check"></i><b>15.5</b> Model Checking</a></li>
<li class="chapter" data-level="15.6" data-path="notes.html"><a href="notes.html#general-applications-and-models"><i class="fa fa-check"></i><b>15.6</b> General Applications and Models</a><ul>
<li class="chapter" data-level="15.6.1" data-path="notes.html"><a href="notes.html#mixed-methods-and-qualitative-research"><i class="fa fa-check"></i><b>15.6.1</b> Mixed Methods and Qualitative Research</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="notes.html"><a href="notes.html#hierarchical-modeling"><i class="fa fa-check"></i><b>15.7</b> Hierarchical Modeling</a></li>
<li class="chapter" data-level="15.8" data-path="notes.html"><a href="notes.html#shrinkageregularization"><i class="fa fa-check"></i><b>15.8</b> Shrinkage/Regularization</a><ul>
<li class="chapter" data-level="15.8.1" data-path="notes.html"><a href="notes.html#examples"><i class="fa fa-check"></i><b>15.8.1</b> Examples</a></li>
<li class="chapter" data-level="15.8.2" data-path="notes.html"><a href="notes.html#latent-variable-models"><i class="fa fa-check"></i><b>15.8.2</b> Latent Variable Models</a></li>
</ul></li>
<li class="chapter" data-level="15.9" data-path="notes.html"><a href="notes.html#bayes-theorem-examples"><i class="fa fa-check"></i><b>15.9</b> Bayes Theorem Examples</a><ul>
<li class="chapter" data-level="15.9.1" data-path="notes.html"><a href="notes.html#miscallaneous"><i class="fa fa-check"></i><b>15.9.1</b> Miscallaneous</a></li>
<li class="chapter" data-level="15.9.2" data-path="notes.html"><a href="notes.html#german-tank-problem"><i class="fa fa-check"></i><b>15.9.2</b> German Tank Problem</a></li>
</ul></li>
<li class="chapter" data-level="15.10" data-path="notes.html"><a href="notes.html#good-turing-estimator"><i class="fa fa-check"></i><b>15.10</b> Good-Turing Estimator</a></li>
<li class="chapter" data-level="15.11" data-path="notes.html"><a href="notes.html#reproducibility"><i class="fa fa-check"></i><b>15.11</b> Reproducibility</a><ul>
<li class="chapter" data-level="15.11.1" data-path="notes.html"><a href="notes.html#uncategorized"><i class="fa fa-check"></i><b>15.11.1</b> Uncategorized</a></li>
</ul></li>
<li class="chapter" data-level="15.12" data-path="notes.html"><a href="notes.html#empirical-bayes"><i class="fa fa-check"></i><b>15.12</b> Empirical Bayes</a></li>
<li class="chapter" data-level="15.13" data-path="notes.html"><a href="notes.html#things-to-cover"><i class="fa fa-check"></i><b>15.13</b> Things to cover</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-9.html"><a href="references-9.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Updating: A Set of Bayesian Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="posterior-inference" class="section level1">
<h1><span class="header-section-number">4</span> Posterior Inference</h1>
<div id="prerequisites" class="section level2">
<h2><span class="header-section-number">4.1</span> Prerequisites</h2>
<p>The <strong><a href="https://cran.r-project.org/package=haven">haven</a></strong> package is used to read Stata <code>.dta</code> files.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;rubbish&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;haven&quot;</span>)</code></pre></div>
</div>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">4.2</span> Introduction</h2>
<p>The posterior distribution is the probability distribution <span class="math inline">\(\Pr(\theta | y)\)</span>.</p>
<p>One we have the posterior distribution, or more often a sample from the posterior distribution, it is relatively easy to perform inference on any function of the posterior.</p>
<p>Common statistics used to summarize the posterior distribution:</p>
<ul>
<li>mean: <span class="math inline">\(\E(p(\theta | y)) \approx \frac{1}{S} \sum_{i = 1}^S \theta^{(s)}\)</span></li>
<li>median: <span class="math inline">\(\median(p(\theta | y)) \approx \median \theta^{(s)}\)</span></li>
<li>quantiles: 2.5%, 5%, 25%, 50%, 75%, 95%, 97.5%</li>
<li><p>credible interval:</p>
<ul>
<li>central credible interval: the interval between the p/2% and 1 - p/2% quantiles</li>
<li>highest posterior density interval: the narrowest interval containing p% of distribution</li>
</ul></li>
<li><p>marginal densities</p></li>
</ul>
</div>
<div id="functions-of-the-posterior-distribution" class="section level2">
<h2><span class="header-section-number">4.3</span> Functions of the Posterior Distribution</h2>
<p>It is also easy to conduct inference on functions of the posterior distribution.</p>
<p>Suppose <span class="math inline">\(\theta^{(1)}, \dots, \theta^{(S)}\)</span> are a sample from <span class="math inline">\(p(\theta | y)\)</span>, the <span class="math inline">\(f(\theta^{(1)}), \dots, f(\theta^{(S)})\)</span> are a sample from <span class="math inline">\(p(f(\theta) | y)\)</span>.</p>
<p>This is not easy for methods like MLE that produce point estimates:</p>
<ul>
<li>Even in OLS, non-linear functions coefficients generally require either the Delta method or bootstrapping to calculate confidence intervals.</li>
<li><span class="citation">Berry, Golder, and Milton (2012)</span>, <span class="citation">Golder (2017)</span>,<span class="citation">Brambor, Clark, and Golder (2006)</span> discuss calculating confidence intervals</li>
<li>See <span class="citation">Rainey (2016b)</span> on “transformation induced bias”</li>
<li>See <span class="citation">Carpenter (2016)</span> on how reparameterization affects point estimates; this is a Stan Case study with working code</li>
</ul>
</div>
<div id="marginal-effects" class="section level2">
<h2><span class="header-section-number">4.4</span> Marginal Effects</h2>
<div id="example-marginal-effect-plot-for-x" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Example: Marginal Effect Plot for X</h3>
<p><span class="citation">Berry, Golder, and Milton (2012)</span> replicates <span class="citation">Alexseev (2006)</span> as an example of a model with an interaction between <span class="math inline">\(X\)</span> and <span class="math inline">\(Z\)</span>. <span class="math display">\[
Y = \beta_0 + \beta_x X + \beta_z Z + \beta_{xz} X Z + \epsilon
\]</span> In this case, the hypothesis of interest involves the marginal effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>, <span class="math display">\[
\frac{\partial \E(Y|.)}{\partial X} = \beta_z + \beta_{xz} Z
\]</span> Since there is an interaction, the marginal effect of <span class="math inline">\(X\)</span> is not simply the coefficient <span class="math inline">\(\beta_z\)</span>, but is a function of another predictor, <span class="math inline">\(Z\)</span>. Point estimates of the marginal effects with interactions are relatively easy to construct, but confidence intervals for the MLE estimates quickly involve multiple terms and either the Delta method approximation or bootstrapping to calculate.</p>
<p>We will consider this problem from a Bayesian estimation perspective, and calculate point estimates (posterior mean) and credible intervals of the marginal effects.</p>
<p>The particular example is <span class="citation">Alexseev (2006)</span>, which analyzes how changes in the ethnic composition of Russian regions affected the vote share of the extreme Russian nationalist Zhirinovsky Bloc in 2003 Russian State Duma elections.[^alexseev1]</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">alexseev &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;data/alexseev.dta&quot;</span>)</code></pre></div>
<p>[alexseev1]: Some of the replication code and material can be found on <a href="http://mattgolder.com/interactions">Matt Golder’s website</a>.</p>
<p>One claim of <span class="citation">Alexseev (2006)</span> was that support for anti-immigrant parties depends on the percentage of the population of the dominant ethnic group (Slavic) and the change in the percentage the non-dominant share. To test that hypothesis, <span class="citation">Alexseev (2006)</span> estimates the following model, <span class="math display">\[
\begin{multline}
\mathtt{xenovote}_i = \beta_0 + \beta_s \mathtt{slavicshare}_i + 
\beta_{n} \mathtt{changenonslav} + \\
\beta_{sn} (\mathtt{slavicshare}_i \times \mathtt{changenonslav}_i) + 
\gamma z_{i} + \epsilon_{i},
\end{multline}
\]</span> where <span class="math inline">\(z_i\)</span> is a vector of control variables.</p>
<ul>
<li><code>xenovote</code>: Xenophobic voting. Share of vote for the Zhironovsky Bloc.</li>
<li><code>slavicshare</code>: <em>Slavic Share.</em> Proportion Slavic in the district.</li>
<li><code>changenonslav</code>: <span class="math inline">\(\Delta\)</span> <em>non-Slavic Share</em> Change in the proprotion of non-Slavic groups in the region.</li>
</ul>
<p>The model was estimated by OLS,<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_f &lt;-<span class="st"> </span>(xenovote <span class="op">~</span><span class="st"> </span>slavicshare <span class="op">*</span><span class="st"> </span>changenonslav <span class="op">+</span><span class="st"> </span>inc9903 <span class="op">+</span><span class="st"> </span>eduhi02 <span class="op">+</span><span class="st"> </span>unemp02 <span class="op">+</span>
<span class="st">            </span>apt9200 <span class="op">+</span><span class="st"> </span>vsall03 <span class="op">+</span><span class="st"> </span>brdcont)
<span class="kw">lm</span>(mod_f, <span class="dt">data =</span> alexseev)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = mod_f, data = alexseev)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;               (Intercept)                slavicshare  </span>
<span class="co">#&gt;                  8.942878                   0.031486  </span>
<span class="co">#&gt;             changenonslav                    inc9903  </span>
<span class="co">#&gt;                 -0.851108                   0.000234  </span>
<span class="co">#&gt;                   eduhi02                    unemp02  </span>
<span class="co">#&gt;                 -0.039512                   1.432013  </span>
<span class="co">#&gt;                   apt9200                    vsall03  </span>
<span class="co">#&gt;                  0.030125                   0.661163  </span>
<span class="co">#&gt;                   brdcont  slavicshare:changenonslav  </span>
<span class="co">#&gt;                  2.103688                   0.008226</span></code></pre></div>
<p>Use the <code>lm_preprocess</code> function in the <a href="https://jrnold.github.com/rubbish">rubbish</a> package to turn the model formula into a list with relevant data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_data &lt;-<span class="st"> </span><span class="kw">lm_preprocess</span>(mod_f, <span class="dt">data =</span> alexseev)[<span class="kw">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;y&quot;</span>)]

mod_data &lt;-<span class="st"> </span><span class="kw">within</span>(mod_data, {
  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(X)
  k &lt;-<span class="st"> </span><span class="kw">ncol</span>(X)
  M &lt;-<span class="st"> </span><span class="dv">100</span>
  changenonslav &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(X[ , <span class="st">&quot;changenonslav&quot;</span>]),                               <span class="kw">max</span>(X[ , <span class="st">&quot;changenonslav&quot;</span>]),
                       <span class="dt">length.out =</span> M)
  idx_b_slavicshare &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">colnames</span>(X) <span class="op">==</span><span class="st"> &quot;slavicshare&quot;</span>)
  idx_b_slavicshare_changenonslav &lt;-
<span class="st">    </span><span class="kw">which</span>(<span class="kw">colnames</span>(X) <span class="op">==</span><span class="st"> &quot;slavicshare:changenonslav&quot;</span>)
  b_loc &lt;-<span class="st"> </span><span class="dv">0</span>
  <span class="co"># data appropriate prior</span>
  b_scale &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">apply</span>(X, <span class="dv">2</span>, sd)) <span class="op">*</span><span class="st"> </span><span class="dv">3</span>
  sigma_scale &lt;-<span class="st"> </span><span class="kw">sd</span>(y)
})</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod</code></pre></div>
<pre>
  <code class="stan">data {
  // number of observations
  int n;
  // response vector
  vector[n] y;
  // number of columns in the design matrix X
  int k;
  // design matrix X
  matrix [n, k] X;
  // marfx
  // indexes of main and interaction coef
  int idx_b_slavicshare;
  int idx_b_slavicshare_changenonslav;
  int M;
  vector[M] changenonslav;
  // beta prior
  real b_loc;
  real<lower = 0.0> b_scale;
  // sigma prior
  real sigma_scale;
}
parameters {
  // regression coefficient vector
  vector[k] b;
  // scale of the regression errors
  real<lower = 0.0> sigma;
}
transformed parameters {
  // mu is the observation fitted/predicted value
  // also called yhat
  vector[n] mu;
  mu = X * b;
}
model {
  // priors
  b ~ normal(b_loc, b_scale);
  sigma ~ cauchy(0, sigma_scale);
  // likelihood
  y ~ normal(mu, sigma);
}
generated quantities {
  # hardcoded marginal effectx
  vector[M] dydx;
  dydx = b[idx_b_slavicshare] + b[idx_b_slavicshare_changenonslav] * changenonslav;
}</code>
</pre>
<p>The function <a href="https://www.rdocumentation.org/packages/rstan/topics/extract">rstan</a> extracts parameters from the <a href="https://www.rdocumentation.org/packages/rstan/topics/stanfit">rstan</a> object as a list with an element for each parameter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dydx_all &lt;-
<span class="st">  </span>rstan<span class="op">::</span><span class="kw">extract</span>(mod_fit, <span class="dt">pars =</span> <span class="st">&quot;dydx&quot;</span>)<span class="op">$</span>dydx</code></pre></div>
<p>To make it easier to use with <code>ggplot</code>, convert it to a data frame with columns <code>.id</code> (number), <code>changeonslav</code> (original value of <code>changeonslav</code> passed to the sampler), and <code>value</code> (the value of the marginal effect).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dydx_all &lt;-
<span class="st">  </span>dydx_all <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">as.tibble</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">.iter =</span> <span class="kw">row_number</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(.id, value, <span class="op">-</span>.iter) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># merge with original values of changenonslav</span>
<span class="st">  </span><span class="kw">left_join</span>(<span class="kw">tibble</span>(<span class="dt">.id =</span> <span class="kw">paste0</span>(<span class="st">&quot;V&quot;</span>, <span class="kw">seq_along</span>(mod_data<span class="op">$</span>changenonslav)),
            <span class="dt">changenonslav =</span> mod_data<span class="op">$</span>changenonslav),
            <span class="dt">by =</span> <span class="st">&quot;.id&quot;</span>)</code></pre></div>
<p>Since values for a marginal effect line is generated for each iteration, the posterior distribution of <span class="math inline">\(\partial E(\mathtt{xenovote}|.) / \partial slavicshare\)</span> can be plotted as lines. Since the number of lines would be too many to display effectively, plot 256 of them:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dydx_all <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(.iter <span class="op">%in%</span><span class="st"> </span><span class="kw">sample</span>(<span class="kw">unique</span>(.iter), <span class="dv">2</span> <span class="op">^</span><span class="st"> </span><span class="dv">8</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> changenonslav, <span class="dt">y =</span> value, <span class="dt">group =</span> .iter)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Marginal effect of slavic share&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="kw">paste</span>(<span class="kw">expression</span>(Delta, <span class="st">&quot;non-Slavic Share&quot;</span>)))</code></pre></div>
<p><img src="posterior-inference_files/figure-html/unnamed-chunk-11-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Alternatively, we can summarize the posterior distribution of the marginal effects with a line (posterior mean) and credible interval regions (50%, 90%):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dydx_summary &lt;-
<span class="st">  </span>dydx_all <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(changenonslav) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(value),
            <span class="dt">q5 =</span> <span class="kw">quantile</span>(value, <span class="fl">0.05</span>),
            <span class="dt">q25 =</span> <span class="kw">quantile</span>(value, <span class="fl">0.25</span>),
            <span class="dt">q75 =</span> <span class="kw">quantile</span>(value, <span class="fl">0.75</span>),            
            <span class="dt">q95 =</span> <span class="kw">quantile</span>(value, <span class="fl">0.95</span>))
<span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span>modelr<span class="op">::</span><span class="kw">geom_ref_line</span>(<span class="dt">h =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> dydx_summary,
              <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> changenonslav, <span class="dt">ymin =</span> q5, <span class="dt">ymax =</span> q95),
              <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st">  </span>
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> dydx_summary,
              <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> changenonslav, <span class="dt">ymin =</span> q25, <span class="dt">ymax =</span> q75), 
              <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> dydx_summary,
            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> changenonslav, <span class="dt">y =</span> mean),
            <span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_rug</span>(<span class="dt">data =</span> alexseev, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> changenonslav), <span class="dt">sides =</span> <span class="st">&quot;b&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Marginal effect of slavic share&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(Delta, <span class="st">&quot;non-Slavic Share&quot;</span>)))</code></pre></div>
<p><img src="posterior-inference_files/figure-html/unnamed-chunk-12-1.png" width="70%" style="display: block; margin: auto;" /> The plot above also includes a rug with the observed values of <code>changenonslav</code> in the sample.</p>
<ul>
<li><strong>Q:</strong> For each value of <code>changenonslav</code>, what is the probability that the marginal effect of <code>slavicshare</code> is greater than 0?</li>
<li><strong>Q:</strong> Reestimate the model, but calculate the marginal effect of <code>slavicshare</code> for all observed values of <code>changenonslav</code> in the sample. For each observation, calculate the probability that the marginal effect is greater than 0. What proporation of observations is the probability that the marginal effect is greater than zero.</li>
<li><strong>Q:</strong> Suppose you want to calculate the expected probability that the marginal effect of <code>slavicshare</code> is greater than zero in the sample. Let <span class="math inline">\(\theta^{S}_i\)</span> be the parameter for the marginal effect of <code>slavicshare</code> on the <code>xenovote</code>. Consider these two calculations: <span class="math display">\[
\frac{1}{N} \sum_{i = 1}^n \left( \frac{1}{S} \sum_{s = 1}^S I(\theta^{(s)}_i &gt; 0) \right)
\]</span> and <span class="math display">\[
\frac{1}{S} \sum_{s = 1}^S \left( \frac{1}{N} \sum_{i = 1}^N I(\theta^{(s)}_i &gt; 0) \right) .
\]</span> Are they the same? What are their substantive interpretations?</li>
<li><strong>Q:</strong> Construct the same plot but for Figure 5(b) in <span class="citation">Berry, Golder, and Milton (2012)</span>, which displays the marginaleffects of <span class="math inline">\(\Delta\)</span> <em>non-Slavic</em> on <em>Xenophobic</em> voting.</li>
</ul>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>The original model used cluster robust standard errors, which will be ignored for now.<a href="posterior-inference.html#fnref2">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mcmc-diagnostics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-checking.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jrnold/bayesian_notes/edit/master/posterior-inference.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
