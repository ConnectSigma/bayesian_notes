<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Updating: A Set of Bayesian Notes</title>
  <meta name="description" content="Updating: A Set of Bayesian Notes">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Updating: A Set of Bayesian Notes" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://jrnold.github.io/bayesian_notes" />
  
  
  <meta name="github-repo" content="jrnold/bayesian_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Updating: A Set of Bayesian Notes" />
  <meta name="twitter:site" content="@jrnld" />
  
  

<meta name="author" content="Jeffrey B. Arnold">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="hierarchical-models.html">
<link rel="next" href="distributions.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/d3-3.3.8/d3.min.js"></script>
<script src="libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/chromatography-0.1/chromatography.js"></script>
<script src="libs/DiagrammeR-binding-1.0.0/DiagrammeR.js"></script>
<script src="libs/viz-0.3/viz.js"></script>
<script src="libs/grViz-binding-1.0.0/grViz.js"></script>



<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Bayesian Notes</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>1</b> Bayesian Inference</a><ul>
<li class="chapter" data-level="1.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html#bayesian-analysis"><i class="fa fa-check"></i><b>1.1</b> Bayesian Analysis</a></li>
<li class="chapter" data-level="1.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html#posterior-predictive-distribution"><i class="fa fa-check"></i><b>1.2</b> Posterior Predictive Distribution</a></li>
</ul></li>
<li class="part"><span><b>I Theory</b></span></li>
<li class="chapter" data-level="2" data-path="bayes-theorem.html"><a href="bayes-theorem.html"><i class="fa fa-check"></i><b>2</b> Bayes Theorem</a><ul>
<li class="chapter" data-level="" data-path="bayes-theorem.html"><a href="bayes-theorem.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="2.1" data-path="bayes-theorem.html"><a href="bayes-theorem.html#introduction-to-bayes-theorem"><i class="fa fa-check"></i><b>2.1</b> Introduction to Bayes’ Theorem</a></li>
<li class="chapter" data-level="2.2" data-path="bayes-theorem.html"><a href="bayes-theorem.html#examples"><i class="fa fa-check"></i><b>2.2</b> Examples</a><ul>
<li class="chapter" data-level="2.2.1" data-path="bayes-theorem.html"><a href="bayes-theorem.html#taxi-cab-problem"><i class="fa fa-check"></i><b>2.2.1</b> Taxi-Cab Problem</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="bayes-theorem.html"><a href="bayes-theorem.html#why-most-research-findings-are-false"><i class="fa fa-check"></i><b>2.3</b> Why most research findings are false</a><ul>
<li class="chapter" data-level="2.3.1" data-path="bayes-theorem.html"><a href="bayes-theorem.html#questions"><i class="fa fa-check"></i><b>2.3.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="bayes-theorem.html"><a href="bayes-theorem.html#measurement-error-and-rare-events-in-surveys"><i class="fa fa-check"></i><b>2.4</b> Measurement Error and Rare Events in Surveys</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html"><i class="fa fa-check"></i><b>3</b> Example: Predicting Names from Ages</a><ul>
<li class="chapter" data-level="" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="3.1" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#statement-of-the-problem"><i class="fa fa-check"></i><b>3.1</b> Statement of the problem</a></li>
<li class="chapter" data-level="3.2" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#data-wrangling"><i class="fa fa-check"></i><b>3.2</b> Data Wrangling</a></li>
<li class="chapter" data-level="3.3" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#probability-of-age-given-name-and-sex"><i class="fa fa-check"></i><b>3.3</b> Probability of age given name and sex</a><ul>
<li class="chapter" data-level="3.3.1" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#questions-1"><i class="fa fa-check"></i><b>3.3.1</b> Questions</a></li>
<li class="chapter" data-level="3.3.2" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#references"><i class="fa fa-check"></i><b>3.3.2</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i><b>4</b> Naive Bayes</a><ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#prerequisites-2"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="4.1" data-path="naive-bayes.html"><a href="naive-bayes.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="naive-bayes.html"><a href="naive-bayes.html#examples-1"><i class="fa fa-check"></i><b>4.2</b> Examples</a><ul>
<li class="chapter" data-level="4.2.1" data-path="naive-bayes.html"><a href="naive-bayes.html#federalist-papers"><i class="fa fa-check"></i><b>4.2.1</b> Federalist Papers</a></li>
<li class="chapter" data-level="4.2.2" data-path="naive-bayes.html"><a href="naive-bayes.html#extensions"><i class="fa fa-check"></i><b>4.2.2</b> Extensions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="naive-bayes.html"><a href="naive-bayes.html#details"><i class="fa fa-check"></i><b>4.3</b> Details</a><ul>
<li class="chapter" data-level="4.3.1" data-path="naive-bayes.html"><a href="naive-bayes.html#generative-vs.discriminative-models"><i class="fa fa-check"></i><b>4.3.1</b> Generative vs. Discriminative Models</a></li>
<li class="chapter" data-level="4.3.2" data-path="naive-bayes.html"><a href="naive-bayes.html#estimation"><i class="fa fa-check"></i><b>4.3.2</b> Estimation</a></li>
<li class="chapter" data-level="4.3.3" data-path="naive-bayes.html"><a href="naive-bayes.html#prediction"><i class="fa fa-check"></i><b>4.3.3</b> Prediction</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="naive-bayes.html"><a href="naive-bayes.html#references-1"><i class="fa fa-check"></i><b>4.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="priors.html"><a href="priors.html"><i class="fa fa-check"></i><b>5</b> Priors</a><ul>
<li class="chapter" data-level="5.1" data-path="priors.html"><a href="priors.html#levels-of-priors"><i class="fa fa-check"></i><b>5.1</b> Levels of Priors</a></li>
<li class="chapter" data-level="5.2" data-path="priors.html"><a href="priors.html#conjugate-priors"><i class="fa fa-check"></i><b>5.2</b> Conjugate Priors</a><ul>
<li class="chapter" data-level="5.2.1" data-path="priors.html"><a href="priors.html#binomial-beta"><i class="fa fa-check"></i><b>5.2.1</b> Binomial-Beta</a></li>
<li class="chapter" data-level="5.2.2" data-path="priors.html"><a href="priors.html#categorical-dirichlet"><i class="fa fa-check"></i><b>5.2.2</b> Categorical-Dirichlet</a></li>
<li class="chapter" data-level="5.2.3" data-path="priors.html"><a href="priors.html#poisson-gamma"><i class="fa fa-check"></i><b>5.2.3</b> Poisson-Gamma</a></li>
<li class="chapter" data-level="5.2.4" data-path="priors.html"><a href="priors.html#normal-with-known-variance"><i class="fa fa-check"></i><b>5.2.4</b> Normal with known variance</a></li>
<li class="chapter" data-level="5.2.5" data-path="priors.html"><a href="priors.html#exponential-family"><i class="fa fa-check"></i><b>5.2.5</b> Exponential Family</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="priors.html"><a href="priors.html#improper-priors"><i class="fa fa-check"></i><b>5.3</b> Improper Priors</a></li>
<li class="chapter" data-level="5.4" data-path="priors.html"><a href="priors.html#cromwells-rule"><i class="fa fa-check"></i><b>5.4</b> Cromwell’s Rule</a></li>
<li class="chapter" data-level="5.5" data-path="priors.html"><a href="priors.html#asymptotics"><i class="fa fa-check"></i><b>5.5</b> Asymptotics</a></li>
<li class="chapter" data-level="5.6" data-path="priors.html"><a href="priors.html#proper-and-improper-priors"><i class="fa fa-check"></i><b>5.6</b> Proper and Improper Priors</a></li>
<li class="chapter" data-level="5.7" data-path="priors.html"><a href="priors.html#hyperpriors-and-hyperparameters"><i class="fa fa-check"></i><b>5.7</b> Hyperpriors and Hyperparameters</a></li>
<li class="chapter" data-level="5.8" data-path="priors.html"><a href="priors.html#references-2"><i class="fa fa-check"></i><b>5.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="estimation-1.html"><a href="estimation-1.html"><i class="fa fa-check"></i><b>6</b> Estimation</a><ul>
<li class="chapter" data-level="6.1" data-path="estimation-1.html"><a href="estimation-1.html#point-estimates"><i class="fa fa-check"></i><b>6.1</b> Point Estimates</a></li>
<li class="chapter" data-level="6.2" data-path="estimation-1.html"><a href="estimation-1.html#credible-intervals"><i class="fa fa-check"></i><b>6.2</b> Credible Intervals</a><ul>
<li class="chapter" data-level="6.2.1" data-path="estimation-1.html"><a href="estimation-1.html#compared-to-confidence-intervals"><i class="fa fa-check"></i><b>6.2.1</b> Compared to confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="estimation-1.html"><a href="estimation-1.html#bayesian-decision-theory"><i class="fa fa-check"></i><b>6.3</b> Bayesian Decision Theory</a></li>
</ul></li>
<li class="part"><span><b>II Computation</b></span></li>
<li class="chapter" data-level="7" data-path="bayesian-computation.html"><a href="bayesian-computation.html"><i class="fa fa-check"></i><b>7</b> Bayesian Computation</a><ul>
<li class="chapter" data-level="7.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#how-to-calculate-a-posterior"><i class="fa fa-check"></i><b>7.1</b> How to calculate a posterior?</a></li>
<li class="chapter" data-level="7.2" data-path="bayesian-computation.html"><a href="bayesian-computation.html#example-globe-tossing-model"><i class="fa fa-check"></i><b>7.2</b> Example: Globe-tossing model</a></li>
<li class="chapter" data-level="7.3" data-path="bayesian-computation.html"><a href="bayesian-computation.html#quadrature"><i class="fa fa-check"></i><b>7.3</b> Quadrature</a><ul>
<li class="chapter" data-level="7.3.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#grid-approximation"><i class="fa fa-check"></i><b>7.3.1</b> Grid approximation</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="bayesian-computation.html"><a href="bayesian-computation.html#functional-approximations"><i class="fa fa-check"></i><b>7.4</b> Functional Approximations</a><ul>
<li class="chapter" data-level="7.4.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#maximum-a-posteriori"><i class="fa fa-check"></i><b>7.4.1</b> Maximum A Posteriori</a></li>
<li class="chapter" data-level="7.4.2" data-path="bayesian-computation.html"><a href="bayesian-computation.html#laplace-approximation"><i class="fa fa-check"></i><b>7.4.2</b> Laplace Approximation</a></li>
<li class="chapter" data-level="7.4.3" data-path="bayesian-computation.html"><a href="bayesian-computation.html#variational-inference"><i class="fa fa-check"></i><b>7.4.3</b> Variational Inference</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="bayesian-computation.html"><a href="bayesian-computation.html#sampling-methods"><i class="fa fa-check"></i><b>7.5</b> Sampling Methods</a><ul>
<li class="chapter" data-level="7.5.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#numerical-integration"><i class="fa fa-check"></i><b>7.5.1</b> Numerical Integration</a></li>
<li class="chapter" data-level="7.5.2" data-path="bayesian-computation.html"><a href="bayesian-computation.html#inverse-transform-sampling"><i class="fa fa-check"></i><b>7.5.2</b> Inverse transform sampling</a></li>
<li class="chapter" data-level="7.5.3" data-path="bayesian-computation.html"><a href="bayesian-computation.html#direct-approximation"><i class="fa fa-check"></i><b>7.5.3</b> Direct approximation</a></li>
<li class="chapter" data-level="7.5.4" data-path="bayesian-computation.html"><a href="bayesian-computation.html#rejection-sampling"><i class="fa fa-check"></i><b>7.5.4</b> Rejection sampling</a></li>
<li class="chapter" data-level="7.5.5" data-path="bayesian-computation.html"><a href="bayesian-computation.html#importance-sampling"><i class="fa fa-check"></i><b>7.5.5</b> Importance Sampling</a></li>
<li class="chapter" data-level="7.5.6" data-path="bayesian-computation.html"><a href="bayesian-computation.html#mcmc-methods"><i class="fa fa-check"></i><b>7.5.6</b> MCMC Methods</a></li>
<li class="chapter" data-level="7.5.7" data-path="bayesian-computation.html"><a href="bayesian-computation.html#discarding-early-iterations"><i class="fa fa-check"></i><b>7.5.7</b> Discarding early iterations</a></li>
<li class="chapter" data-level="7.5.8" data-path="bayesian-computation.html"><a href="bayesian-computation.html#monte-carlo-sampling"><i class="fa fa-check"></i><b>7.5.8</b> Monte Carlo Sampling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html"><i class="fa fa-check"></i><b>8</b> MCMC Diagnostics</a><ul>
<li class="chapter" data-level="" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="8.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#reparameterize-models"><i class="fa fa-check"></i><b>8.1</b> Reparameterize Models</a></li>
<li class="chapter" data-level="8.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#convergence-diagnostics"><i class="fa fa-check"></i><b>8.2</b> Convergence Diagnostics</a><ul>
<li class="chapter" data-level="8.2.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#potential-scale-reduction-hatr"><i class="fa fa-check"></i><b>8.2.1</b> Potential Scale Reduction (<span class="math inline">\(\hat{R}\)</span>)</a></li>
<li class="chapter" data-level="8.2.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#references-3"><i class="fa fa-check"></i><b>8.2.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#autocorrelation-effective-sample-size-and-mcse"><i class="fa fa-check"></i><b>8.3</b> Autocorrelation, Effective Sample Size, and MCSE</a><ul>
<li class="chapter" data-level="8.3.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#effective-sample-size"><i class="fa fa-check"></i><b>8.3.1</b> Effective Sample Size</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#thinning"><i class="fa fa-check"></i><b>8.4</b> Thinning</a><ul>
<li class="chapter" data-level="8.4.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#traceplots"><i class="fa fa-check"></i><b>8.4.1</b> Traceplots</a></li>
<li class="chapter" data-level="8.4.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#monte-carlo-standard-error-mcse"><i class="fa fa-check"></i><b>8.4.2</b> Monte Carlo Standard Error (MCSE)</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#hmc-nut-specific-diagnostics"><i class="fa fa-check"></i><b>8.5</b> HMC-NUT Specific Diagnostics</a><ul>
<li class="chapter" data-level="8.5.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#divergent-transitions"><i class="fa fa-check"></i><b>8.5.1</b> Divergent transitions</a></li>
<li class="chapter" data-level="8.5.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#maximum-tree-depth"><i class="fa fa-check"></i><b>8.5.2</b> Maximum Tree-depth</a></li>
<li class="chapter" data-level="8.5.3" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#bayesian-fraction-of-missing-information"><i class="fa fa-check"></i><b>8.5.3</b> Bayesian Fraction of Missing Information</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#debugging-bayesian-computing"><i class="fa fa-check"></i><b>8.6</b> Debugging Bayesian Computing</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="model-checking.html"><a href="model-checking.html"><i class="fa fa-check"></i><b>9</b> Model Checking</a><ul>
<li class="chapter" data-level="9.1" data-path="model-checking.html"><a href="model-checking.html#why-check-models"><i class="fa fa-check"></i><b>9.1</b> Why check models?</a></li>
<li class="chapter" data-level="9.2" data-path="model-checking.html"><a href="model-checking.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>9.2</b> Posterior Predictive Checks</a><ul>
<li class="chapter" data-level="9.2.1" data-path="model-checking.html"><a href="model-checking.html#bayesian-p-values"><i class="fa fa-check"></i><b>9.2.1</b> Bayesian p-values</a></li>
<li class="chapter" data-level="9.2.2" data-path="model-checking.html"><a href="model-checking.html#test-quantities"><i class="fa fa-check"></i><b>9.2.2</b> Test quantities</a></li>
<li class="chapter" data-level="9.2.3" data-path="model-checking.html"><a href="model-checking.html#p-values-vs.u-values"><i class="fa fa-check"></i><b>9.2.3</b> p-values vs. u-values</a></li>
<li class="chapter" data-level="9.2.4" data-path="model-checking.html"><a href="model-checking.html#marginal-predictive-checks"><i class="fa fa-check"></i><b>9.2.4</b> Marginal predictive checks</a></li>
<li class="chapter" data-level="9.2.5" data-path="model-checking.html"><a href="model-checking.html#outliers"><i class="fa fa-check"></i><b>9.2.5</b> Outliers</a></li>
<li class="chapter" data-level="9.2.6" data-path="model-checking.html"><a href="model-checking.html#graphical-posterior-predictive-checks"><i class="fa fa-check"></i><b>9.2.6</b> Graphical Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="model-checking.html"><a href="model-checking.html#references-4"><i class="fa fa-check"></i><b>9.3</b> References</a></li>
</ul></li>
<li class="part"><span><b>III Models</b></span></li>
<li class="chapter" data-level="10" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html"><i class="fa fa-check"></i><b>10</b> Introduction to Stan and Linear Regression</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#prerequisites-4"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="10.1" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#ols-and-mle-linear-regression"><i class="fa fa-check"></i><b>10.1</b> OLS and MLE Linear Regression</a><ul>
<li class="chapter" data-level="10.1.1" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#bayesian-model-with-improper-priors"><i class="fa fa-check"></i><b>10.1.1</b> Bayesian Model with Improper priors</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#stan-model"><i class="fa fa-check"></i><b>10.2</b> Stan Model</a></li>
<li class="chapter" data-level="10.3" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#sampling-model-with-stan"><i class="fa fa-check"></i><b>10.3</b> Sampling Model with Stan</a><ul>
<li class="chapter" data-level="10.3.1" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#sampling"><i class="fa fa-check"></i><b>10.3.1</b> Sampling</a></li>
<li class="chapter" data-level="10.3.2" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#convergence-diagnostics-and-model-fit"><i class="fa fa-check"></i><b>10.3.2</b> Convergence Diagnostics and Model Fit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>11</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="11.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#count-models"><i class="fa fa-check"></i><b>11.1</b> Count Models</a><ul>
<li class="chapter" data-level="11.1.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#poisson"><i class="fa fa-check"></i><b>11.1.1</b> Poisson</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#example-3"><i class="fa fa-check"></i><b>11.2</b> Example</a></li>
<li class="chapter" data-level="11.3" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#negative-binomial"><i class="fa fa-check"></i><b>11.3</b> Negative Binomial</a></li>
<li class="chapter" data-level="11.4" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#multinomial-categorical-models"><i class="fa fa-check"></i><b>11.4</b> Multinomial / Categorical Models</a></li>
<li class="chapter" data-level="11.5" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#gamma-regression"><i class="fa fa-check"></i><b>11.5</b> Gamma Regression</a></li>
<li class="chapter" data-level="11.6" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#beta-regression"><i class="fa fa-check"></i><b>11.6</b> Beta Regression</a></li>
<li class="chapter" data-level="11.7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#references-5"><i class="fa fa-check"></i><b>11.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="binomial-models.html"><a href="binomial-models.html"><i class="fa fa-check"></i><b>12</b> Binomial Models</a><ul>
<li class="chapter" data-level="" data-path="binomial-models.html"><a href="binomial-models.html#prerequisites-5"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="12.1" data-path="binomial-models.html"><a href="binomial-models.html#introduction-1"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="binomial-models.html"><a href="binomial-models.html#link-functions-link-function"><i class="fa fa-check"></i><b>12.2</b> Link Functions {link-function}</a><ul>
<li class="chapter" data-level="12.2.1" data-path="binomial-models.html"><a href="binomial-models.html#stan"><i class="fa fa-check"></i><b>12.2.1</b> Stan</a></li>
<li class="chapter" data-level="12.2.2" data-path="binomial-models.html"><a href="binomial-models.html#example-vote-turnout"><i class="fa fa-check"></i><b>12.2.2</b> Example: Vote Turnout</a></li>
<li class="chapter" data-level="12.2.3" data-path="binomial-models.html"><a href="binomial-models.html#stan-1"><i class="fa fa-check"></i><b>12.2.3</b> Stan</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="binomial-models.html"><a href="binomial-models.html#references-6"><i class="fa fa-check"></i><b>12.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="separtion.html"><a href="separtion.html"><i class="fa fa-check"></i><b>13</b> Separation</a><ul>
<li class="chapter" data-level="" data-path="separtion.html"><a href="separtion.html#prerequisites-6"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="13.1" data-path="separtion.html"><a href="separtion.html#introduction-2"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="separtion.html"><a href="separtion.html#complete-separation"><i class="fa fa-check"></i><b>13.2</b> Complete Separation</a></li>
<li class="chapter" data-level="13.3" data-path="separtion.html"><a href="separtion.html#quasi-separation"><i class="fa fa-check"></i><b>13.3</b> Quasi-Separation</a></li>
<li class="chapter" data-level="13.4" data-path="separtion.html"><a href="separtion.html#weak-priors"><i class="fa fa-check"></i><b>13.4</b> Weak Priors</a></li>
<li class="chapter" data-level="13.5" data-path="separtion.html"><a href="separtion.html#example-support-of-aca-medicaid-expansion"><i class="fa fa-check"></i><b>13.5</b> Example: Support of ACA Medicaid Expansion</a></li>
<li class="chapter" data-level="13.6" data-path="separtion.html"><a href="separtion.html#questions-2"><i class="fa fa-check"></i><b>13.6</b> Questions</a></li>
<li class="chapter" data-level="13.7" data-path="separtion.html"><a href="separtion.html#references-7"><i class="fa fa-check"></i><b>13.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="robust-regression.html"><a href="robust-regression.html"><i class="fa fa-check"></i><b>14</b> Robust Regression</a><ul>
<li class="chapter" data-level="" data-path="robust-regression.html"><a href="robust-regression.html#prerequisites-7"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="14.1" data-path="robust-regression.html"><a href="robust-regression.html#wide-tailed-distributions"><i class="fa fa-check"></i><b>14.1</b> Wide Tailed Distributions</a></li>
<li class="chapter" data-level="14.2" data-path="robust-regression.html"><a href="robust-regression.html#student-t-distribution"><i class="fa fa-check"></i><b>14.2</b> Student-t distribution</a><ul>
<li class="chapter" data-level="14.2.1" data-path="robust-regression.html"><a href="robust-regression.html#examples-2"><i class="fa fa-check"></i><b>14.2.1</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="robust-regression.html"><a href="robust-regression.html#robit"><i class="fa fa-check"></i><b>14.3</b> Robit</a></li>
<li class="chapter" data-level="14.4" data-path="robust-regression.html"><a href="robust-regression.html#quantile-regression"><i class="fa fa-check"></i><b>14.4</b> Quantile regression</a><ul>
<li class="chapter" data-level="14.4.1" data-path="robust-regression.html"><a href="robust-regression.html#questions-3"><i class="fa fa-check"></i><b>14.4.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="robust-regression.html"><a href="robust-regression.html#references-8"><i class="fa fa-check"></i><b>14.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html"><i class="fa fa-check"></i><b>15</b> Heteroskedasticity</a><ul>
<li class="chapter" data-level="" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#prerequisites-8"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="15.1" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#introduction-3"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#weighted-regression"><i class="fa fa-check"></i><b>15.2</b> Weighted Regression</a></li>
<li class="chapter" data-level="15.3" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#modeling-the-scale-with-covariates"><i class="fa fa-check"></i><b>15.3</b> Modeling the Scale with Covariates</a></li>
<li class="chapter" data-level="15.4" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#prior-distributions"><i class="fa fa-check"></i><b>15.4</b> Prior Distributions</a><ul>
<li class="chapter" data-level="15.4.1" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#examples-duncan"><i class="fa fa-check"></i><b>15.4.1</b> Examples: Duncan</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#exercises"><i class="fa fa-check"></i><b>15.5</b> Exercises</a></li>
<li class="chapter" data-level="15.6" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#references-9"><i class="fa fa-check"></i><b>15.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="rare-events.html"><a href="rare-events.html"><i class="fa fa-check"></i><b>16</b> Rare Events</a><ul>
<li class="chapter" data-level="" data-path="rare-events.html"><a href="rare-events.html#prerequisites-9"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="16.1" data-path="rare-events.html"><a href="rare-events.html#introduction-4"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="rare-events.html"><a href="rare-events.html#finite-sample-bias"><i class="fa fa-check"></i><b>16.2</b> Finite-Sample Bias</a></li>
<li class="chapter" data-level="16.3" data-path="rare-events.html"><a href="rare-events.html#case-control"><i class="fa fa-check"></i><b>16.3</b> Case Control</a></li>
<li class="chapter" data-level="16.4" data-path="rare-events.html"><a href="rare-events.html#questions-4"><i class="fa fa-check"></i><b>16.4</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>17</b> Hierarchical Models</a><ul>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#prerequisites-10"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="17.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-hits"><i class="fa fa-check"></i><b>17.1</b> Example: Baseball Hits</a><ul>
<li class="chapter" data-level="17.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#references-10"><i class="fa fa-check"></i><b>17.1.1</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>18</b> Multilevel Models</a><ul>
<li class="chapter" data-level="18.1" data-path="multilevel-models.html"><a href="multilevel-models.html#example-radon"><i class="fa fa-check"></i><b>18.1</b> Example: Radon</a><ul>
<li class="chapter" data-level="18.1.1" data-path="multilevel-models.html"><a href="multilevel-models.html#data"><i class="fa fa-check"></i><b>18.1.1</b> Data</a></li>
<li class="chapter" data-level="18.1.2" data-path="multilevel-models.html"><a href="multilevel-models.html#varying-intercepts-models"><i class="fa fa-check"></i><b>18.1.2</b> Varying Intercepts Models</a></li>
<li class="chapter" data-level="18.1.3" data-path="multilevel-models.html"><a href="multilevel-models.html#varying-intercept-model"><i class="fa fa-check"></i><b>18.1.3</b> Varying Intercept Model</a></li>
<li class="chapter" data-level="18.1.4" data-path="multilevel-models.html"><a href="multilevel-models.html#varying-slope-model"><i class="fa fa-check"></i><b>18.1.4</b> Varying Slope Model</a></li>
<li class="chapter" data-level="18.1.5" data-path="multilevel-models.html"><a href="multilevel-models.html#group-level-predictors"><i class="fa fa-check"></i><b>18.1.5</b> Group Level Predictors</a></li>
<li class="chapter" data-level="18.1.6" data-path="multilevel-models.html"><a href="multilevel-models.html#lme4"><i class="fa fa-check"></i><b>18.1.6</b> lme4</a></li>
<li class="chapter" data-level="18.1.7" data-path="multilevel-models.html"><a href="multilevel-models.html#rstanarm-1"><i class="fa fa-check"></i><b>18.1.7</b> rstanarm</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="multilevel-models.html"><a href="multilevel-models.html#pooling-of-hierarchical-parameters"><i class="fa fa-check"></i><b>18.2</b> Pooling of Hierarchical Parameters</a></li>
<li class="chapter" data-level="18.3" data-path="multilevel-models.html"><a href="multilevel-models.html#anova"><i class="fa fa-check"></i><b>18.3</b> ANOVA</a></li>
<li class="chapter" data-level="18.4" data-path="multilevel-models.html"><a href="multilevel-models.html#time-series-cross-section"><i class="fa fa-check"></i><b>18.4</b> Time-Series Cross Section</a></li>
<li class="chapter" data-level="18.5" data-path="multilevel-models.html"><a href="multilevel-models.html#miscellaneous"><i class="fa fa-check"></i><b>18.5</b> Miscellaneous</a><ul>
<li class="chapter" data-level="18.5.1" data-path="multilevel-models.html"><a href="multilevel-models.html#how-many-groups"><i class="fa fa-check"></i><b>18.5.1</b> How many groups?</a></li>
<li class="chapter" data-level="18.5.2" data-path="multilevel-models.html"><a href="multilevel-models.html#correlation-between-predictors-and-errors"><i class="fa fa-check"></i><b>18.5.2</b> Correlation between Predictors and Errors</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="multilevel-models.html"><a href="multilevel-models.html#references-11"><i class="fa fa-check"></i><b>18.6</b> References</a></li>
</ul></li>
<li class="part"><span><b>IV Appendix</b></span></li>
<li class="chapter" data-level="19" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>19</b> Distributions</a></li>
<li class="chapter" data-level="20" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html"><i class="fa fa-check"></i><b>20</b> Annotated Bibliography</a><ul>
<li class="chapter" data-level="20.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#textbooks"><i class="fa fa-check"></i><b>20.1</b> Textbooks</a></li>
<li class="chapter" data-level="20.2" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#syllabi"><i class="fa fa-check"></i><b>20.2</b> Syllabi</a></li>
<li class="chapter" data-level="20.3" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#topics"><i class="fa fa-check"></i><b>20.3</b> Topics</a></li>
<li class="chapter" data-level="20.4" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayes-theorem-1"><i class="fa fa-check"></i><b>20.4</b> Bayes’ Theorem</a></li>
<li class="chapter" data-level="20.5" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#article-length-introductions-to-bayesian-statistics"><i class="fa fa-check"></i><b>20.5</b> Article Length Introductions to Bayesian Statistics</a><ul>
<li class="chapter" data-level="20.5.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#why-bayesian"><i class="fa fa-check"></i><b>20.5.1</b> Why Bayesian</a></li>
<li class="chapter" data-level="20.5.2" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#modern-statistical-workflow"><i class="fa fa-check"></i><b>20.5.2</b> Modern Statistical Workflow</a></li>
<li class="chapter" data-level="20.5.3" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-philosophy"><i class="fa fa-check"></i><b>20.5.3</b> Bayesian Philosophy</a></li>
<li class="chapter" data-level="20.5.4" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-hypothesis-testing"><i class="fa fa-check"></i><b>20.5.4</b> Bayesian Hypothesis Testing</a></li>
<li class="chapter" data-level="20.5.5" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-frequentist-debates"><i class="fa fa-check"></i><b>20.5.5</b> Bayesian Frequentist Debates</a></li>
<li class="chapter" data-level="20.5.6" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#categorical"><i class="fa fa-check"></i><b>20.5.6</b> Categorical</a></li>
<li class="chapter" data-level="20.5.7" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#variable-selection"><i class="fa fa-check"></i><b>20.5.7</b> Variable Selection</a></li>
<li class="chapter" data-level="20.5.8" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#multiple-testing"><i class="fa fa-check"></i><b>20.5.8</b> Multiple Testing</a></li>
<li class="chapter" data-level="20.5.9" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#rare-events-1"><i class="fa fa-check"></i><b>20.5.9</b> Rare Events</a></li>
<li class="chapter" data-level="20.5.10" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#identifiability"><i class="fa fa-check"></i><b>20.5.10</b> Identifiability</a></li>
<li class="chapter" data-level="20.5.11" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#shrinkage"><i class="fa fa-check"></i><b>20.5.11</b> Shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#software"><i class="fa fa-check"></i><b>20.6</b> Software</a><ul>
<li class="chapter" data-level="20.6.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#stan-2"><i class="fa fa-check"></i><b>20.6.1</b> Stan</a></li>
<li class="chapter" data-level="20.6.2" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#diagrams"><i class="fa fa-check"></i><b>20.6.2</b> Diagrams</a></li>
<li class="chapter" data-level="20.6.3" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#priors-1"><i class="fa fa-check"></i><b>20.6.3</b> Priors</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-model-averaging"><i class="fa fa-check"></i><b>20.7</b> Bayesian Model Averaging</a></li>
<li class="chapter" data-level="20.8" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#multilevel-modeling"><i class="fa fa-check"></i><b>20.8</b> Multilevel Modeling</a></li>
<li class="chapter" data-level="20.9" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#mixture-models"><i class="fa fa-check"></i><b>20.9</b> Mixture Models</a></li>
<li class="chapter" data-level="20.10" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#inference"><i class="fa fa-check"></i><b>20.10</b> Inference</a><ul>
<li class="chapter" data-level="20.10.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#discussion-of-bayesian-inference"><i class="fa fa-check"></i><b>20.10.1</b> Discussion of Bayesian Inference</a></li>
</ul></li>
<li class="chapter" data-level="20.11" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#model-checking-1"><i class="fa fa-check"></i><b>20.11</b> Model Checking</a><ul>
<li class="chapter" data-level="20.11.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#posterior-predictive-checks-1"><i class="fa fa-check"></i><b>20.11.1</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="20.11.2" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#prediction-criteria"><i class="fa fa-check"></i><b>20.11.2</b> Prediction Criteria</a></li>
<li class="chapter" data-level="20.11.3" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#software-validation"><i class="fa fa-check"></i><b>20.11.3</b> Software Validation</a></li>
</ul></li>
<li class="chapter" data-level="20.12" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#hierarchical-modeling"><i class="fa fa-check"></i><b>20.12</b> Hierarchical Modeling</a></li>
<li class="chapter" data-level="20.13" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#shrinkageregularization"><i class="fa fa-check"></i><b>20.13</b> Shrinkage/Regularization</a></li>
<li class="chapter" data-level="20.14" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#empirical-bayes"><i class="fa fa-check"></i><b>20.14</b> Empirical Bayes</a></li>
<li class="chapter" data-level="20.15" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#history-of-bayesian-statistics"><i class="fa fa-check"></i><b>20.15</b> History of Bayesian Statistics</a></li>
<li class="chapter" data-level="20.16" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#sampling-difficulties"><i class="fa fa-check"></i><b>20.16</b> Sampling Difficulties</a></li>
<li class="chapter" data-level="20.17" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#complicated-estimation-and-testing"><i class="fa fa-check"></i><b>20.17</b> Complicated Estimation and Testing</a></li>
<li class="chapter" data-level="20.18" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#pooling-polls"><i class="fa fa-check"></i><b>20.18</b> Pooling Polls</a></li>
<li class="chapter" data-level="20.19" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#visualizing-mcmc-methods"><i class="fa fa-check"></i><b>20.19</b> Visualizing MCMC Methods</a></li>
<li class="chapter" data-level="20.20" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-point-estimation-decision"><i class="fa fa-check"></i><b>20.20</b> Bayesian point estimation / Decision</a></li>
<li class="chapter" data-level="20.21" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#stan-modeling-language"><i class="fa fa-check"></i><b>20.21</b> Stan Modeling Language</a></li>
<li class="chapter" data-level="20.22" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayes-factors"><i class="fa fa-check"></i><b>20.22</b> Bayes Factors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-12.html"><a href="references-12.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Updating: A Set of Bayesian Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
\[
\DeclareMathOperator{\E}{E}
\DeclareMathOperator{\mean}{mean}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Cor}{Cor}
\DeclareMathOperator{\Bias}{Bias}
\DeclareMathOperator{\MSE}{MSE}
\DeclareMathOperator{\RMSE}{RMSE}
\DeclareMathOperator{\sd}{sd}
\DeclareMathOperator{\se}{se}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\median}{median}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator{\logistic}{Logistic}
\DeclareMathOperator{\logit}{Logit}

\newcommand{\mat}[1]{\boldsymbol{#1}}
\newcommand{\vec}[1]{\boldsymbol{#1}}
\newcommand{\T}{'}

% This follows BDA
\newcommand{\dunif}{\mathrm{U}}
\newcommand{\dnorm}{\mathrm{N}}
\newcommand{\dlnorm}{\mathrm{lognormal}}
\newcommand{\dmvnorm}{\mathrm{N}}
\newcommand{\dgamma}{\mathrm{Gamma}}
\newcommand{\dinvgamma}{\mathrm{Inv-Gamma}}
\newcommand{\dchisq}[1]{\chi^2_{#1}}
\newcommand{\dinvchisq}[1]{\mathrm{Inv-}\chi^2_{#1}}
\newcommand{\dexp}{\mathrm{Expon}}
\newcommand{\dlaplace}{\mathrm{Laplace}}
\newcommand{\dweibull}{\mathrm{Weibull}}
\newcommand{\dwishart}[1]{\mathrm{Wishart}_{#1}}
\newcommand{\dinvwishart}[1]{\mathrm{Inv-Wishart}_{#1}}
\newcommand{\dlkj}{\mathrm{LkjCorr}}
\newcommand{\dt}[1]{t_{#1}}
\newcommand{\dbeta}{\mathrm{Beta}}
\newcommand{\ddirichlet}{\mathrm{Dirichlet}}
\newcommand{\dlogistic}{\mathrm{Logistic}}
\newcommand{\dllogistic}{\mathrm{Log-logistic}}
\newcommand{\dpois}{\mathrm{Poisson}}
\newcommand{\dBinom}{\mathrm{Bin}}
\newcommand{\dBinom}{\mathrm{Bin}}
\newcommand{\dmultinom}{\mathrm{Multinom}}
\newcommand{\dnbinom}{\mathrm{Neg-bin}}
\newcommand{\dnbinomalt}{\mathrm{Neg-bin2}}
\newcommand{\dbetabinom}{\mathrm{Beta-bin}}
\newcommand{\dcauchy}{\mathrm{Cauchy}}
\newcommand{\dhalfcauchy}{\mathrm{Cauchy}^{+}}
\newcommand{\dlkjcorr}{\mathrm{LKJ}^{+}}

\newcommand{\R}{\mathbb{R}}
\newcommand{\Reals}{\R}
\newcommand{\RealPos}{\R^{+}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Nats}{\N}

\newcommand{\cia}{\perp\!\!\!\perp}
\DeclareMathOperator*{\plim}{plim}
\]
<div id="multilevel-models" class="section level1">
<h1><span class="header-section-number">18</span> Multilevel Models</h1>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;rstan&quot;</span>)</a>
<a class="sourceLine" id="cb128-2" data-line-number="2"><span class="kw">library</span>(<span class="st">&quot;rstanarm&quot;</span>)</a>
<a class="sourceLine" id="cb128-3" data-line-number="3"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</a></code></pre></div>
<p>Multilevel models are commonly used hierarchical model.
They extend (generalized) linear models to include coefficients that vary by discrete groups.</p>
<p>Suppose that there are <span class="math inline">\(i = 1, dots, n\)</span> observations, and each observation is in one of <span class="math inline">\(j = 1, \dots, J\)</span> groups.
Let <span class="math inline">\(j[i]\)</span> be the group for
<span class="math display">\[
\begin{aligned}[t]
y_i &amp;\sim \dnorm(\alpha_{j[i]} + \beta_{j[i]} x_i, \sigma^2) \\
  \begin{bmatrix}
  \alpha_j \\
  \beta_j
  \end{bmatrix}
&amp; \sim
\dnorm
\left(
  \begin{bmatrix}
  \mu_\alpha \\
  \mu_\beta
  \end{bmatrix},
\Omega
\right)
\end{aligned} .
\]</span></p>
<p><em>Pooled model</em>: All coefficients are common between groups. This is equivalent to a linear model.
<span class="math display">\[
\begin{aligned}[t]
y_i &amp;\sim \dnorm(\alpha + \beta x_i, \sigma^2) \\
\begin{bmatrix}
\alpha \\
\beta
\end{bmatrix}
&amp;\sim
\dnorm
\left(
  \begin{bmatrix}
  \mu_{\alpha} \\
  \mu_{\beta}
  \end{bmatrix},
  \Omega
\right)
\end{aligned}
\]</span></p>
<p><em>Pooled model</em>: All coefficients are common between groups. This is equivalent to a linear model.
<span class="math display">\[
\begin{aligned}[t]
y_i &amp;\sim \dnorm(\alpha + \beta x_i, \sigma^2) \\
\end{aligned}
\]</span>
<em>Varying-intercept</em>: The slope coefficients (<span class="math inline">\(\beta\)</span>) are common between groups, but the intercepts (<span class="math inline">\(\alpha_j\)</span>) vary by group.
<span class="math display">\[
\begin{aligned}[t]
y_i &amp;\sim \dnorm(\alpha_{j[i]} + \beta x_i, \sigma^2) \\
\end{aligned}
\]</span>
<em>Varying-slope model</em>: The groups share a common intercept, <span class="math inline">\(\alpha\)</span>, but the slope coefficient (<span class="math inline">\(\beta\)</span>), varies between groups. This is less common since it is hard to think of cases when it is appropriate.
<span class="math display">\[
\begin{aligned}[t]
y_i &amp;\sim \dnorm(\alpha + \beta_{j[i]} x_i, \sigma^2) \\
\end{aligned}
\]</span>
These models go by different names in different literatures:
<em>hierarchical (generalized) linear models</em>, <em>nested data models</em>,
<em>mixed models</em>, <em>random coefficients</em>, <em>random-effects</em>,
<em>random parameter models</em>, <em>split-plot designs</em>.<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a></p>
<p>The model can be extended to other cases:</p>
<ul>
<li>generalized linear models</li>
<li>multiple parameters</li>
</ul>
<p>One of the difficulties in these models is the prior to the covariance matrix, <span class="math inline">\(\Omega\)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-3"></span>
<img src="multilevel_files/figure-html/unnamed-chunk-3-1.png" alt="Visual representation of hierarchical models" width="70%" />
<p class="caption">
Figure 18.1: Visual representation of hierarchical models
</p>
</div>
<div id="example-radon" class="section level2">
<h2><span class="header-section-number">18.1</span> Example: Radon</h2>
<p>This example models the presence of radon in houses in Minnesota which appears in <span class="citation">A. Gelman and Hill (2007)</span> and <span class="citation">Gelman et al. (2013)</span>.
This is partly derived from a <a href="http://mc-stan.org/documentation/case-studies/radon.html">Stan Case Study</a>, which uses <code>PyStan</code> instead of <strong>rstan</strong>.</p>
<div id="data" class="section level3">
<h3><span class="header-section-number">18.1.1</span> Data</h3>
<p>The <a href="https://www.rdocumentation.org/packages/radon/topics/rstanarm">radon</a> data is included in the <strong><a href="https://cran.r-project.org/package=rstanarm">rstanarm</a></strong> package.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;radon&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;rstanarm&quot;</span>)</a>
<a class="sourceLine" id="cb129-2" data-line-number="2"><span class="kw">glimpse</span>(radon)</a>
<a class="sourceLine" id="cb129-3" data-line-number="3"><span class="co">#&gt; Observations: 919</span></a>
<a class="sourceLine" id="cb129-4" data-line-number="4"><span class="co">#&gt; Variables: 4</span></a>
<a class="sourceLine" id="cb129-5" data-line-number="5"><span class="co">#&gt; $ floor       &lt;int&gt; 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...</span></a>
<a class="sourceLine" id="cb129-6" data-line-number="6"><span class="co">#&gt; $ county      &lt;fct&gt; AITKIN, AITKIN, AITKIN, AITKIN, ANOKA, ANOKA, ANOK...</span></a>
<a class="sourceLine" id="cb129-7" data-line-number="7"><span class="co">#&gt; $ log_radon   &lt;dbl&gt; 0.8329, 0.8329, 1.0986, 0.0953, 1.1632, 0.9555, 0....</span></a>
<a class="sourceLine" id="cb129-8" data-line-number="8"><span class="co">#&gt; $ log_uranium &lt;dbl&gt; -0.689, -0.689, -0.689, -0.689, -0.847, -0.847, -0...</span></a></code></pre></div>
<p>The data consist of 919 observations of radon levels of houses from 85 counties.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" data-line-number="1">radon_county &lt;-<span class="st"> </span>radon <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb130-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(county) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb130-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">log_radon_mean =</span> <span class="kw">mean</span>(log_radon),</a>
<a class="sourceLine" id="cb130-4" data-line-number="4">            <span class="dt">log_radon_sd =</span> <span class="kw">sd</span>(log_radon),</a>
<a class="sourceLine" id="cb130-5" data-line-number="5">            <span class="dt">log_uranium =</span> <span class="kw">mean</span>(log_uranium),</a>
<a class="sourceLine" id="cb130-6" data-line-number="6">            <span class="dt">n =</span> <span class="kw">length</span>(county))</a></code></pre></div>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" data-line-number="1"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb131-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> radon,</a>
<a class="sourceLine" id="cb131-3" data-line-number="3">             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> log_radon,</a>
<a class="sourceLine" id="cb131-4" data-line-number="4">                           <span class="dt">x =</span> <span class="kw">fct_reorder</span>(county, log_radon, mean))) <span class="op">+</span></a>
<a class="sourceLine" id="cb131-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> radon_county,</a>
<a class="sourceLine" id="cb131-6" data-line-number="6">             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">fct_reorder</span>(county, log_radon_mean),</a>
<a class="sourceLine" id="cb131-7" data-line-number="7">                           <span class="dt">y =</span> log_radon_mean),</a>
<a class="sourceLine" id="cb131-8" data-line-number="8">             <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb131-9" data-line-number="9"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb131-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;log(radon)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="multilevel_files/figure-html/unnamed-chunk-5-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Relationship between mean and sample size</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" data-line-number="1"><span class="kw">ggplot</span>(radon_county, <span class="kw">aes</span>(<span class="dt">y =</span> log_radon_mean, <span class="dt">x =</span> <span class="kw">log2</span>(n))) <span class="op">+</span></a>
<a class="sourceLine" id="cb132-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="multilevel_files/figure-html/unnamed-chunk-6-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="varying-intercepts-models" class="section level3">
<h3><span class="header-section-number">18.1.2</span> Varying Intercepts Models</h3>
<p>Consider the general model with an intercept for each county representing the baseline average of the county:
<span class="math display">\[
\begin{aligned}
y_i &amp;\sim  N(\mu_i, \sigma^2) \\
\mu_i &amp;= \alpha_{j[i]} + \beta x_i
\end{aligned}
\]</span>
where <span class="math inline">\(j[i]\)</span> means that observation <span class="math inline">\(i\)</span> is in county <span class="math inline">\(j \in (1, \dots, 85)\)</span>.</p>
<p>In this particular example, <span class="math inline">\(y = \mathtt{log_radon}\)</span> and <span class="math inline">\(x = \mathtt{basement}\)</span>.
<span class="math display">\[
\begin{aligned}
\mathtt{log\_radon}_i &amp;\sim  N(\mu_i, \sigma^2) \\
\mu_i &amp;= \alpha_{j[i]} + \beta~\mathtt{basement}_i
\end{aligned}
\]</span></p>
<p>We can put a prior distribution on <span class="math inline">\(\alpha_{j[i]}\)</span>,
<span class="math display">\[
\begin{aligned}[t]
\alpha_{j} &amp;\sim N(\gamma, \tau) &amp; \text{for $i \in (1, \dots, 85)}
\end{aligned}
\]</span>
This parameterization nests common cases,</p>
<p><em>Complete pooling:</em> When <span class="math inline">\(\tau \to 0\)</span>, the intercepts are the same,
<span class="math display">\[
\begin{aligned}[t]
\alpha_j &amp;= \gamma  &amp; \text{for all $j$.}
\end{aligned}
\]</span></p>
<p><em>No pooling:</em> When <span class="math inline">\(\tau \to \infty\)</span>, prior distribution on the intercepts is equivalent to an improper normal distribution, and there is no shrinkage,
<span class="math display">\[
p(\alpha_j) \propto 1,
\]</span>
for all <span class="math inline">\(j\)</span>.</p>
<p><em>Partial pooling:</em> When <span class="math inline">\(\tau\)</span> is a parameter, the amount of shrinkage can be estimated from the data.</p>
</div>
<div id="varying-intercept-model" class="section level3">
<h3><span class="header-section-number">18.1.3</span> Varying Intercept Model</h3>
</div>
<div id="varying-slope-model" class="section level3">
<h3><span class="header-section-number">18.1.4</span> Varying Slope Model</h3>
<p><span class="math display">\[
\begin{aligned}
\mathtt{log\_radon}_i &amp;\sim  N(\mu_i, \sigma^2) \\
\mu_i &amp;= \alpha_{j[i]} + \beta_{j[i]}~\mathtt{basement}_i
\end{aligned}
\]</span></p>
</div>
<div id="group-level-predictors" class="section level3">
<h3><span class="header-section-number">18.1.5</span> Group Level Predictors</h3>
<p>The <code>radon</code> dataset also contains the county-level measurements of <code>uranium</code>.</p>
<p>One way to include county level measurements is to model the county-level intercepts.
The values of each county intercept is a function of the county-level uranium.
<span class="math display">\[
\begin{aligned}
\mathtt{log\_radon}_i &amp;\sim  N(\mu_i, \sigma^2) \\
\mu_i &amp;= \alpha_{j[i]} + \beta_{j[i]}~\mathtt{basement}_i
\alpha_{j} \sim  N(\gamma_0 + \gamma_1~\mathtt{log\_uranium}_j, \tau)
\end{aligned}
\]</span></p>
<p>Alternatively, we can model model the county-level intercepts.
The values of each county intercept is a function of the county-level uranium.
<span class="math display">\[
\begin{aligned}
\mathtt{log\_radon}_i &amp;\sim  N(\mu_i, \sigma^2) \\
\mu_i &amp;= \alpha_{j[i]} + \beta_{j[i]}~\mathtt{basement}_i \\
\alpha_{j} &amp;\sim  N(\gamma_0 + \gamma_1~\mathtt{log\_uranium}_j, \tau)
\end{aligned}
\]</span></p>
</div>
<div id="lme4" class="section level3">
<h3><span class="header-section-number">18.1.6</span> lme4</h3>
<p>In R, the most widely used package to estimate mixed-effects models is <strong>lme4</strong>.
This estimates models using maximum likelihood or restricted maximum likelihood methods (REML).
This will be faster than using full-Bayesian methods but also underestimate the uncertainty, as well as being a worse approximation of the posterior.
Additionally, in frequentist inference, the meaning of the random effects is different; they are nuisance parameters and not given standard errors.</p>
<p>See <span class="citation">Bates (2010)</span> and <span class="citation">Bates et al. (2014)</span> for introductions to mixed-effects models with <strong>lme4</strong>.
These are also good introductions to classical approaches to mixed effects models.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;lme4&quot;</span>)</a></code></pre></div>
<p>Complete pooling</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" data-line-number="1">fit_pooled &lt;-<span class="st"> </span><span class="kw">lm</span>(log_radon <span class="op">~</span><span class="st"> </span>county <span class="op">+</span><span class="st"> </span>floor, <span class="dt">data =</span> radon)</a></code></pre></div>
<p>County-varying intercepts with no-pooling</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" data-line-number="1">fit_intercept_nopool &lt;-<span class="st"> </span><span class="kw">lm</span>(log_radon <span class="op">~</span><span class="st"> </span>floor, <span class="dt">data =</span> radon)</a></code></pre></div>
<p>County-varying intercepts with partial-pooling</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" data-line-number="1">fit_intercept_partial &lt;-<span class="st"> </span><span class="kw">lmer</span>(log_radon <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>county) <span class="op">+</span><span class="st"> </span>floor, <span class="dt">data =</span> radon)</a></code></pre></div>
<p>Varying slopes with no pooling:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" data-line-number="1">fit_slope_nopool &lt;-<span class="st"> </span><span class="kw">lm</span>(log_radon <span class="op">~</span><span class="st"> </span>county <span class="op">*</span><span class="st"> </span>floor, <span class="dt">data =</span> radon)</a></code></pre></div>
<p>Varying slopes with partial pooling:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1">fit_slope_partial &lt;-<span class="st"> </span><span class="kw">lmer</span>(log_radon <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>floor <span class="op">|</span><span class="st"> </span>county), <span class="dt">data =</span> radon)</a></code></pre></div>
<p>Including a county-level variable (<code>log_uranium</code>) in various models:</p>
<p>With no-pooling,</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" data-line-number="1">fit_slope_partial &lt;-<span class="st"> </span><span class="kw">lm</span>(log_radon <span class="op">~</span><span class="st"> </span>floor <span class="op">+</span><span class="st"> </span>log_uranium, <span class="dt">data =</span> radon)</a></code></pre></div>
<p>With varying-intercepts</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1">fit_slope_partial &lt;-<span class="st"> </span><span class="kw">lmer</span>(log_radon <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>county) <span class="op">+</span><span class="st"> </span>floor <span class="op">+</span><span class="st"> </span>log_uranium,</a>
<a class="sourceLine" id="cb140-2" data-line-number="2">                          <span class="dt">data =</span> radon)</a></code></pre></div>
<p>With varying-intercepts and slopes,</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" data-line-number="1">fit_slope_partial &lt;-<span class="st"> </span><span class="kw">lmer</span>(log_radon <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>floor <span class="op">|</span><span class="st"> </span>county) <span class="op">+</span><span class="st">  </span>log_uranium,</a>
<a class="sourceLine" id="cb141-2" data-line-number="2">                          <span class="dt">data =</span> radon)</a></code></pre></div>
</div>
<div id="rstanarm-1" class="section level3">
<h3><span class="header-section-number">18.1.7</span> rstanarm</h3>
<p>Some multilevel models can also be estimated using the <strong>rstanarm</strong> functions <code>stan_glmer</code> and <code>stan_lmer</code>.
These functions have syntax similar to <strong>lme4</strong> functions, but estimate the mixed models using Bayesian methods with Stan.</p>
<p>Complete pooling</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1">fit_pooled &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(log_radon <span class="op">~</span><span class="st"> </span>county <span class="op">+</span><span class="st"> </span>floor, <span class="dt">data =</span> radon)</a></code></pre></div>
<p>County-varying intercepts with no-pooling</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" data-line-number="1">fit_intercept_nopool &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(log_radon <span class="op">~</span><span class="st"> </span>floor, <span class="dt">data =</span> radon)</a></code></pre></div>
<p>County-varying intercepts with partial-pooling</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" data-line-number="1">fit_intercept_partial &lt;-<span class="st"> </span><span class="kw">stan_glmer</span>(log_radon <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>county) <span class="op">+</span><span class="st"> </span>floor,</a>
<a class="sourceLine" id="cb144-2" data-line-number="2">                                    <span class="dt">data =</span> radon)</a></code></pre></div>
<p>Varying slopes with no pooling. <em>There is an error estimating this</em></p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" data-line-number="1">fit_slope_nopool &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(log_radon <span class="op">~</span><span class="st"> </span><span class="dv">-1</span> <span class="op">+</span><span class="st"> </span>county <span class="op">+</span><span class="st"> </span>county<span class="op">:</span>floor,</a>
<a class="sourceLine" id="cb145-2" data-line-number="2">                             <span class="dt">data =</span> radon,</a>
<a class="sourceLine" id="cb145-3" data-line-number="3">                             <span class="dt">prior =</span> <span class="kw">normal</span>(<span class="dt">scale =</span> <span class="dv">1</span>))</a></code></pre></div>
<p>Varying slopes with partial pooling:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1">fit_slope_partial &lt;-<span class="st"> </span><span class="kw">stan_glmer</span>(log_radon <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>floor <span class="op">|</span><span class="st"> </span>county), <span class="dt">data =</span> radon)</a></code></pre></div>
<p>Including a county-level variable (<code>log_uranium</code>) in various models:</p>
<p>With no-pooling,</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" data-line-number="1">fit_slope_partial &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(log_radon <span class="op">~</span><span class="st"> </span>floor <span class="op">+</span><span class="st"> </span>log_uranium, <span class="dt">data =</span> radon)</a></code></pre></div>
<p>With varying-intercepts</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1">fit_slope_partial &lt;-</a>
<a class="sourceLine" id="cb148-2" data-line-number="2"><span class="st">  </span><span class="kw">stan_glmer</span>(log_radon <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>county) <span class="op">+</span><span class="st"> </span>floor <span class="op">+</span><span class="st"> </span>log_uranium,</a>
<a class="sourceLine" id="cb148-3" data-line-number="3">             <span class="dt">data =</span> radon)</a></code></pre></div>
<p>With varying-intercepts and slopes,</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" data-line-number="1">fit_slope_partial &lt;-</a>
<a class="sourceLine" id="cb149-2" data-line-number="2"><span class="st">  </span><span class="kw">stan_glmer</span>(log_radon <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>floor <span class="op">|</span><span class="st"> </span>county) <span class="op">+</span><span class="st">  </span>log_uranium,</a>
<a class="sourceLine" id="cb149-3" data-line-number="3">             <span class="dt">data =</span> radon)</a></code></pre></div>
</div>
</div>
<div id="pooling-of-hierarchical-parameters" class="section level2">
<h2><span class="header-section-number">18.2</span> Pooling of Hierarchical Parameters</h2>
<p>This is easiest understood in the case of a model of group means,
<span class="math display">\[
\begin{aligned}[t]
y &amp;\sim \dnorm(\mu_{j[i]}, \sigma^2) \\
\mu_{j} &amp;\sim \dnorm(\gamma, \tau^2) .
\end{aligned}
\]</span>
Each group has size <span class="math inline">\(n_j\)</span>.</p>
<table>
<colgroup>
<col width="32%" />
<col width="67%" />
</colgroup>
<thead>
<tr class="header">
<th>Sample size, <span class="math inline">\(n_j\)</span></th>
<th>Estimate of <span class="math inline">\(\hat{\mu}_j\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(n_j = 0\)</span></td>
<td><span class="math inline">\(\hat{\mu}_j = \gamma\)</span> (complete pooling)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(n_j &lt; \frac{\sigma^2}{\tau^2}\)</span></td>
<td><span class="math inline">\(\hat{\mu}_j\)</span> closer to <span class="math inline">\(\gamma\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(n_j = \frac{\sigma^2}{\tau^2}\)</span></td>
<td><span class="math inline">\(\hat{\mu}_j = \frac{1}{2} \bar{y}_j + \frac{1}{2} \gamma\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(n_j &gt; \frac{\sigma^2}{\tau^2}\)</span></td>
<td><span class="math inline">\(\hat{\mu}_j\)</span> closer to <span class="math inline">\(\bar{y}_j\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(n_j = \infty\)</span></td>
<td><span class="math inline">\(\hat{\mu}_j = \bar{y}_j\)</span> (no pooling)</td>
</tr>
</tbody>
</table>
<p>If the hyperparameters were known, the posterior of <span class="math inline">\(\mu_j\)</span> is
<span class="math display">\[
\mu_j | y, \gamma, \sigma, \tau \sim \dnorm(\hat{\mu}_j, V_j)
\]</span>
where
<span class="math display">\[
\begin{aligned}[t]
\hat{\mu}_j &amp;= \frac{\frac{n_j}{\sigma^2} \bar{y}_j + \frac{1}{\tau^2} \gamma}{\frac{n_j}{\sigma^2} + \frac{1}{\tau^2}} \\
V_j &amp;= \frac{1}{\frac{n_j}{\sigma^2} + \frac{1}{\tau^2}}
\end{aligned}
\]</span></p>
<p>Some crude estimates given <span class="math inline">\(\mu_j\)</span>.</p>
<p>The <em>data variance</em>, <span class="math inline">\(\sigma^2\)</span>, is the residual variance,
<span class="math display">\[
\E(\sigma^2 | y, \mu)  = \frac{1}{n} \sum_{i = 1}^n (y - \mu_{j[i]})^2 .
\]</span>
The global mean is approximately the average of the group-level means,
<span class="math display">\[
\begin{aligned}[t]
\E(\gamma | y, \mu) &amp;= \frac{1}{J} \sum_{i = 1}^n \mu_j \\
\Var(\gamma | y, \mu) &amp;= \frac{1}{J} \tau^2
\end{aligned}
\]</span>
The group level variance is <span class="math inline">\(\tau^2\)</span> is,
<span class="math display">\[
\E(\tau^ | y, \mu) = \frac{1}{J} \sum_{j = 1}^J (\mu_j - \gamma)^2
\]</span></p>
</div>
<div id="anova" class="section level2">
<h2><span class="header-section-number">18.3</span> ANOVA</h2>
<p><strong>TODO</strong></p>
</div>
<div id="time-series-cross-section" class="section level2">
<h2><span class="header-section-number">18.4</span> Time-Series Cross Section</h2>
<p><strong>TODO</strong></p>
<p>A common application for these models are Time-Series Cross-Section (TSCS) or panel models.
In this case, both the time and units can be modeled.</p>
<p>## Extensions</p>
<ul>
<li><p>Including group-level covariates</p></li>
<li><p>Prior distributions</p></li>
<li><p>Prediction</p>
<ul>
<li>new obs in existing groups</li>
<li>new group</li>
<li>new obs in new group</li>
</ul></li>
<li><p>Modeling correlation between intercept and slopes</p></li>
<li><p>Non-nested models</p></li>
</ul>
</div>
<div id="miscellaneous" class="section level2">
<h2><span class="header-section-number">18.5</span> Miscellaneous</h2>
<div id="how-many-groups" class="section level3">
<h3><span class="header-section-number">18.5.1</span> How many groups?</h3>
<p>In classical discussions of multi-level or hierarchical models,
a common question is how many groups are required to be able to use random effects vs. fixed effects.</p>
<p>As noted earlier, random effects estimates the variance between group means. If there are few groups, there is not much information available to estimate this variance.
As such, random effects is not much different than fixed effects.</p>
<p>This literature provides many different rules of thumb for the number of groups necessary to be able to use random effects: 8, 10, 30, 50, or 100 <span class="citation">(Stegmueller 2013, 749)</span>.</p>
<p><span class="citation">Stegmueller (2013)</span> finds that Bayesian method produces better multi-level-models than maximum likelihood methods for all numbers of groups.
ML methods do not suffer severe bias above 10-15 groups.
Bayesian point estimates are biased for smaller numbers of groups, but less than the ML.
Additionally, the Bayesian methods have better frequentist coverage than ML methods.</p>
<p><span class="citation">Beck and Katz (2007)</span> show that ML random coefficient models are superior in terms of efficiency to many types of pooled and un-pooled estimators in small samples.</p>
</div>
<div id="correlation-between-predictors-and-errors" class="section level3">
<h3><span class="header-section-number">18.5.2</span> Correlation between Predictors and Errors</h3>
<p><span class="citation">Bafumi and Gelman (2006)</span> analyze this case.</p>
<p>The standard suggestion in frequentist literature is to use a Hausman test
where the null hypothesis is that random effects are consistent. However,
<span class="citation">Clark and Linzer (2014)</span> note that in small samples this is likely to fail to reject
random effects; and in large samples, random effects behave like fixed effects
anyways.</p>
</div>
</div>
<div id="references-11" class="section level2">
<h2><span class="header-section-number">18.6</span> References</h2>
<p>Texts and chapters on multi-level analysis:</p>
<ul>
<li><p>Bayesian</p>
<ul>
<li><span class="citation">A. Gelman and Hill (2007 Ch. 11-17)</span>.</li>
<li><span class="citation">Gelman et al. (2013 Ch 5)</span> “Hierarchical Models”</li>
<li><span class="citation">Gelman et al. (2013 Ch 15)</span> “Hierarchical Linear Models”</li>
<li><span class="citation">Jackman (2009 CHh. 7)</span></li>
<li><span class="citation">Draper (2008)</span></li>
</ul></li>
<li><p>Frequentist</p>
<ul>
<li><span class="citation">Goldstein (2011)</span></li>
<li><span class="citation">Snijders and Bosker (2011)</span></li>
<li><span class="citation">Rabe-Hesketh and Skrondal (2012)</span></li>
<li><span class="citation">Jiang (2007)</span></li>
</ul></li>
</ul>
<p>Stan model examples:</p>
<ul>
<li>Stan models for <a href="https://github.com/stan-dev/example-models/wiki/ARM-Models">ARM</a></li>
<li><a href="http://mc-stan.org/documentation/case-studies/radon.html" class="uri">http://mc-stan.org/documentation/case-studies/radon.html</a></li>
<li><a href="https://biologyforfun.wordpress.com/2016/12/08/crossed-and-nested-hierarchical-models-with-stan-and-r/" class="uri">https://biologyforfun.wordpress.com/2016/12/08/crossed-and-nested-hierarchical-models-with-stan-and-r/</a></li>
</ul>
<p>Examples of multilevel models</p>
<ul>
<li><p><span class="citation">Western (1998)</span>: economic growth for OECD countries</p></li>
<li><p><span class="citation">Gelman and King (1993)</span>: US election polling</p></li>
<li><p><span class="citation">Park, Gelman, and Bafumi (2004)</span>: multi-level models of opinion polls combined with post-stratification to extrapolate national opinion surveys to regions.</p></li>
<li><p><span class="citation">Steenbergen and Jones (2002)</span>: mostly an intro/review of MLM, but uses the
cross-country Eurobarometer to model support for the EU</p></li>
<li><p><span class="citation">A. Gelman et al. (2007)</span>: state-level opinion polls</p></li>
<li><p><span class="citation">Raudenbush and Bryk (2001)</span>: student performance with student and school-level indicators</p></li>
<li><p><span class="citation">Gilardi (2010)</span>: policy diffusion</p></li>
<li><p><span class="citation">O’Rourke and Sinnott (2006)</span>: attitudes toward immigration</p></li>
<li><p><span class="citation">Andersen and Fetner (2008)</span>: ethnic and social tolerance</p></li>
<li><p><span class="citation">Weldon (2006)</span>: ethnic and social tolerance</p></li>
<li><p><span class="citation">Arzheimer (2009)</span>: right-wing voting</p></li>
<li><p><span class="citation">Hooghe et al. (2009)</span>: social and political trust</p></li>
<li><p><span class="citation">Anderson and Singer (2008)</span>: satisfaction with democracy</p></li>
<li><p><span class="citation">Meer, Deth, and Scheepers (2009)</span>: political participation</p></li>
<li><p><span class="citation">Iversen and Rosenbluth (2006)</span>: political economy of the gender wage gap</p></li>
<li><p><span class="citation">Hooghe and Marks (2004)</span>: support for European integration</p></li>
<li><p><span class="citation">Lax and Phillips (2009)</span>: American politics using states and neighborhoods</p></li>
<li><p><span class="citation">Voeten (2008)</span>: judicial decision making</p></li>
<li><p><span class="citation">Franchino and Høyland (2009)</span>: legislative politics</p></li>
<li><p><span class="citation">Denisova et al. (2009)</span>: politics of economic reforms</p></li>
<li><p><span class="citation">Aitkin and Longford (1986)</span>, <span class="citation">Goldstein et al. (2000)</span>,
<span class="citation">Goldstein et al. (1993)</span>: education</p></li>
<li><p><span class="citation">Goldstein et al. (2000)</span>: medicine</p></li>
</ul>

</div>
</div>



</div>
<div class="footnotes">
<hr />
<ol start="14">
<li id="fn14"><p><a href="https://en.wikipedia.org/wiki/Multilevel_model" class="uri">https://en.wikipedia.org/wiki/Multilevel_model</a><a href="multilevel-models.html#fnref14" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="hierarchical-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="distributions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jrnold/bayesian_notes/edit/master/multilevel.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
