<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>19 Shrinkage and Regularized Regression | Updating: A Set of Bayesian Notes</title>
  <meta name="description" content="19 Shrinkage and Regularized Regression | Updating: A Set of Bayesian Notes">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="19 Shrinkage and Regularized Regression | Updating: A Set of Bayesian Notes" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://jrnold.github.io/bayesian_notes" />
  
  
  <meta name="github-repo" content="jrnold/bayesian_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="19 Shrinkage and Regularized Regression | Updating: A Set of Bayesian Notes" />
  <meta name="twitter:site" content="@jrnld" />
  
  

<meta name="author" content="Jeffrey B. Arnold">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="shrinkage-and-hierarchical-models.html">
<link rel="next" href="multilevel-models.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/d3-3.3.8/d3.min.js"></script>
<script src="libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/chromatography-0.1/chromatography.js"></script>
<script src="libs/DiagrammeR-binding-1.0.0/DiagrammeR.js"></script>
<script src="libs/viz-0.3/viz.js"></script>
<script src="libs/grViz-binding-1.0.0/grViz.js"></script>



<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Bayesian Notes</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>1</b> Bayesian Inference</a><ul>
<li class="chapter" data-level="1.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html#bayesian-analysis"><i class="fa fa-check"></i><b>1.1</b> Bayesian Analysis</a></li>
<li class="chapter" data-level="1.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html#posterior-predictive-distribution"><i class="fa fa-check"></i><b>1.2</b> Posterior Predictive Distribution</a></li>
</ul></li>
<li class="part"><span><b>I Theory</b></span></li>
<li class="chapter" data-level="2" data-path="bayes-theorem.html"><a href="bayes-theorem.html"><i class="fa fa-check"></i><b>2</b> Bayes Theorem</a><ul>
<li class="chapter" data-level="" data-path="bayes-theorem.html"><a href="bayes-theorem.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="2.1" data-path="bayes-theorem.html"><a href="bayes-theorem.html#introduction-to-bayes-theorem"><i class="fa fa-check"></i><b>2.1</b> Introduction to Bayes’ Theorem</a></li>
<li class="chapter" data-level="2.2" data-path="bayes-theorem.html"><a href="bayes-theorem.html#examples"><i class="fa fa-check"></i><b>2.2</b> Examples</a><ul>
<li class="chapter" data-level="2.2.1" data-path="bayes-theorem.html"><a href="bayes-theorem.html#taxi-cab-problem"><i class="fa fa-check"></i><b>2.2.1</b> Taxi-Cab Problem</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="bayes-theorem.html"><a href="bayes-theorem.html#why-most-research-findings-are-false"><i class="fa fa-check"></i><b>2.3</b> Why most research findings are false</a><ul>
<li class="chapter" data-level="2.3.1" data-path="bayes-theorem.html"><a href="bayes-theorem.html#questions"><i class="fa fa-check"></i><b>2.3.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="bayes-theorem.html"><a href="bayes-theorem.html#measurement-error-and-rare-events-in-surveys"><i class="fa fa-check"></i><b>2.4</b> Measurement Error and Rare Events in Surveys</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html"><i class="fa fa-check"></i><b>3</b> Example: Predicting Names from Ages</a><ul>
<li class="chapter" data-level="" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="3.1" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#statement-of-the-problem"><i class="fa fa-check"></i><b>3.1</b> Statement of the problem</a></li>
<li class="chapter" data-level="3.2" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#data-wrangling"><i class="fa fa-check"></i><b>3.2</b> Data Wrangling</a></li>
<li class="chapter" data-level="3.3" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#probability-of-age-given-name-and-sex"><i class="fa fa-check"></i><b>3.3</b> Probability of age given name and sex</a><ul>
<li class="chapter" data-level="3.3.1" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#questions-1"><i class="fa fa-check"></i><b>3.3.1</b> Questions</a></li>
<li class="chapter" data-level="3.3.2" data-path="example-predicting-names-from-ages.html"><a href="example-predicting-names-from-ages.html#references"><i class="fa fa-check"></i><b>3.3.2</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i><b>4</b> Naive Bayes</a><ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#prerequisites-2"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="4.1" data-path="naive-bayes.html"><a href="naive-bayes.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="naive-bayes.html"><a href="naive-bayes.html#examples-1"><i class="fa fa-check"></i><b>4.2</b> Examples</a><ul>
<li class="chapter" data-level="4.2.1" data-path="naive-bayes.html"><a href="naive-bayes.html#federalist-papers"><i class="fa fa-check"></i><b>4.2.1</b> Federalist Papers</a></li>
<li class="chapter" data-level="4.2.2" data-path="naive-bayes.html"><a href="naive-bayes.html#extensions"><i class="fa fa-check"></i><b>4.2.2</b> Extensions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="naive-bayes.html"><a href="naive-bayes.html#details"><i class="fa fa-check"></i><b>4.3</b> Details</a><ul>
<li class="chapter" data-level="4.3.1" data-path="naive-bayes.html"><a href="naive-bayes.html#generative-vs.-discriminative-models"><i class="fa fa-check"></i><b>4.3.1</b> Generative vs. Discriminative Models</a></li>
<li class="chapter" data-level="4.3.2" data-path="naive-bayes.html"><a href="naive-bayes.html#estimation"><i class="fa fa-check"></i><b>4.3.2</b> Estimation</a></li>
<li class="chapter" data-level="4.3.3" data-path="naive-bayes.html"><a href="naive-bayes.html#prediction"><i class="fa fa-check"></i><b>4.3.3</b> Prediction</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="naive-bayes.html"><a href="naive-bayes.html#references-1"><i class="fa fa-check"></i><b>4.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="priors.html"><a href="priors.html"><i class="fa fa-check"></i><b>5</b> Priors</a><ul>
<li class="chapter" data-level="5.1" data-path="priors.html"><a href="priors.html#levels-of-priors"><i class="fa fa-check"></i><b>5.1</b> Levels of Priors</a></li>
<li class="chapter" data-level="5.2" data-path="priors.html"><a href="priors.html#conjugate-priors"><i class="fa fa-check"></i><b>5.2</b> Conjugate Priors</a><ul>
<li class="chapter" data-level="5.2.1" data-path="priors.html"><a href="priors.html#binomial-beta"><i class="fa fa-check"></i><b>5.2.1</b> Binomial-Beta</a></li>
<li class="chapter" data-level="5.2.2" data-path="priors.html"><a href="priors.html#categorical-dirichlet"><i class="fa fa-check"></i><b>5.2.2</b> Categorical-Dirichlet</a></li>
<li class="chapter" data-level="5.2.3" data-path="priors.html"><a href="priors.html#poisson-gamma"><i class="fa fa-check"></i><b>5.2.3</b> Poisson-Gamma</a></li>
<li class="chapter" data-level="5.2.4" data-path="priors.html"><a href="priors.html#normal-with-known-variance"><i class="fa fa-check"></i><b>5.2.4</b> Normal with known variance</a></li>
<li class="chapter" data-level="5.2.5" data-path="priors.html"><a href="priors.html#exponential-family"><i class="fa fa-check"></i><b>5.2.5</b> Exponential Family</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="priors.html"><a href="priors.html#improper-priors"><i class="fa fa-check"></i><b>5.3</b> Improper Priors</a></li>
<li class="chapter" data-level="5.4" data-path="priors.html"><a href="priors.html#cromwells-rule"><i class="fa fa-check"></i><b>5.4</b> Cromwell’s Rule</a></li>
<li class="chapter" data-level="5.5" data-path="priors.html"><a href="priors.html#asymptotics"><i class="fa fa-check"></i><b>5.5</b> Asymptotics</a></li>
<li class="chapter" data-level="5.6" data-path="priors.html"><a href="priors.html#proper-and-improper-priors"><i class="fa fa-check"></i><b>5.6</b> Proper and Improper Priors</a></li>
<li class="chapter" data-level="5.7" data-path="priors.html"><a href="priors.html#hyperpriors-and-hyperparameters"><i class="fa fa-check"></i><b>5.7</b> Hyperpriors and Hyperparameters</a></li>
<li class="chapter" data-level="5.8" data-path="priors.html"><a href="priors.html#references-2"><i class="fa fa-check"></i><b>5.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="estimation-1.html"><a href="estimation-1.html"><i class="fa fa-check"></i><b>6</b> Estimation</a><ul>
<li class="chapter" data-level="6.1" data-path="estimation-1.html"><a href="estimation-1.html#point-estimates"><i class="fa fa-check"></i><b>6.1</b> Point Estimates</a></li>
<li class="chapter" data-level="6.2" data-path="estimation-1.html"><a href="estimation-1.html#credible-intervals"><i class="fa fa-check"></i><b>6.2</b> Credible Intervals</a><ul>
<li class="chapter" data-level="6.2.1" data-path="estimation-1.html"><a href="estimation-1.html#compared-to-confidence-intervals"><i class="fa fa-check"></i><b>6.2.1</b> Compared to confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="estimation-1.html"><a href="estimation-1.html#bayesian-decision-theory"><i class="fa fa-check"></i><b>6.3</b> Bayesian Decision Theory</a></li>
</ul></li>
<li class="part"><span><b>II Computation</b></span></li>
<li class="chapter" data-level="7" data-path="bayesian-computation.html"><a href="bayesian-computation.html"><i class="fa fa-check"></i><b>7</b> Bayesian Computation</a><ul>
<li class="chapter" data-level="7.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#how-to-calculate-a-posterior"><i class="fa fa-check"></i><b>7.1</b> How to calculate a posterior?</a></li>
<li class="chapter" data-level="7.2" data-path="bayesian-computation.html"><a href="bayesian-computation.html#example-globe-tossing-model"><i class="fa fa-check"></i><b>7.2</b> Example: Globe-tossing model</a></li>
<li class="chapter" data-level="7.3" data-path="bayesian-computation.html"><a href="bayesian-computation.html#quadrature"><i class="fa fa-check"></i><b>7.3</b> Quadrature</a><ul>
<li class="chapter" data-level="7.3.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#grid-approximation"><i class="fa fa-check"></i><b>7.3.1</b> Grid approximation</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="bayesian-computation.html"><a href="bayesian-computation.html#functional-approximations"><i class="fa fa-check"></i><b>7.4</b> Functional Approximations</a><ul>
<li class="chapter" data-level="7.4.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#maximum-a-posteriori"><i class="fa fa-check"></i><b>7.4.1</b> Maximum A Posteriori</a></li>
<li class="chapter" data-level="7.4.2" data-path="bayesian-computation.html"><a href="bayesian-computation.html#laplace-approximation"><i class="fa fa-check"></i><b>7.4.2</b> Laplace Approximation</a></li>
<li class="chapter" data-level="7.4.3" data-path="bayesian-computation.html"><a href="bayesian-computation.html#variational-inference"><i class="fa fa-check"></i><b>7.4.3</b> Variational Inference</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="bayesian-computation.html"><a href="bayesian-computation.html#sampling-methods"><i class="fa fa-check"></i><b>7.5</b> Sampling Methods</a><ul>
<li class="chapter" data-level="7.5.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#numerical-integration"><i class="fa fa-check"></i><b>7.5.1</b> Numerical Integration</a></li>
<li class="chapter" data-level="7.5.2" data-path="bayesian-computation.html"><a href="bayesian-computation.html#inverse-transform-sampling"><i class="fa fa-check"></i><b>7.5.2</b> Inverse transform sampling</a></li>
<li class="chapter" data-level="7.5.3" data-path="bayesian-computation.html"><a href="bayesian-computation.html#direct-approximation"><i class="fa fa-check"></i><b>7.5.3</b> Direct approximation</a></li>
<li class="chapter" data-level="7.5.4" data-path="bayesian-computation.html"><a href="bayesian-computation.html#rejection-sampling"><i class="fa fa-check"></i><b>7.5.4</b> Rejection sampling</a></li>
<li class="chapter" data-level="7.5.5" data-path="bayesian-computation.html"><a href="bayesian-computation.html#importance-sampling"><i class="fa fa-check"></i><b>7.5.5</b> Importance Sampling</a></li>
<li class="chapter" data-level="7.5.6" data-path="bayesian-computation.html"><a href="bayesian-computation.html#mcmc-methods"><i class="fa fa-check"></i><b>7.5.6</b> MCMC Methods</a></li>
<li class="chapter" data-level="7.5.7" data-path="bayesian-computation.html"><a href="bayesian-computation.html#discarding-early-iterations"><i class="fa fa-check"></i><b>7.5.7</b> Discarding early iterations</a></li>
<li class="chapter" data-level="7.5.8" data-path="bayesian-computation.html"><a href="bayesian-computation.html#monte-carlo-sampling"><i class="fa fa-check"></i><b>7.5.8</b> Monte Carlo Sampling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html"><i class="fa fa-check"></i><b>8</b> MCMC Diagnostics</a><ul>
<li class="chapter" data-level="" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="8.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#reparameterize-models"><i class="fa fa-check"></i><b>8.1</b> Reparameterize Models</a></li>
<li class="chapter" data-level="8.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#convergence-diagnostics"><i class="fa fa-check"></i><b>8.2</b> Convergence Diagnostics</a><ul>
<li class="chapter" data-level="8.2.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#potential-scale-reduction-hatr"><i class="fa fa-check"></i><b>8.2.1</b> Potential Scale Reduction (<span class="math inline">\(\hat{R}\)</span>)</a></li>
<li class="chapter" data-level="8.2.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#references-3"><i class="fa fa-check"></i><b>8.2.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#autocorrelation-effective-sample-size-and-mcse"><i class="fa fa-check"></i><b>8.3</b> Autocorrelation, Effective Sample Size, and MCSE</a><ul>
<li class="chapter" data-level="8.3.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#effective-sample-size"><i class="fa fa-check"></i><b>8.3.1</b> Effective Sample Size</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#thinning"><i class="fa fa-check"></i><b>8.4</b> Thinning</a><ul>
<li class="chapter" data-level="8.4.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#traceplots"><i class="fa fa-check"></i><b>8.4.1</b> Traceplots</a></li>
<li class="chapter" data-level="8.4.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#monte-carlo-standard-error-mcse"><i class="fa fa-check"></i><b>8.4.2</b> Monte Carlo Standard Error (MCSE)</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#hmc-nut-specific-diagnostics"><i class="fa fa-check"></i><b>8.5</b> HMC-NUT Specific Diagnostics</a><ul>
<li class="chapter" data-level="8.5.1" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#divergent-transitions"><i class="fa fa-check"></i><b>8.5.1</b> Divergent transitions</a></li>
<li class="chapter" data-level="8.5.2" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#maximum-tree-depth"><i class="fa fa-check"></i><b>8.5.2</b> Maximum Tree-depth</a></li>
<li class="chapter" data-level="8.5.3" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#bayesian-fraction-of-missing-information"><i class="fa fa-check"></i><b>8.5.3</b> Bayesian Fraction of Missing Information</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="mcmc-diagnostics.html"><a href="mcmc-diagnostics.html#debugging-bayesian-computing"><i class="fa fa-check"></i><b>8.6</b> Debugging Bayesian Computing</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="model-checking.html"><a href="model-checking.html"><i class="fa fa-check"></i><b>9</b> Model Checking</a><ul>
<li class="chapter" data-level="9.1" data-path="model-checking.html"><a href="model-checking.html#why-check-models"><i class="fa fa-check"></i><b>9.1</b> Why check models?</a></li>
<li class="chapter" data-level="9.2" data-path="model-checking.html"><a href="model-checking.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>9.2</b> Posterior Predictive Checks</a><ul>
<li class="chapter" data-level="9.2.1" data-path="model-checking.html"><a href="model-checking.html#bayesian-p-values"><i class="fa fa-check"></i><b>9.2.1</b> Bayesian p-values</a></li>
<li class="chapter" data-level="9.2.2" data-path="model-checking.html"><a href="model-checking.html#test-quantities"><i class="fa fa-check"></i><b>9.2.2</b> Test quantities</a></li>
<li class="chapter" data-level="9.2.3" data-path="model-checking.html"><a href="model-checking.html#p-values-vs.-u-values"><i class="fa fa-check"></i><b>9.2.3</b> p-values vs. u-values</a></li>
<li class="chapter" data-level="9.2.4" data-path="model-checking.html"><a href="model-checking.html#marginal-predictive-checks"><i class="fa fa-check"></i><b>9.2.4</b> Marginal predictive checks</a></li>
<li class="chapter" data-level="9.2.5" data-path="model-checking.html"><a href="model-checking.html#outliers"><i class="fa fa-check"></i><b>9.2.5</b> Outliers</a></li>
<li class="chapter" data-level="9.2.6" data-path="model-checking.html"><a href="model-checking.html#graphical-posterior-predictive-checks"><i class="fa fa-check"></i><b>9.2.6</b> Graphical Posterior Predictive Checks</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="model-checking.html"><a href="model-checking.html#references-4"><i class="fa fa-check"></i><b>9.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>10</b> Model Comparison</a><ul>
<li class="chapter" data-level="10.1" data-path="model-comparison.html"><a href="model-comparison.html#models"><i class="fa fa-check"></i><b>10.1</b> Models</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison.html"><a href="model-comparison.html#classes-of-model-spaces"><i class="fa fa-check"></i><b>10.2</b> Classes of Model Spaces</a></li>
<li class="chapter" data-level="10.3" data-path="model-comparison.html"><a href="model-comparison.html#continuous-model-expansion"><i class="fa fa-check"></i><b>10.3</b> Continuous model expansion</a></li>
<li class="chapter" data-level="10.4" data-path="model-comparison.html"><a href="model-comparison.html#discrete-model-expansion"><i class="fa fa-check"></i><b>10.4</b> Discrete Model Expansion</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison.html"><a href="model-comparison.html#out-of-sample-predictive-accuracy"><i class="fa fa-check"></i><b>10.5</b> Out-of-sample predictive accuracy</a></li>
<li class="chapter" data-level="10.6" data-path="model-comparison.html"><a href="model-comparison.html#stacking"><i class="fa fa-check"></i><b>10.6</b> Stacking</a></li>
<li class="chapter" data-level="10.7" data-path="model-comparison.html"><a href="model-comparison.html#posterior-predictive-criteria"><i class="fa fa-check"></i><b>10.7</b> Posterior Predictive Criteria</a><ul>
<li class="chapter" data-level="10.7.1" data-path="model-comparison.html"><a href="model-comparison.html#summary-and-advice"><i class="fa fa-check"></i><b>10.7.1</b> Summary and Advice</a></li>
<li class="chapter" data-level="10.7.2" data-path="model-comparison.html"><a href="model-comparison.html#expected-log-predictive-density"><i class="fa fa-check"></i><b>10.7.2</b> Expected Log Predictive Density</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="model-comparison.html"><a href="model-comparison.html#bayesian-model-averaging"><i class="fa fa-check"></i><b>10.8</b> Bayesian Model Averaging</a></li>
<li class="chapter" data-level="10.9" data-path="model-comparison.html"><a href="model-comparison.html#pseudo-bma"><i class="fa fa-check"></i><b>10.9</b> Pseudo-BMA</a></li>
<li class="chapter" data-level="10.10" data-path="model-comparison.html"><a href="model-comparison.html#loo-cv-via-importance-sampling"><i class="fa fa-check"></i><b>10.10</b> LOO-CV via importance sampling</a></li>
<li class="chapter" data-level="10.11" data-path="model-comparison.html"><a href="model-comparison.html#selection-induced-bias"><i class="fa fa-check"></i><b>10.11</b> Selection induced Bias</a></li>
</ul></li>
<li class="part"><span><b>III Models</b></span></li>
<li class="chapter" data-level="11" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html"><i class="fa fa-check"></i><b>11</b> Introduction to Stan and Linear Regression</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#prerequisites-4"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="11.1" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#ols-and-mle-linear-regression"><i class="fa fa-check"></i><b>11.1</b> OLS and MLE Linear Regression</a><ul>
<li class="chapter" data-level="11.1.1" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#bayesian-model-with-improper-priors"><i class="fa fa-check"></i><b>11.1.1</b> Bayesian Model with Improper priors</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#stan-model"><i class="fa fa-check"></i><b>11.2</b> Stan Model</a></li>
<li class="chapter" data-level="11.3" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#sampling-model-with-stan"><i class="fa fa-check"></i><b>11.3</b> Sampling Model with Stan</a><ul>
<li class="chapter" data-level="11.3.1" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#sampling"><i class="fa fa-check"></i><b>11.3.1</b> Sampling</a></li>
<li class="chapter" data-level="11.3.2" data-path="introduction-to-stan-and-linear-regression.html"><a href="introduction-to-stan-and-linear-regression.html#convergence-diagnostics-and-model-fit"><i class="fa fa-check"></i><b>11.3.2</b> Convergence Diagnostics and Model Fit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>12</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#prerequisites-5"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="12.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#introduction-1"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#count-models"><i class="fa fa-check"></i><b>12.2</b> Count Models</a><ul>
<li class="chapter" data-level="12.2.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#poisson"><i class="fa fa-check"></i><b>12.2.1</b> Poisson</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#example-3"><i class="fa fa-check"></i><b>12.3</b> Example</a></li>
<li class="chapter" data-level="12.4" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#negative-binomial"><i class="fa fa-check"></i><b>12.4</b> Negative Binomial</a></li>
<li class="chapter" data-level="12.5" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#multinomial-categorical-models"><i class="fa fa-check"></i><b>12.5</b> Multinomial / Categorical Models</a></li>
<li class="chapter" data-level="12.6" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#gamma-regression"><i class="fa fa-check"></i><b>12.6</b> Gamma Regression</a></li>
<li class="chapter" data-level="12.7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#beta-regression"><i class="fa fa-check"></i><b>12.7</b> Beta Regression</a></li>
<li class="chapter" data-level="12.8" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#references-5"><i class="fa fa-check"></i><b>12.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="binomial-models.html"><a href="binomial-models.html"><i class="fa fa-check"></i><b>13</b> Binomial Models</a><ul>
<li class="chapter" data-level="" data-path="binomial-models.html"><a href="binomial-models.html#prerequisites-6"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="13.1" data-path="binomial-models.html"><a href="binomial-models.html#introduction-2"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="binomial-models.html"><a href="binomial-models.html#link-functions-link-function"><i class="fa fa-check"></i><b>13.2</b> Link Functions {link-function}</a><ul>
<li class="chapter" data-level="13.2.1" data-path="binomial-models.html"><a href="binomial-models.html#stan"><i class="fa fa-check"></i><b>13.2.1</b> Stan</a></li>
<li class="chapter" data-level="13.2.2" data-path="binomial-models.html"><a href="binomial-models.html#example-vote-turnout"><i class="fa fa-check"></i><b>13.2.2</b> Example: Vote Turnout</a></li>
<li class="chapter" data-level="13.2.3" data-path="binomial-models.html"><a href="binomial-models.html#stan-1"><i class="fa fa-check"></i><b>13.2.3</b> Stan</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="binomial-models.html"><a href="binomial-models.html#references-6"><i class="fa fa-check"></i><b>13.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="separtion.html"><a href="separtion.html"><i class="fa fa-check"></i><b>14</b> Separation</a><ul>
<li class="chapter" data-level="" data-path="separtion.html"><a href="separtion.html#prerequisites-7"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="14.1" data-path="separtion.html"><a href="separtion.html#introduction-3"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="separtion.html"><a href="separtion.html#complete-separation"><i class="fa fa-check"></i><b>14.2</b> Complete Separation</a></li>
<li class="chapter" data-level="14.3" data-path="separtion.html"><a href="separtion.html#quasi-separation"><i class="fa fa-check"></i><b>14.3</b> Quasi-Separation</a></li>
<li class="chapter" data-level="14.4" data-path="separtion.html"><a href="separtion.html#weak-priors"><i class="fa fa-check"></i><b>14.4</b> Weak Priors</a></li>
<li class="chapter" data-level="14.5" data-path="separtion.html"><a href="separtion.html#example-support-of-aca-medicaid-expansion"><i class="fa fa-check"></i><b>14.5</b> Example: Support of ACA Medicaid Expansion</a></li>
<li class="chapter" data-level="14.6" data-path="separtion.html"><a href="separtion.html#questions-2"><i class="fa fa-check"></i><b>14.6</b> Questions</a></li>
<li class="chapter" data-level="14.7" data-path="separtion.html"><a href="separtion.html#references-7"><i class="fa fa-check"></i><b>14.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="robust-regression.html"><a href="robust-regression.html"><i class="fa fa-check"></i><b>15</b> Robust Regression</a><ul>
<li class="chapter" data-level="" data-path="robust-regression.html"><a href="robust-regression.html#prerequisites-8"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="15.1" data-path="robust-regression.html"><a href="robust-regression.html#wide-tailed-distributions"><i class="fa fa-check"></i><b>15.1</b> Wide Tailed Distributions</a></li>
<li class="chapter" data-level="15.2" data-path="robust-regression.html"><a href="robust-regression.html#student-t-distribution"><i class="fa fa-check"></i><b>15.2</b> Student-t distribution</a><ul>
<li class="chapter" data-level="15.2.1" data-path="robust-regression.html"><a href="robust-regression.html#examples-2"><i class="fa fa-check"></i><b>15.2.1</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="robust-regression.html"><a href="robust-regression.html#robit"><i class="fa fa-check"></i><b>15.3</b> Robit</a></li>
<li class="chapter" data-level="15.4" data-path="robust-regression.html"><a href="robust-regression.html#quantile-regression"><i class="fa fa-check"></i><b>15.4</b> Quantile regression</a><ul>
<li class="chapter" data-level="15.4.1" data-path="robust-regression.html"><a href="robust-regression.html#questions-3"><i class="fa fa-check"></i><b>15.4.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="robust-regression.html"><a href="robust-regression.html#references-8"><i class="fa fa-check"></i><b>15.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html"><i class="fa fa-check"></i><b>16</b> Heteroskedasticity</a><ul>
<li class="chapter" data-level="" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#prerequisites-9"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="16.1" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#introduction-4"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#weighted-regression"><i class="fa fa-check"></i><b>16.2</b> Weighted Regression</a></li>
<li class="chapter" data-level="16.3" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#modeling-the-scale-with-covariates"><i class="fa fa-check"></i><b>16.3</b> Modeling the Scale with Covariates</a></li>
<li class="chapter" data-level="16.4" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#prior-distributions"><i class="fa fa-check"></i><b>16.4</b> Prior Distributions</a><ul>
<li class="chapter" data-level="16.4.1" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#examples-duncan"><i class="fa fa-check"></i><b>16.4.1</b> Examples: Duncan</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#exercises"><i class="fa fa-check"></i><b>16.5</b> Exercises</a></li>
<li class="chapter" data-level="16.6" data-path="heteroskedasticity.html"><a href="heteroskedasticity.html#references-9"><i class="fa fa-check"></i><b>16.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="rare-events.html"><a href="rare-events.html"><i class="fa fa-check"></i><b>17</b> Rare Events</a><ul>
<li class="chapter" data-level="" data-path="rare-events.html"><a href="rare-events.html#prerequisites-10"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="17.1" data-path="rare-events.html"><a href="rare-events.html#introduction-5"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="rare-events.html"><a href="rare-events.html#finite-sample-bias"><i class="fa fa-check"></i><b>17.2</b> Finite-Sample Bias</a></li>
<li class="chapter" data-level="17.3" data-path="rare-events.html"><a href="rare-events.html#case-control"><i class="fa fa-check"></i><b>17.3</b> Case Control</a></li>
<li class="chapter" data-level="17.4" data-path="rare-events.html"><a href="rare-events.html#questions-4"><i class="fa fa-check"></i><b>17.4</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="shrinkage-and-hierarchical-models.html"><a href="shrinkage-and-hierarchical-models.html"><i class="fa fa-check"></i><b>18</b> Shrinkage and Hierarchical Models</a><ul>
<li class="chapter" data-level="18.1" data-path="shrinkage-and-hierarchical-models.html"><a href="shrinkage-and-hierarchical-models.html#hierarchical-models"><i class="fa fa-check"></i><b>18.1</b> Hierarchical Models</a></li>
<li class="chapter" data-level="18.2" data-path="shrinkage-and-hierarchical-models.html"><a href="shrinkage-and-hierarchical-models.html#baseball-hits"><i class="fa fa-check"></i><b>18.2</b> Baseball Hits</a><ul>
<li class="chapter" data-level="18.2.1" data-path="shrinkage-and-hierarchical-models.html"><a href="shrinkage-and-hierarchical-models.html#references-10"><i class="fa fa-check"></i><b>18.2.1</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html"><i class="fa fa-check"></i><b>19</b> Shrinkage and Regularized Regression</a><ul>
<li class="chapter" data-level="" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#prerequisites-11"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="19.1" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#introduction-6"><i class="fa fa-check"></i><b>19.1</b> Introduction</a></li>
<li class="chapter" data-level="19.2" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#shrinkage-estimators"><i class="fa fa-check"></i><b>19.2</b> Shrinkage Estimators</a><ul>
<li class="chapter" data-level="19.2.1" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#penalized-maximum-likelihood-regression"><i class="fa fa-check"></i><b>19.2.1</b> Penalized Maximum Likelihood Regression</a></li>
<li class="chapter" data-level="19.2.2" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#bayesian-shrinkage"><i class="fa fa-check"></i><b>19.2.2</b> Bayesian Shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#sparse-shrinkage"><i class="fa fa-check"></i><b>19.3</b> Sparse Shrinkage</a><ul>
<li class="chapter" data-level="19.3.1" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#penalized-likelihood"><i class="fa fa-check"></i><b>19.3.1</b> Penalized Likelihood</a></li>
<li class="chapter" data-level="19.3.2" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#bayesian-sparse-shrinkage-models"><i class="fa fa-check"></i><b>19.3.2</b> Bayesian Sparse Shrinkage Models</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#section"><i class="fa fa-check"></i><b>19.4</b> </a><ul>
<li class="chapter" data-level="19.4.1" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#shrinkage-factor"><i class="fa fa-check"></i><b>19.4.1</b> Shrinkage Factor</a></li>
<li class="chapter" data-level="19.4.2" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#prior-on-the-global-scale"><i class="fa fa-check"></i><b>19.4.2</b> Prior on the Global Scale</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#differences-between-bayesian-and-penalized-ml"><i class="fa fa-check"></i><b>19.5</b> Differences between Bayesian and Penalized ML</a></li>
<li class="chapter" data-level="19.6" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#examples-3"><i class="fa fa-check"></i><b>19.6</b> Examples</a><ul>
<li class="chapter" data-level="19.6.1" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#diabetes"><i class="fa fa-check"></i><b>19.6.1</b> Diabetes</a></li>
<li class="chapter" data-level="19.6.2" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#example-4"><i class="fa fa-check"></i><b>19.6.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#shrinkage-with-correlated-variables"><i class="fa fa-check"></i><b>19.7</b> Shrinkage with Correlated Variables</a></li>
<li class="chapter" data-level="19.8" data-path="shrinkage-and-regularized-regression.html"><a href="shrinkage-and-regularized-regression.html#variable-selection"><i class="fa fa-check"></i><b>19.8</b> Variable Selection</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>20</b> Multilevel Models</a><ul>
<li class="chapter" data-level="20.1" data-path="multilevel-models.html"><a href="multilevel-models.html#terminology"><i class="fa fa-check"></i><b>20.1</b> Terminology</a></li>
<li class="chapter" data-level="20.2" data-path="multilevel-models.html"><a href="multilevel-models.html#normal"><i class="fa fa-check"></i><b>20.2</b> Normal</a></li>
<li class="chapter" data-level="20.3" data-path="multilevel-models.html"><a href="multilevel-models.html#example-radon"><i class="fa fa-check"></i><b>20.3</b> Example: Radon</a><ul>
<li class="chapter" data-level="20.3.1" data-path="multilevel-models.html"><a href="multilevel-models.html#data"><i class="fa fa-check"></i><b>20.3.1</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="multilevel-models.html"><a href="multilevel-models.html#radon-example"><i class="fa fa-check"></i><b>20.4</b> Radon Example</a></li>
<li class="chapter" data-level="20.5" data-path="multilevel-models.html"><a href="multilevel-models.html#with-individual-covariates"><i class="fa fa-check"></i><b>20.5</b> With Individual Covariates</a></li>
<li class="chapter" data-level="20.6" data-path="multilevel-models.html"><a href="multilevel-models.html#with-group-level-covariates"><i class="fa fa-check"></i><b>20.6</b> With Group-Level Covariates</a></li>
<li class="chapter" data-level="20.7" data-path="multilevel-models.html"><a href="multilevel-models.html#pooling-of-hierarchical-parameters"><i class="fa fa-check"></i><b>20.7</b> Pooling of Hierarchical Parameters</a></li>
<li class="chapter" data-level="20.8" data-path="multilevel-models.html"><a href="multilevel-models.html#lme4"><i class="fa fa-check"></i><b>20.8</b> lme4</a></li>
<li class="chapter" data-level="20.9" data-path="multilevel-models.html"><a href="multilevel-models.html#covariance-priors"><i class="fa fa-check"></i><b>20.9</b> Priors for Covariances</a></li>
<li class="chapter" data-level="20.10" data-path="multilevel-models.html"><a href="multilevel-models.html#cetered-and-non-centered-parameterizations"><i class="fa fa-check"></i><b>20.10</b> Cetered and Non-centered Parameterizations</a></li>
<li class="chapter" data-level="20.11" data-path="multilevel-models.html"><a href="multilevel-models.html#extensions-1"><i class="fa fa-check"></i><b>20.11</b> Extensions</a></li>
<li class="chapter" data-level="20.12" data-path="multilevel-models.html"><a href="multilevel-models.html#miscellaneous"><i class="fa fa-check"></i><b>20.12</b> Miscellaneous</a><ul>
<li class="chapter" data-level="20.12.1" data-path="multilevel-models.html"><a href="multilevel-models.html#how-many-groups"><i class="fa fa-check"></i><b>20.12.1</b> How many groups?</a></li>
<li class="chapter" data-level="20.12.2" data-path="multilevel-models.html"><a href="multilevel-models.html#correlation-between-predictors-and-errors"><i class="fa fa-check"></i><b>20.12.2</b> Correlation between Predictors and Errors</a></li>
</ul></li>
<li class="chapter" data-level="20.13" data-path="multilevel-models.html"><a href="multilevel-models.html#references-11"><i class="fa fa-check"></i><b>20.13</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#prerequisites-12"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="20.14" data-path="appendix.html"><a href="appendix.html#parameters"><i class="fa fa-check"></i><b>20.14</b> Parameters</a></li>
<li class="chapter" data-level="20.15" data-path="appendix.html"><a href="appendix.html#miscellaneous-mathematical-background"><i class="fa fa-check"></i><b>20.15</b> Miscellaneous Mathematical Background</a><ul>
<li class="chapter" data-level="20.15.1" data-path="appendix.html"><a href="appendix.html#location-scale-families"><i class="fa fa-check"></i><b>20.15.1</b> Location-Scale Families</a></li>
<li class="chapter" data-level="20.15.2" data-path="appendix.html"><a href="appendix.html#scale-mixtures-of-normal-distributions"><i class="fa fa-check"></i><b>20.15.2</b> Scale Mixtures of Normal Distributions</a></li>
<li class="chapter" data-level="20.15.3" data-path="appendix.html"><a href="appendix.html#covariance-correlation-matrix-decomposition"><i class="fa fa-check"></i><b>20.15.3</b> Covariance-Correlation Matrix Decomposition</a></li>
<li class="chapter" data-level="20.15.4" data-path="appendix.html"><a href="appendix.html#qr-factorization"><i class="fa fa-check"></i><b>20.15.4</b> QR Factorization</a></li>
<li class="chapter" data-level="20.15.5" data-path="appendix.html"><a href="appendix.html#cholesky-decomposition"><i class="fa fa-check"></i><b>20.15.5</b> Cholesky Decomposition</a></li>
</ul></li>
<li class="chapter" data-level="20.16" data-path="appendix.html"><a href="appendix.html#scaled-and-unscaled-variables"><i class="fa fa-check"></i><b>20.16</b> Scaled and Unscaled Variables</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>21</b> Distributions</a></li>
<li class="chapter" data-level="22" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html"><i class="fa fa-check"></i><b>22</b> Annotated Bibliography</a><ul>
<li class="chapter" data-level="22.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#textbooks"><i class="fa fa-check"></i><b>22.1</b> Textbooks</a></li>
<li class="chapter" data-level="22.2" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#syllabi"><i class="fa fa-check"></i><b>22.2</b> Syllabi</a></li>
<li class="chapter" data-level="22.3" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#topics"><i class="fa fa-check"></i><b>22.3</b> Topics</a></li>
<li class="chapter" data-level="22.4" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayes-theorem-1"><i class="fa fa-check"></i><b>22.4</b> Bayes’ Theorem</a></li>
<li class="chapter" data-level="22.5" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#article-length-introductions-to-bayesian-statistics"><i class="fa fa-check"></i><b>22.5</b> Article Length Introductions to Bayesian Statistics</a><ul>
<li class="chapter" data-level="22.5.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#why-bayesian"><i class="fa fa-check"></i><b>22.5.1</b> Why Bayesian</a></li>
<li class="chapter" data-level="22.5.2" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#modern-statistical-workflow"><i class="fa fa-check"></i><b>22.5.2</b> Modern Statistical Workflow</a></li>
<li class="chapter" data-level="22.5.3" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-philosophy"><i class="fa fa-check"></i><b>22.5.3</b> Bayesian Philosophy</a></li>
<li class="chapter" data-level="22.5.4" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-hypothesis-testing"><i class="fa fa-check"></i><b>22.5.4</b> Bayesian Hypothesis Testing</a></li>
<li class="chapter" data-level="22.5.5" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-frequentist-debates"><i class="fa fa-check"></i><b>22.5.5</b> Bayesian Frequentist Debates</a></li>
<li class="chapter" data-level="22.5.6" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#categorical"><i class="fa fa-check"></i><b>22.5.6</b> Categorical</a></li>
<li class="chapter" data-level="22.5.7" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#variable-selection-1"><i class="fa fa-check"></i><b>22.5.7</b> Variable Selection</a></li>
<li class="chapter" data-level="22.5.8" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#multiple-testing"><i class="fa fa-check"></i><b>22.5.8</b> Multiple Testing</a></li>
<li class="chapter" data-level="22.5.9" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#rare-events-1"><i class="fa fa-check"></i><b>22.5.9</b> Rare Events</a></li>
<li class="chapter" data-level="22.5.10" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#identifiability"><i class="fa fa-check"></i><b>22.5.10</b> Identifiability</a></li>
<li class="chapter" data-level="22.5.11" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#shrinkage"><i class="fa fa-check"></i><b>22.5.11</b> Shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#software"><i class="fa fa-check"></i><b>22.6</b> Software</a><ul>
<li class="chapter" data-level="22.6.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#stan-2"><i class="fa fa-check"></i><b>22.6.1</b> Stan</a></li>
<li class="chapter" data-level="22.6.2" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#diagrams"><i class="fa fa-check"></i><b>22.6.2</b> Diagrams</a></li>
<li class="chapter" data-level="22.6.3" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#priors-1"><i class="fa fa-check"></i><b>22.6.3</b> Priors</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-model-averaging-1"><i class="fa fa-check"></i><b>22.7</b> Bayesian Model Averaging</a></li>
<li class="chapter" data-level="22.8" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#multilevel-modeling"><i class="fa fa-check"></i><b>22.8</b> Multilevel Modeling</a></li>
<li class="chapter" data-level="22.9" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#mixture-models-1"><i class="fa fa-check"></i><b>22.9</b> Mixture Models</a></li>
<li class="chapter" data-level="22.10" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#inference"><i class="fa fa-check"></i><b>22.10</b> Inference</a><ul>
<li class="chapter" data-level="22.10.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#discussion-of-bayesian-inference"><i class="fa fa-check"></i><b>22.10.1</b> Discussion of Bayesian Inference</a></li>
</ul></li>
<li class="chapter" data-level="22.11" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#model-checking-1"><i class="fa fa-check"></i><b>22.11</b> Model Checking</a><ul>
<li class="chapter" data-level="22.11.1" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#posterior-predictive-checks-1"><i class="fa fa-check"></i><b>22.11.1</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="22.11.2" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#prediction-criteria"><i class="fa fa-check"></i><b>22.11.2</b> Prediction Criteria</a></li>
<li class="chapter" data-level="22.11.3" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#software-validation"><i class="fa fa-check"></i><b>22.11.3</b> Software Validation</a></li>
</ul></li>
<li class="chapter" data-level="22.12" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#hierarchical-modeling"><i class="fa fa-check"></i><b>22.12</b> Hierarchical Modeling</a></li>
<li class="chapter" data-level="22.13" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#shrinkageregularization"><i class="fa fa-check"></i><b>22.13</b> Shrinkage/Regularization</a></li>
<li class="chapter" data-level="22.14" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#empirical-bayes"><i class="fa fa-check"></i><b>22.14</b> Empirical Bayes</a></li>
<li class="chapter" data-level="22.15" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#history-of-bayesian-statistics"><i class="fa fa-check"></i><b>22.15</b> History of Bayesian Statistics</a></li>
<li class="chapter" data-level="22.16" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#sampling-difficulties"><i class="fa fa-check"></i><b>22.16</b> Sampling Difficulties</a></li>
<li class="chapter" data-level="22.17" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#complicated-estimation-and-testing"><i class="fa fa-check"></i><b>22.17</b> Complicated Estimation and Testing</a></li>
<li class="chapter" data-level="22.18" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#pooling-polls"><i class="fa fa-check"></i><b>22.18</b> Pooling Polls</a></li>
<li class="chapter" data-level="22.19" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#visualizing-mcmc-methods"><i class="fa fa-check"></i><b>22.19</b> Visualizing MCMC Methods</a></li>
<li class="chapter" data-level="22.20" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayesian-point-estimation-decision"><i class="fa fa-check"></i><b>22.20</b> Bayesian point estimation / Decision</a></li>
<li class="chapter" data-level="22.21" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#stan-modeling-language"><i class="fa fa-check"></i><b>22.21</b> Stan Modeling Language</a></li>
<li class="chapter" data-level="22.22" data-path="annotated-bibliography.html"><a href="annotated-bibliography.html#bayes-factors"><i class="fa fa-check"></i><b>22.22</b> Bayes Factors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-12.html"><a href="references-12.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Updating: A Set of Bayesian Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
\[
\DeclareMathOperator{\E}{E}
\DeclareMathOperator{\mean}{mean}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Cor}{Cor}
\DeclareMathOperator{\Bias}{Bias}
\DeclareMathOperator{\MSE}{MSE}
\DeclareMathOperator{\RMSE}{RMSE}
\DeclareMathOperator{\sd}{sd}
\DeclareMathOperator{\se}{se}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\median}{median}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator{\logistic}{Logistic}
\DeclareMathOperator{\logit}{Logit}

\newcommand{\mat}[1]{\boldsymbol{#1}}
\newcommand{\vec}[1]{\boldsymbol{#1}}
\newcommand{\T}{'}

% This follows BDA
\newcommand{\dunif}{\mathsf{Uniform}}
\newcommand{\dnorm}{\mathsf{Normal}}
\newcommand{\dhalfnorm}{\mathrm{HalfNormal}}
\newcommand{\dlnorm}{\mathsf{LogNormal}}
\newcommand{\dmvnorm}{\mathsf{Normal}}
\newcommand{\dgamma}{\mathsf{Gamma}}
\newcommand{\dinvgamma}{\mathsf{InvGamma}}
\newcommand{\dchisq}{\mathsf{ChiSquared}}
\newcommand{\dinvchisq}{\mathsf{InvChiSquared}}
\newcommand{\dexp}{\mathsf{Exponential}}
\newcommand{\dlaplace}{\mathsf{Laplace}}
\newcommand{\dweibull}{\mathsf{Weibull}}
\newcommand{\dwishart}{\mathsf{Wishart}}
\newcommand{\dinvwishart}{\mathsf{InvWishart}}
\newcommand{\dlkj}{\mathsf{LkjCorr}}
\newcommand{\dt}{\mathsf{StudentT}}
\newcommand{\dhalft}{\mathsf{HalfStudentT}}
\newcommand{\dbeta}{\mathsf{Beta}}
\newcommand{\ddirichlet}{\mathsf{Dirichlet}}
\newcommand{\dlogistic}{\mathsf{Logistic}}
\newcommand{\dllogistic}{\mathsf{LogLogistic}}
\newcommand{\dpois}{\mathsf{Poisson}}
\newcommand{\dBinom}{\mathsf{Binomial}}
\newcommand{\dmultinom}{\mathsf{Multinom}}
\newcommand{\dnbinom}{\mathsf{NegativeBinomial}}
\newcommand{\dnbinomalt}{\mathsf{NegativeBinomial2}}
\newcommand{\dbetabinom}{\mathsf{BetaBinomial}}
\newcommand{\dcauchy}{\mathsf{Cauchy}}
\newcommand{\dhalfcauchy}{\mathsf{HalfCauchy}}
\newcommand{\dbernoulli}{\mathsf{Bernoulli}}

\newcommand{\R}{\mathbb{R}}
\newcommand{\Reals}{\R}
\newcommand{\RealPos}{\R^{+}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Nats}{\N}

\newcommand{\cia}{\perp\!\!\!\perp}
\DeclareMathOperator*{\plim}{plim}

\DeclareMathOperator{\invlogit}{Inv-Logit}
\DeclareMathOperator{\logit}{Logit}
\DeclareMathOperator{\diag}{diag}

\]
<div id="shrinkage-and-regularized-regression" class="section level1">
<h1><span class="header-section-number">19</span> Shrinkage and Regularized Regression</h1>
<div id="prerequisites-11" class="section level2 unnumbered">
<h2>Prerequisites</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;rstan&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;rstanarm&quot;</span>)
<span class="co"># rstanarm automatically sets the theme</span>
<span class="kw">theme_set</span>(<span class="kw">theme_gray</span>())
<span class="kw">library</span>(<span class="st">&quot;bayz&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;broom&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;glmnet&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;recipes&quot;</span>)</code></pre>
</div>
<div id="introduction-6" class="section level2">
<h2><span class="header-section-number">19.1</span> Introduction</h2>
<p>In this chapter, we will discuss shrinkage and regularization in regression problems.
These methods are useful for improving prediction, estimating regression models
with many variables, and as an alternative to model selection methods.</p>
<p>Shrinkage estimation deliberately increases the bias of the model in order
to reduce variance and improve overall model performance, often at the cost of individual estimates <span class="citation">(Efron and Hastie 2016, 91)</span>.
Maximum likelihood estimation will produce asymptotically unbiased (consistent) estimates,
given certain regularity conditions.
However, the bias-variance tradeoff implies that generalization error can be decreased with a non-zero amount of bias.
By adding bias to the model, shrinkage estimators provide a means to adjust the bias-variance in the model in order to achieve lower generalization error.</p>
<p>In the Bayesian estimation, shrinkage occurs as a result of hierarchical models.
When parameters are modeled as exchangeable and given a proper prior, it induces some amount of shrinkage.
Likewise, Bayesian models with non- or weakly-informative priors will produce similar to the MLE.
But stronger priors can produce estimate much different estimtes than MLE.</p>
<p>Regularization describes any method that reduces variability in high dimensional
estimation or prediction problems to allow estimation of unidentified or ill-posed
questions or decrease overfitting or generalization error <span class="citation">(Efron and Hastie 2016)</span>.
Regularization can be thought of as the why and what of these methods, and shrinkage can be
thought of as the how.</p>
<p>A particularly important case of shrinkage is sparse shrinkage.
Sparse shrinkage estimators produce solutions that can be sparse, containing zeros.
In the optimizatization case, shrinkage
The most well known of these is the lasso.</p>
<p>For all of these examples we will be considering a linear regression with normal errors,
<span class="math display">\[
y_i \sim \dnorm(\alpha + x&#39;_i \beta, \sigma)
\]</span>
where there are <span class="math inline">\(i = 1, \dots, n\)</span> observations, <span class="math inline">\(x_i\)</span> is a <span class="math inline">\(k \times 1\)</span> vector
of predictors, <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\sigma\)</span> are scalars, and <span class="math inline">\(beta\)</span> is a <span class="math inline">\(k \times 1\)</span>
vector of predictors.</p>
</div>
<div id="shrinkage-estimators" class="section level2">
<h2><span class="header-section-number">19.2</span> Shrinkage Estimators</h2>
<div id="penalized-maximum-likelihood-regression" class="section level3">
<h3><span class="header-section-number">19.2.1</span> Penalized Maximum Likelihood Regression</h3>
<p>OLS finds the <span class="math inline">\(\beta\)</span> that minimize the in-sample sum of squared errors,
<span class="math display">\[
\hat{\beta}_{\text{OLS}} = \arg\min_{\beta} \sum_{i = 1}^n (\vec{x}_i\T \vec{\beta} - y_i)^2
\]</span></p>
<p>Penalized regressions add a penalty term increasing in the magnitude of <span class="math inline">\(\beta\)</span> to the minimization function.
<span class="math display">\[
\hat{\beta}_{\text{penalized}} = \argmin_{\beta} \sum_{i = 1}^n (\vec{x}_i\T \vec{\beta} - y_i)^2 + \underbrace{f(\beta)}_{\text{shrinkage penalty}},
\]</span>
where <span class="math inline">\(f\)</span> is some sort of penalty function on <span class="math inline">\(\beta\)</span> that penalizes larger (in magnitude) values of <span class="math inline">\(\beta\)</span>.</p>
<p>Penalized regression purposefully introduces bias into the regression in order
to reduce variance and improve out-of-sample prediction.
The penalty term, when chosen by cross-validation or an approximation thereof, allows for trading off bias and variance.</p>
<p>Different penalized regression methods use different choices of <span class="math inline">\(f(\beta)\)</span>.
The two most commonly penalty functions are Ridge and Lasso.</p>
<p>Ridge regression uses the following penalty <span class="citation">(Hoerl and Kennard 1970)</span>:
<span class="math display">\[
\hat{\beta}_{\text{ridge}} = \arg\min_{\beta} \underbrace{\sum_{i = 1}^n (\vec{x}_i\T \vec{\beta} - y_i)^2}_{\text{RSS}} + \underbrace{\lambda}_{\text{tuning parameter}} \underbrace{\sum_{k} \beta_k^2}_{\ell_2 \text{ norm}^2}
\]</span>
The <span class="math inline">\(\ell_2\)</span> norm of <span class="math inline">\(\beta\)</span> is,
<span class="math display">\[
||\beta||_{2} = \sqrt{\sum_{k = 1}^K \beta_k^2} .
\]</span></p>
<p>The ridge regression coefficients are smaller in magnitude than the OLS coefficients, <span class="math inline">\(|\hat{\beta}_{ridge}| &lt; |\hat{\beta}_{OLS}|\)</span>.
However, this bias in the coefficients can be offset by a lower variance, better MSE, and better out-of-sample performance than the OLS estimates.</p>
<p>Unlike many other penalized regression estimators, ridge regression has a
close-form solution.
The expected value and variance-covariance matrix of the ridge regression
coefficients is,
<span class="math display">\[
\begin{aligned}[t]
\E[\hat{\beta}_{\text{ridge}}] &amp;= W X&#39; y \\
\Var[\hat{\beta}_{\text{ridge}}] &amp;=  \sigma^2 W&#39; X&#39; X W , \\
W &amp;= (X&#39; X + \lambda I)^{-1} .
\end{aligned}
\]</span>
The solution is similar to the least squares solution, with the addition of the <span class="math inline">\(\lambda I\)</span> term to <span class="math inline">\(X&#39; X\)</span>.</p>
<p>As <span class="math inline">\(\lambda \to 0\)</span>, <span class="math inline">\(\hat{\beta}_{\text{ridge}} \to \hat{\beta}_{\text{OLS}}\)</span>.</p>
<p>As <span class="math inline">\(\lambda \to \infty\)</span>, <span class="math inline">\(\hat{\beta}_{\text{ridge}} \to 0\)</span>.</p>
<p>The bias of ridge regression is,
<span class="math display">\[
\mathrm{Bias}(\hat{\beta}_{\text{ridge}}) = -\lambda W \beta
\]</span>
Thus, <span class="math inline">\(\mathrm{Bias}(\hat{\beta}_{\text{ridge}})\)</span> is decreasing in the shrinkage factor <span class="math inline">\(\lambda\)</span>.
The bias of ridge regression is non-zero, <span class="math inline">\(\mathrm{Bias}(\hat{\beta}_{\text{ridge}}) \neq 0\)</span> when <span class="math inline">\(\lamba &gt; 0\)</span>.
When <span class="math inline">\(\lambda \to 0\)</span>, then <span class="math inline">\(\mathrm{Bias}(\hat{\beta}_{\text{ridge}}) \to 0\)</span>.</p>
<p>Additionally,
<span class="math display">\[
\Var(\hat{\beta}_{\text{ridge}}) &lt; \Var(\hat{\beta}_{\text{OLS}})
\]</span>
and <span class="math inline">\(\Var(\hat{\beta}_{\text{ridge}})\)</span> is decreasing as <span class="math inline">\(\lambda \to \infty\)</span>.</p>
<p>The most important result with respect to ridge regression is that there always exists a <span class="math inline">\(\lambda\)</span> such that,
<span class="math display">\[
MSE(\hat{\beta}_{\text{ridge}}(\lambda)) &lt; MSE(\hat{\beta}_{\text{OLS}}) .
\]</span></p>
<p>The complexity of the model is the degrees of freedom.
In OLS, the degrees of freedom is the trace of the hat matrix,
<span class="math display">\[
\tr(H_{\text{OLS}}) = k
\]</span>
where
<span class="math display">\[
H_{\text{OLS}} = (X&#39; X)^{-1} X&#39; .
\]</span></p>
<p>In ridge regression, the degrees of freedom is the trace of the analagous hat matrix,
<span class="math display">\[
df_{\text{ridge}} = \tr(H_{\text{ridge}}) = \sum \frac{\lambda_i}{\lambda_i + \lambda}
\]</span>
where
<span class="math display">\[
H_{\text{ridge}} = X W X&#39; ,
\]</span>
and <span class="math inline">\(\lambda_i\)</span> are the eigenvalues of <span class="math inline">\(X&#39; X\)</span>.
When <span class="math inline">\(\lambda \to 0\)</span>, then <span class="math inline">\(df = k\)</span>, and
when <span class="math inline">\(\lambda \to \infty\)</span>, then <span class="math inline">\(df = 0\)</span>.
As expected, as the penalty factor increases the model complexity decreases.</p>
<p>Some other implications:</p>
<ul>
<li><p><span class="math inline">\(\hat{\vec{\beta}}\)</span> exists even if <span class="math inline">\(\hat{\vec{\beta}}_{\text{OLS}}\)</span>
(<span class="math inline">\((\mat{X}\T\mat{X})^{-1}\)</span>), i.e. cases of <span class="math inline">\(n &gt; p\)</span> and collinearity, does
not exist.</p></li>
<li><p>If <span class="math inline">\(\mat{X}\)</span> is orthogonal (mean 0, unit variance, zero correlation),
<span class="math inline">\(\mat{X}\T \mat{X} = n \mat{I}_p\)</span> then
<span class="math display">\[
\hat{\vec{\beta}}_{\text{ridge}} = \frac{n}{n + \lambda}
\hat{\vec{\beta}}_{\text{ols}}
\]</span>
meaning,
<span class="math display">\[
|\hat{\vec{\beta}}_{\text{ols}}| &gt;
|\hat{\vec{\beta}}_{\text{ridge}}| \geq 0
\]</span></p></li>
<li><p>Ridge does not produce sparse estimates, since
<span class="math inline">\((n / (n + \lambda)) \vec{\vec{\beta}}_{ols} = 0\)</span> iff <span class="math inline">\(\vec{\vec{\beta}}_{ols} = 0\)</span></p></li>
<li><p>If <span class="math inline">\(\lambda = 0\)</span>, then the ridge coefficients are the same as the OLS
coefficients,
<span class="math inline">\(\lambda \to 0 \Rightarrow \hat{beta}_{\text{ridge}} \to \hat{beta}_{OLS}\)</span></p></li>
<li><p>As <span class="math inline">\(\lambda\)</span> increases the coefficients are shrunk to 0,
<span class="math inline">\(\lambda \to \infty \Rightarrow \hat{\beta}_{\text{ridge}} = 0\)</span>.</p></li>
</ul>
</div>
<div id="bayesian-shrinkage" class="section level3">
<h3><span class="header-section-number">19.2.2</span> Bayesian Shrinkage</h3>
<p>As shown in the hierarchical chapter, modeling parameters hierarchically can shrink them.
Consider the regression model,
<span class="math display">\[
y_i \sim \dnorm(\alpha + x&#39;_i \beta_k) .
\]</span>
In the case of shrinkage in regularization, a hierarchical prior is applied to the regression coefficients <span class="math inline">\(\beta\)</span>.</p>
<p>The intercept, <span class="math inline">\(\alpha\)</span>, is generally not shrunk.
In all these cases, it can be given a weakly-informative prior such as,
<span class="math display">\[
y_i \sim \dnorm(0, 10) .
\]</span></p>
<div id="normal-priors" class="section level4">
<h4><span class="header-section-number">19.2.2.1</span> Normal Priors</h4>
<p>Unlike the weakly informative priors, the prior distributions all share a scale parameter <span class="math inline">\(\tau\)</span>.
<span class="math display">\[
\beta_k | \tau \sim \dnorm(0, \tau)
\]</span></p>
<p>We need to assign a prior to <span class="math inline">\(\tau\)</span>.
Often this is assigned an “uninformative” gamma or inverse-gamma prior because it has conjugacy properties.
Analagous to later priors and current advice about scale parameter choices in Stan, a Student-t distribution with location 0, and a user-specified degrees of freedom <span class="math inline">\(d_\tau\)</span> and <span class="math inline">\(s_\tau\)</span> is reasonable,
<span class="math display">\[
\tau \sim \dt(d_\tau, 0, s_\tau) .
\]</span></p>
<div id="relationship-to-ridge-regression" class="section level5">
<h5><span class="header-section-number">19.2.2.1.1</span> Relationship to Ridge Regression</h5>
<p>For a given <span class="math inline">\(\lamba\)</span>, the ridge regression estimator is a MAP estimator of the model,
<span class="math display">\[
\begin{aligned}[t]
y_i &amp;\sim \dnorm(\alpha + x&#39; \beta, \sigma) \\
\beta_k &amp;\sim \dnorm(0, (2 \lambda)^{-1/2} ) .
\end{aligned}
\]</span></p>
<p>Recall that although OLS does not require normal errors, the OLS coefficients are equivalent to the MLE of a probability model with normal errors,
<span class="math display">\[
\begin{aligned}
\hat{\beta}_{MLE} &amp;= \arg \max_{\beta} \dnorm(y | x \beta, \sigma) \\
&amp; = \arg \max_{\beta} {(2 \pi \sigma^2)}^{n / 2} \prod_{i = 1}^{n} \exp\left(-\frac{(y_i - x_i&#39; \beta)^2}{2 \sigma^2}\right) \\
&amp;= \arg \max_{\beta} \frac{n}{2} (\log 2 + \log \pi) + n \log \sigma + \sum_{i = 1}^{n} \left( -\frac{(y_i - x_i&#39; \beta)^2}{2 \sigma^2} \right) \\
&amp; = \arg \max_{\beta} \sum_{i = 1}^{n} - (y_i - x&#39;_i \beta)^2 \\
&amp;= \arg \min_{\beta} \sum_{i = 1} (y_i - x&#39;_i \beta)^2 \\
&amp;= \hat{\beta}_{OLS}
\end{aligned}
\]</span>
Likewise the shrinkage prior can be represented as a normal distribution with mean 0 and scale <span class="math inline">\(1 / \lambda\)</span>,
since the <span class="math inline">\(\beta\)</span> that maximize the probability of that,
minimize the <span class="math inline">\(\ell_2\)</span> norm of <span class="math inline">\(\beta\)</span>,
<span class="math display">\[
\begin{aligned}
\arg \max_{\beta} \dnorm(\beta | 0,  \tau) &amp;= \arg \max_{\beta} {(2 \pi \sigma^2)}^{K / 2} \prod_{k = 1}^{K} \exp\left(- \frac{(0 - \beta_k)^2}{2 \tau^2} \right)
\\
&amp;= \arg \max_{\beta} \sum_{k = 1}^{K} \left(-\frac{\beta_k^2}{2 \tau^2}\right) \\
&amp;= \arg \min_{\beta} \frac{1}{2 \tau^2} \sum_{k = 1}^K \beta_k^2 ,
\end{aligned}
\]</span>
where <span class="math inline">\(\tau^2 = 1 / 2 \lambda\)</span>.</p>
</div>
</div>
<div id="student-t-distribution-1" class="section level4">
<h4><span class="header-section-number">19.2.2.2</span> Student-t Distribution</h4>
<p>We can generalize the previous case and use Student-t distributions as a prior for the coefficients.
The Cauchy distribution is a special case of the Student t distribution where the degrees of freedom is one.</p>
<p>The prior distribution for each coefficient <span class="math inline">\(\beta_k\)</span> is a Student-t distribution with degrees of freedom <span class="math inline">\(\nu\)</span>, location 0, and scale <span class="math inline">\(\tau\)</span>,
<span class="math display">\[
\beta_k | \tau \sim \dt(\nu, 0, \tau) .
\]</span>
Like many priors that have been proposed and used for coefficient shrinkage, this can be represented as a local-global scale-mixture of normal distributions.
<span class="math display">\[
\begin{aligned}
\beta_k | \tau, \lambda &amp;\sim \dnorm(0, \tau \lambda_k) \\
\lambda_k^{-2} &amp;\sim \dgamma(\nu/2, \nu/2)
\end{aligned}
\]</span></p>
<p>The degrees of freedom parameter <span class="math inline">\(\nu\)</span> can be fixed to a particular value or estimated.
If fixed, then common values are 1 for a Cauchy distribution, 2 to ensure that there is a finite mean, 3 to ensure that there is a finite variance, and 4 ensure that there is a finite kurtosis.</p>
<p>If the degrees of freedom is not specified, then use the prior,
<span class="math display">\[
\nu \sim \dgamma(2, 0.1)
\]</span>
Additionally, it may be useful to truncate the values of <span class="math inline">\(\nu\)</span> to be greater
than 2 to ensure a finite variance of the Student t distribution.</p>
<p>The following figure plots the probability density functions for normal, Cauchy, and Student-t (<span class="math inline">\(df = 4\)</span>) distributions.
Relative to a normal distribution, Student-t distributions will place more prior probability mass closer to zero, and also more mass that the distribution can be far large.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">length.out =</span> <span class="dv">100</span>),
       <span class="st">`</span><span class="dt">Normal</span><span class="st">`</span> =<span class="st"> </span><span class="kw">dnorm</span>(x),
       <span class="st">`</span><span class="dt">Cauchy</span><span class="st">`</span> =<span class="st"> </span><span class="kw">dcauchy</span>(x),
       <span class="st">`</span><span class="dt">Student-t (df = 4)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">dt</span>(x, <span class="dv">4</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(Distribution, Density, <span class="op">-</span>x) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> Density, <span class="dt">colour =</span> Distribution)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(beta)) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;(&quot;</span>, beta, <span class="st">&quot;)&quot;</span>)))</code></pre>
<p><img src="regression-shrinkage_files/figure-html/unnamed-chunk-3-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Note that, the use of a Student <span class="math inline">\(t\)</span> distribtion in the regression here is different than the use of the Student-t distribution for robustness.
In the robustness case, <span class="math inline">\(y_i\)</span> is distributed Student-t,
<span class="math display">\[
y_i \sim \dt(\nu_y, \alpha + x_i&#39; \beta, \sigma),
\]</span>
or equivalently, the errors, <span class="math inline">\(\epsilon_i\)</span>, are distributed Student-t,
<span class="math display">\[
y_i = \alpha + x&#39;_i \beta + \epsilon_i \\
\epsilon_i \sim \dt(\nu, 0, \sigma)
\]</span></p>
<p>In regularized regression with Student-t priors, the <span class="math inline">\(\beta\)</span> are distributed Student-t.
These models could be combined, with a <span class="math inline">\(\epsilon_i\)</span> distributed Student-t and <span class="math inline">\(\beta\)</span> given Student-t priors, for a regularized robust regression.</p>
</div>
</div>
</div>
<div id="sparse-shrinkage" class="section level2">
<h2><span class="header-section-number">19.3</span> Sparse Shrinkage</h2>
<p>A sparse shrinkage estimator is one that produces point estimates exactly equal to zero (in MAP), or posterior distributions where for some parameters, the probability density mass concentrates around zero (in full Bayes).</p>
<p>Ridge regression and the prior distributions covered thus far are not sparse shrinkage estimators.</p>
<p>Many of the proofs and results regarding the performance of these methods are for the case that the true parameters are sparse, usually defined as
<span class="math display">\[
n \to \infty \Rightarrow k / n \to 0 ,
\]</span>
where <span class="math inline">\(k\)</span> is the true number of <em>non-zero</em> parameters, and <span class="math inline">\(n\)</span> is the number of observations.</p>
<p>Of sparse shrinkage estimators for regression coefficients, the most popular optimization MAPS</p>
<p>There are two main approaches to sparsity in Bayesian statistics [CarvalhoPolsonScott2009a]:</p>
<ul>
<li>discrete mixtures that place a point mass at <span class="math inline">\(\beta_k = 0\)</span> (Beauchamp 1988, George and McCulloch 1993). THis is called a spike-and-slab prior.</li>
<li>shrinkage solution which uses an absolutely continuous prior that places a large mass of its density near zero.
The horseshoe prior is an example of this.
Using Laplace (double exponential) priors,
although analagous to the the lasso, is not an example.</li>
</ul>
<div id="penalized-likelihood" class="section level3">
<h3><span class="header-section-number">19.3.1</span> Penalized Likelihood</h3>
<p>The lasso (Least Absolute Shrinkage and Selection Operator) uses an <span class="math inline">\(\ell_1\)</span> norm of <span class="math inline">\(\beta\)</span> as a penalty <span class="citation">(Tibshirani 1996)</span>,
<span class="math display">\[
\hat{\beta}_{\text{lasso}} = \arg\min_{\beta} \frac{1}{2 \sigma} \sum_{i = 1}^n (\vec{x}_i\T \vec{\beta} - y_i)^2 + \lambda \sum_{k} |\beta_k|
\]</span>
where <span class="math inline">\(\lambda \geq 0\)</span> is a tuning or shrinkage parameter chosen by cross-validation or a plug-in statistic.</p>
<p>The <span class="math inline">\(\ell_1\)</span> norm of <span class="math inline">\(\beta\)</span> is the sum of the absolute values of its elements,
<span class="math display">\[
||\beta||_{1} = \sum_{k = 1}^K |\beta_k| .
\]</span></p>
<p>Properties:</p>
<ul>
<li><p>Unlike ridge regression, it sets some coefficients exactly to 0, producing
sparse solutions.</p></li>
<li><p>If variables are perfectly correlated, there is no unique solution
(unlike the ridge regression).</p></li>
<li><p>Used as the best convex approximation of the “best subset selection”
regression problem, which finds the number of nonzero entries in a vector.</p></li>
<li><p>Unlike ridge regression, there is no closed-form solution.
Since <span class="math inline">\(|\beta_k|\)</span> does not have a derivative, it was a more difficult
iterative problem than many other regression functions. However, now there
are several algorithms to estimate it.</p></li>
</ul>
</div>
<div id="bayesian-sparse-shrinkage-models" class="section level3">
<h3><span class="header-section-number">19.3.2</span> Bayesian Sparse Shrinkage Models</h3>
<div id="mixture-models" class="section level4">
<h4><span class="header-section-number">19.3.2.1</span> Mixture Models</h4>
<p>This is a “gold standard” for sparse Bayesian estimation.
It directly represents sparsity with a point mass on <span class="math inline">\(\beta_k\)</span>.
The prior is a two-component mixture of normal distributions
<span class="math display">\[
\begin{aligned}[t]
\beta_k | \lambda_k, c, \epsilon  &amp;\sim \lambda_k N(0, c^2), + (1 - \lambda_j) N(0, \epsilon^2) \\
\lambda_k &amp;\sim \dbern(\pi), 
\end{aligned}
\]</span>
for <span class="math inline">\(k = 1, \dots, K\)</span>, and <span class="math inline">\(\epsilon &lt;&lt; c\)</span>.
The indicator variable <span class="math inline">\(\lambda_{k} \in \{0, 1}\)</span> denotes whether <span class="math inline">\(\beta_j\)</span> is close to zero; <span class="math inline">\(\lambda_k = 0\)</span> means that the coefficient came from the spike, and <span class="math inline">\(\lambda_k = 1\)</span> means that the coefficient came from the slab.
The value of <span class="math inline">\(\epsilon\)</span> can be either 0, implying a delta spike at 0, or <span class="math inline">\(\epsilon &gt; 0\)</span>, but small.
The values of <span class="math inline">\(c\)</span> and <span class="math inline">\(\pi\)</span> need to be chosen or assigned priors.</p>
<p>If <span class="math inline">\(\epsilon = 0\)</span>, then
<span class="math display">\[
\begin{aligned}
\beta_k | \lambda_k, c &amp;\sim \dnorm(0, c^2 \lambda^2_k), \\
\lambda_k &amp;\sim \dbern(\pi)
\end{aligned}
\]</span>
The shrinkage parameter only takes two values,
<span class="math display">\[
\kappa = \begin{cases} 
1 &amp; \lambda_k = 0 \\
\frac{1}{1 + n \sigma^{-2} s^2_k c^2} &amp; \lambda_k = 1
\end{cases}
\]</span>
As <span class="math inline">\(c \to \infty\)</span>, then <span class="math inline">\(\kappa = \{0, 1}\)</span>,
with shrinkage occurring either completely or not at all.</p>
<p>In the case of the linear regression, an alternative to BMA is to use a
spike-and-slab prior <span class="citation">(Mitchell and Beauchamp 1988, @GeorgeMcCulloch1993a, @IshwaranRao2005a)</span>,
which is a prior that is a discrete mixture of a point mass at 0 and a
non-informative distribution.</p>
<p>The posterior distribution of <span class="math inline">\(w\)</span> is the probability that <span class="math inline">\(\beta_k \neq 0\)</span>, and the conditional posterior distribution <span class="math inline">\(p(\beta_k | y, w = 1)\)</span> is the distribution of <span class="math inline">\(\beta_k\)</span> given that <span class="math inline">\(\beta_k \neq 0\)</span>.</p>
<p>See the R package <strong><a href="https://cran.r-project.org/package=spikeslab">spikeslab</a></strong> and he accompanying article <span class="citation">(Ishwaran, Kogalur, and Rao 2010)</span> for an implementation and review of spike-and-slab regressions.</p>
</div>
<div id="bayesian-lasso" class="section level4">
<h4><span class="header-section-number">19.3.2.2</span> Bayesian Lasso</h4>
<p>Similarly, the <span class="math inline">\(\beta\)</span> that minimize the <span class="math inline">\(\ell_1\)</span> norm also maximize the probability of random variables iid from the Laplace distribution, <span class="math inline">\(\dlaplace(\beta_k | 0, 1 / \lambda)\)</span>.
<span class="math display">\[
\begin{aligned}
\arg \max_{\beta} \dlaplace(\beta | 0, 1 / \lambda) &amp;= \arg \max_{\beta} \left(\frac{\lambda}{2}\right)^{K} \prod_{k = 1}^{K} \exp\left(- \lambda |0 -
\beta_k)| \right) \\
&amp;= \arg \max_{\beta} \sum_{k = 1}^{K} - \lambda |\beta_k| \\
&amp;= \arg \min_{\beta} \lambda \sum_{k = 1}^K |\beta_k| .
\end{aligned}
\]</span>
Thus lasso regression can be thought of as a MAP estimator of the model,
<span class="math display">\[
\begin{aligned}[t]
y_i &amp;\sim \dnorm(\alpha + x&#39; \beta, \sigma) , \\
\beta_k &amp;\sim \dlaplace(0, 1 / \lambda) .
\end{aligned}
\]</span>
The only difference in the lasso is the penalty term, which uses an absolute value penalty for <span class="math inline">\(\beta_k\)</span>.
That term corresponds to a sum of log densities of i.i.d. double exponential (Laplace) distributions.
The double exponential distribution density is similar to a normal distribution,
<span class="math display">\[
\log p(y | \mu, \sigma) \propto - \frac{|y - \mu|}{\sigma}
\]</span>
So the LASSO penalty is equivalent to the log density of a double exponential distribution with location <span class="math inline">\(0\)</span>, and scale <span class="math inline">\(1 / \lambda\)</span>.
<span class="math display">\[
\beta_k \sim \dlaplace(0, \tau)
\]</span></p>
</div>
<div id="horseshore-prior" class="section level4">
<h4><span class="header-section-number">19.3.2.3</span> Horseshore Prior</h4>
<p>The Horseshoe prior is defined solely in terms of a global-local mixture.
<span class="math display">\[
\begin{aligned}
\beta_k | \tau, \lambda &amp;\sim \dnorm(0, \tau \lambda_k) \\
\lambda_k &amp;\sim \dhalfcauchy(0, 1) \\
\tau &amp;\sim \dhalfcauchy(0, \tau_0)
\end{aligned}
\]</span>
The heavy-tailed Cauchy prior on <span class="math inline">\(\lambda_k\)</span> allows individual coefficients to offset and global shrinkage, <span class="math inline">\(\tau\)</span>, and take large values with little shrinkage.
However, the horseshoe prior has computational issues.
The heavy-tails can produce a posterior which does not sufficiently identify large slope coefficients, making it hard to sample.
In HMC-NUTS, these issues will reveal themselves as divergences and often require increase the value of <code>adapt</code> or increasing the value of the <code>treedepth</code>.</p>
<p>The hierarchical shrinkage prior replaces the half-Cauchy prior on <span class="math inline">\(\lambda_k\)</span> with a half-Student-t distribution with degrees of freedom <span class="math inline">\(\nu\)</span>.
<span class="math display">\[
\lambda_k \sim \dhalft(\nu, 0, 1)
\]</span>
The <span class="math inline">\(\nu\)</span> parameter is generally not estimated and fixed to a low value, with <span class="math inline">\(\nu = 4\)</span> being suggested.
The problem with estimating the horseshoe prior is that the wide tails of the Cauchy prior produced a posterior distribution with problematic geometry that was hard to sample.
Increasing the degrees of freedom helped to regularize the posterior.
The downside of this method is that by increasing the degrees of freedom of the Student-t distribution it would also shrink large parameters, which the
horseshoe prior was designed to avoid.</p>
<p>The regularized horseshoe prior (or Finnish horseshoe prior) is defined as
<span class="math display">\[
\begin{aligned}
\beta_k | \tau, \lambda &amp;\sim \dnorm(0, \tau \tilde{\lambda}_k) \\
\tilde{\lambda}_k &amp;= \frac{c \lambda}{\sqrt{c^2 + \tau \lambda^2}} \\
\lambda_k &amp;\sim \dhalfcauchy(1) \\
c^2 &amp;\sim \invgamma(d_{\text{slab}} / 2, d_{\text{slab}} s_{\text{slab}}^2 / 2) \\
\tau &amp;\sim \dhalfcauchy(0, \tau_0^2)
\end{aligned}
\]</span>
Where <span class="math inline">\(d_{\text{slab}}\)</span> is the degrees of freedom for the slab, and <span class="math inline">\(s_{\text{slab}}\)</span> is the scale of the slab.
For defaults <code>rstanarm</code> uses <span class="math inline">\(d_{\text{slab}} = 4\)</span> and <span class="math inline">\(s_{\text{slab}} = 2.5\)</span>.
Like using a Student-t distribution, this regularizes the posterior distribution of a Horseshoe prior.
However, it is less problematic than using the Student-t distribution because it shrinks large coefficients less.</p>
<p>The value of <span class="math inline">\(\tau\)</span> and the choice of its hyper-parameter has a big influence on the sparsity of the coefficients.</p>
</div>
</div>
</div>
<div id="section" class="section level2">
<h2><span class="header-section-number">19.4</span> </h2>
<p><span class="citation">Piironen and Vehtari (2017)</span> treat the prior on <span class="math inline">\(\tau\)</span> as the implied prior on the number of effective parameters.
The shrinkage can be understood as its influence on the number of effective parameters, <span class="math inline">\(m_{eff}\)</span>,
<span class="math display">\[
m_{\text{eff}} = \sum_{j = 1}^K (1 - \kappa_j) .
\]</span>
This is a measure of effective model size.</p>
<p><span class="citation">Piironen and Vehtari (2017)</span> show that for a given <span class="math inline">\(n\)</span> (data standard deviation), <span class="math inline">\(\tau\)</span>, <span class="math inline">\(\lambda_k\)</span>, and <span class="math inline">\(\sigma\)</span>, the and variance of <span class="math inline">\(m_{eff}\)</span>
<span class="math display">\[
\begin{aligned}[t]
\E[m_{eff} | \tau, \sigma] &amp;= \frac{\sigma^{-1} \tau \sqrt{n}}{1 + \sigma^{-1} \tau \sqrt{n}} K , \\
\Var[m_{eff} | \tau, \sigma] &amp;= \frac{\sigma^{-1} \tau \sqrt{n}}{2 (1 + \sigma^{-1} \tau \sqrt{n})2} K .
\end{aligned}
\]</span></p>
<p>Given a prior guess about the sparsity <span class="math inline">\(\beta\)</span>, a prior should be chosen such that it places mass near that guess.
Let <span class="math inline">\(k_0 \in [0, K]\)</span> be the expected number of non-zero elements of <span class="math inline">\(\beta\)</span>, then choose <span class="math inline">\(\tau_0\)</span> such that
<span class="math display">\[
\tau_0 = \frac{k_0}{K - k_0}\frac{\sigma}{\sqrt{n}}
\]</span></p>
<p>This prior depends on the expected sparsity of the solution, which depends on the problem.
PiironenVehtari2017a provide no guidence on how to select <span class="math inline">\(p_0\)</span>.
Perhaps a simpler model, e.g. lasso could be used to estimate <span class="math inline">\(p_0\)</span>.</p>
<ul>
<li><span class="citation">Datta and Ghosh (2013)</span> warn against empirical Bayes estimators of <span class="math inline">\(\tau\)</span> for the horseshoe prior as it can collapse to 0.</li>
<li><span class="citation">Scott and Berger (2010)</span> consider marginal maximum likelihood estimates of <span class="math inline">\(\tau\)</span>. –&gt;</li>
<li><span class="citation">Pas, Kleijn, and Vaart (2014)</span> suggest that an empirical Bayes estimator truncated below at <span class="math inline">\(1 / n\)</span>.</li>
</ul>
<div id="shrinkage-factor" class="section level3">
<h3><span class="header-section-number">19.4.1</span> Shrinkage Factor</h3>
<p><img src="regression-shrinkage_files/figure-html/unnamed-chunk-4-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Suppose that <span class="math inline">\(X\)</span> is a <span class="math inline">\(n \times K\)</span> matrix of predictors,
and <span class="math inline">\(y\)</span> is a <span class="math inline">\(n \times 1\)</span> vector of outcomes.
The conditional posterior for <span class="math inline">\(\beta\)</span> given <span class="math inline">\((X, y)\)</span> is
<span class="math display">\[
\begin{aligned}[t]
p(\beta | \Lambda, \tau, \sigma^2, D) &amp;= \dnorm(\beta | \bar{\beta}, \Sigma), \\
\bar{\beta} &amp;= \tau^2 \Lambda (\tau^2 \Lambda + \sigma^2 (X&#39;X)^{-1})^{-1} \hat{\beta}, \\
\Sigma &amp;= (\tau^{-2} \Lambda^{-1} + \frac{1}{\sigma^{2}} X&#39;X)^{-1}, \\
\Lambda &amp;= \diag(\lambda_1^{2}, \dots, \lambda^{2}_D), \\
\hat{\beta} &amp;= (X&#39;X)^{-1} X&#39;y .
\end{aligned}
\]</span>
If the predictors are uncorrelated with zero mean and variances <span class="math inline">\(\Var(x_k) = s_k^2\)</span>, then
<span class="math display">\[
X&#39;X \approx n \diag(s_1^2, \dots, s^2_K) ,
\]</span>
and we can use the approximations,
<span class="math display">\[
\bar{\beta}_k = (1 - \kappa_k) \hat{\beta}_k,  \\
\kappa_k = \frac{1}{1 + n \sigma^{-2} \tau^2 s_k^2 \lambda_k^2} .
\]</span>
The value <span class="math inline">\(\kappa_k\)</span> is called the <em>shrinkage factor</em> for coefficient <span class="math inline">\(\beta_k\)</span>.
When <span class="math inline">\(\kappa_k = 0\)</span>, then there is no shrinkage and the posterior coefficient is the same as the MLE solution, <span class="math inline">\(\bar{\beta} = \hat{\beta}\)</span>.
When <span class="math inline">\(\kappa_k = 1\)</span>, then there is complete shrinkage and the posterior coefficient is zero, <span class="math inline">\(\bar{\beta} = 0\)</span>.
It also follows that <span class="math inline">\(\bar{\beta} \to 0\)</span> as <span class="math inline">\(\tau \to 0\)</span>, and <span class="math inline">\(\bar{\beta} \to \hat{\beta}\)</span> as <span class="math inline">\(\tau \to \infty\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">shrinkage_factor &lt;-<span class="st"> </span><span class="cf">function</span>(n, <span class="dt">sigma =</span> <span class="dv">1</span>, <span class="dt">tau =</span> <span class="dv">1</span>, <span class="dt">sd_x =</span> <span class="dv">1</span>, <span class="dt">lambda =</span> <span class="dv">1</span>) {
  <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n <span class="op">*</span><span class="st"> </span>tau <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sd_x <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>lambda <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>sigma <span class="op">^</span><span class="st"> </span><span class="dv">2</span>
}</code></pre>
</div>
<div id="prior-on-the-global-scale" class="section level3">
<h3><span class="header-section-number">19.4.2</span> Prior on the Global Scale</h3>
<p>The value of <span class="math inline">\(\tau\)</span> and the choice of its hyper-parameter has a big influence on the sparsity of the coefficients.
However, there are varying suggestions for how to set this. <span class="citation">(Carvalho, Polson, and Scott 2009, @PolsonScott2011a, @PasKleijnVaart2014a)</span>.</p>
<p>Shrinkage can be understood as its influence on the number of effective parameters, <span class="math inline">\(m_{eff}\)</span> <span class="citation">(Piironen and Vehtari 2016)</span>,
<span class="math display">\[
m_{\text{eff}} = \sum_{j = 1}^K (1 - \kappa_j) .
\]</span></p>
<ul>
<li><p>This is a measure of model complexity or model size</p></li>
<li><p>However, the interpretation as the “number of non-zero parameters” is less meaningful when the</p></li>
<li><p>The values of <span class="math inline">\(\kappa_i\)</span> can be used for thresholding. Carvalho et al suggest
a decision rule of selecting variables where <span class="math inline">\(\kappa_k &gt; 1 / 2\)</span>.</p></li>
</ul>
<p>I have not seen it described elsewhere, but the level of sparsification can be
summarized by comparing the variance of <span class="math inline">\(\kappa_k\)</span> given <span class="math inline">\(m_eff\)</span> to the case where all
<span class="math inline">\(kappa_k \in \{0, 1\}\)</span>. If all <span class="math inline">\(\kappa_k\)</span> are zero or one, then
<span class="math display">\[
s_{\text{eff}} = \frac{\sum(\kappa_k - m_{\text{eff}} / K)^2}{(m_{\text{eff}} / K) (1 - m_{\text{eff}} / K)}
\]</span>
If <span class="math inline">\(s_{eff} = 1\)</span>, then all <span class="math inline">\(\kappa_{k}\)</span> are one or zero; if <span class="math inline">\(s_{eff} = 0\)</span>, the all
<span class="math inline">\(\kappa_{k} = m_{eff} / K\)</span> (uniform shrinkage as with a normal prior).</p>
<p>If the prior can be represented as a scale mixture of normal distributions,
then the the mean and variance of <span class="math inline">\(m_{eff}\)</span> are
<span class="math display">\[
\begin{aligned}[t]
\E[m_{\text{eff}} | \tau, \sigma] &amp;= \sum_{k = 1}^{K} \frac{a_k}{1 + a_k} , \\
\Var[m_{\text{eff}} | \tau, \sigma] &amp;= \sum_{k = 1}^{K} \frac{a_k}{2 \left(1 + a_k \right)^2} .
\end{aligned}
\]</span>
where <span class="math inline">\(a_k = \sigma^{-1} \tau \sqrt{n} s_k\)</span> <span class="citation">(Piironen and Vehtari 2017)</span>.</p>
<p>The prior should be chosen so that the prior mass is located near
<span class="math display">\[
\tau_0 = \frac{k_0}{K - k_0}\frac{\sigma}{\sqrt{n}} .
\]</span>
where <span class="math inline">\(k_0\)</span> is a guess as to the number of non-zero coefficients.
Note that the choice of <span class="math inline">\(\tau\)</span> must scale with the observation noise <span class="math inline">\(\sigma\)</span> and the number of observations <span class="math inline">\(n\)</span>.</p>
<p>Calculate the shrinkage factor <span class="math inline">\(\kappa_k\)</span> given <span class="math inline">\(n\)</span>, <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(\tau\)</span>,
<span class="math inline">\(sd_x\)</span>, and <span class="math inline">\(\lambda_k\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">shrinkage_factor &lt;-<span class="st"> </span><span class="cf">function</span>(n, <span class="dt">lambda =</span> <span class="dv">1</span>, <span class="dt">tau =</span> <span class="dv">1</span>, <span class="dt">sigma =</span> <span class="dv">1</span>, <span class="dt">sd_x =</span> <span class="dv">1</span>) {
  <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n <span class="op">*</span><span class="st"> </span>tau <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sd_x <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>lambda <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>sigma <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
}</code></pre>
<p>Choose $</p>
<pre class="sourceCode r"><code class="sourceCode r">optimal_tau &lt;-<span class="st"> </span><span class="cf">function</span>(k0, K, n, <span class="dt">sigma =</span> <span class="dv">1</span>) {
  k0 <span class="op">/</span><span class="st"> </span>(K <span class="op">-</span><span class="st"> </span>k0) <span class="op">*</span><span class="st"> </span>sigma <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)
}</code></pre>
</div>
</div>
<div id="differences-between-bayesian-and-penalized-ml" class="section level2">
<h2><span class="header-section-number">19.5</span> Differences between Bayesian and Penalized ML</h2>
<p>There are several differences between Bayesian approaches to shrinkage and penalized ML approaches.</p>
<p>The point estimates:</p>
<ul>
<li>ML: mode</li>
<li>Bayesian: posterior mean (or median)</li>
</ul>
<p>In Lasso</p>
<ul>
<li>ML: the mode produces exact zeros and sparsity</li>
<li>Bayesian: posterior mean is not sparse (zero)</li>
</ul>
<p>Choosing the shrinkage penalty:</p>
<ul>
<li>ML: cross-validation</li>
<li>Bayesian: a prior is placed on the shrinkage penalty, and it is estimated as part of the posterior.</li>
</ul>
</div>
<div id="examples-3" class="section level2">
<h2><span class="header-section-number">19.6</span> Examples</h2>
<div id="diabetes" class="section level3">
<h3><span class="header-section-number">19.6.1</span> Diabetes</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;diabetes&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;lars&quot;</span>)</code></pre>
<p>The <code>diabetes</code> data has 442 observations (from Efron, Hastie, Johnston, Tibshirani 2003 LARS paper).
The data are provided as matrices, with <code>x</code> a matrix with 10 columns, <code>y</code> a
numeric vector with the response, and and <code>x2</code> a matrix with 64 columns (<code>x</code> plus interactions.
The matrix <code>x</code> has been standardized to have zero mean and unit variance.</p>
<div id="penalized-regression" class="section level4">
<h4><span class="header-section-number">19.6.1.1</span> Penalized Regression</h4>
<p>Before turning to full Bayesian estimation, we can produce MAP estimates for the model for the following:</p>
<ol style="list-style-type: decimal">
<li>Flat priors</li>
<li>Ridge regression/Normal priors/L2 penalty</li>
<li>Lasso regresssion/Laplace (double exponential) priors/L1 penalty</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r">diabetes_map_lm &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> diabetes)
diabetes_map_ridge &lt;-<span class="st"> </span><span class="kw">glmnet</span>(diabetes<span class="op">$</span>x, diabetes<span class="op">$</span>y, <span class="dt">alpha =</span> <span class="dv">1</span>)
diabetes_map_lasso &lt;-<span class="st"> </span><span class="kw">glmnet</span>(diabetes<span class="op">$</span>x, diabetes<span class="op">$</span>y, <span class="dt">alpha =</span> <span class="dv">0</span>)</code></pre>
<p>Note that even <code>x</code> was a matrix, we can use it on the right-hand-side of the formula, and the formula object knows to use the columns of it.</p>
<p>By default <code>glmnet</code> estimates the coefficients for the range of the shrinkage penalty <span class="math inline">\(\lambda\)</span>.
The sequence of values of a coefficient for values of <span class="math inline">\(\lambda\)</span> from <span class="math inline">\(\lambda = 0\)</span> (no shrinkage) to <span class="math inline">\(\lambda \approx \infty\)</span> (large enough that all coefficients are zero) is called the coefficient path.</p>
<p>The <code>plot</code> method for the <code>glmnet</code> objects returned by <code>glmnet()</code> will plot coefficient paths.
Here I will extract the data using <code>broom::tidy()</code> and plot them with <code>ggplot()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">diabetes_coefpaths &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(
  <span class="kw">mutate</span>(<span class="kw">tidy</span>(diabetes_map_lasso), <span class="dt">model =</span> <span class="st">&quot;Lasso (L1)&quot;</span>),
  <span class="kw">mutate</span>(<span class="kw">tidy</span>(diabetes_map_ridge), <span class="dt">model =</span> <span class="st">&quot;Ridge (L2)&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(term <span class="op">!=</span><span class="st"> &quot;(Intercept)&quot;</span>) </code></pre>
<pre class="sourceCode r"><code class="sourceCode r">diabetes_coefpaths <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="op">-</span><span class="kw">log</span>(lambda), <span class="dt">y =</span> estimate, <span class="dt">group =</span> term)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>model, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(<span class="op">-</span><span class="kw">log</span>(lambda)), <span class="dt">y =</span> <span class="kw">expression</span>(beta))</code></pre>
<p><img src="regression-shrinkage_files/figure-html/unnamed-chunk-11-1.png" width="70%" style="display: block; margin: auto;" />
Note that the <span class="math inline">\(\lambda\)</span> penalties are on different scales in the Lasso and ridge regession.
Nevertheless we see that the ridge regression coefficients smoothly converge towards zero as <span class="math inline">\(- \log(\lambda) \to 0\)</span>, while the lasso coefficients eventually hit zero and then are set to zero.</p>
<p>To put them on the same scale, instead of plotting the coefficient paths vs. <span class="math inline">\(\lambda\)</span>
we could instead plot it against the percent of deviance explained.</p>
<pre class="sourceCode r"><code class="sourceCode r">diabetes_coefpaths <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dev.ratio, <span class="dt">y =</span> estimate, <span class="dt">group =</span> term)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>model, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(<span class="st">&quot;% Deviance&quot;</span>), <span class="dt">y =</span> <span class="kw">expression</span>(beta))</code></pre>
<p><img src="regression-shrinkage_files/figure-html/unnamed-chunk-12-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>However, <code>glmnet</code> does not choose a value of <code>lambda</code>.
To choose a particular value of <code>lambda</code> using K-fold cross-validation, use <code>cv.glmnet</code>.
I will use the default value of 10 folds.</p>
<pre class="sourceCode r"><code class="sourceCode r">diabetes_ridge_cv &lt;-<span class="st"> </span><span class="kw">cv.glmnet</span>(diabetes<span class="op">$</span>x, diabetes<span class="op">$</span>y, <span class="dt">alpha =</span> <span class="dv">0</span>, 
                               <span class="dt">nfolds =</span> <span class="dv">10</span>, <span class="dt">parallel =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt; Warning: executing %dopar% sequentially: no parallel backend registered</span></code></pre>
<p>This plots the values of <span class="math inline">\(\lambda\)</span>, the MSE (and its standard error) and the lines
indicate the <span class="math inline">\(\lambda\)</span> with the lowest MSE and the one chosen by the 1-standard deviation rule.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(diabetes_ridge_cv)</code></pre>
<p><img src="regression-shrinkage_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Similarly for lasso.</p>
<pre class="sourceCode r"><code class="sourceCode r">diabetes_lasso_cv &lt;-<span class="st"> </span><span class="kw">cv.glmnet</span>(diabetes<span class="op">$</span>x, diabetes<span class="op">$</span>y, <span class="dt">alpha =</span> <span class="dv">1</span>, 
                               <span class="dt">nfolds =</span> <span class="dv">10</span>, <span class="dt">parallel =</span> <span class="ot">TRUE</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(diabetes_lasso_cv)</code></pre>
<p><img src="regression-shrinkage_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>For the optimal <span class="math inline">\(\lambda\)</span>, Lasso produces the following number of non-zero coefficients:</p>
<pre class="sourceCode r"><code class="sourceCode r">lasso_nonzeros &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">se =</span> <span class="ot">TRUE</span>) {
  lambdahat &lt;-<span class="st"> </span><span class="cf">if</span> (se) <span class="st">&quot;lambda.1se&quot;</span> <span class="cf">else</span> <span class="st">&quot;lambda.min&quot;</span>
  <span class="kw">unname</span>(x<span class="op">$</span>nzero[<span class="kw">which</span>(x<span class="op">$</span>lambda <span class="op">==</span><span class="st"> </span>x[[lambdahat]])])
}
<span class="kw">lasso_nonzeros</span>(diabetes_lasso_cv)
<span class="co">#&gt; [1] 5</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">get_glmnet_coef &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  lambdahat &lt;-<span class="st"> &quot;lambda.1se&quot;</span>
  coefpaths &lt;-<span class="st"> </span><span class="kw">tidy</span>(x[[<span class="st">&quot;glmnet.fit&quot;</span>]])
  <span class="kw">filter</span>(coefpaths, lambda <span class="op">==</span><span class="st"> </span>x[[lambdahat]])
}</code></pre>
<p>OLS, lasso, and ridge point estimates.
Coefficients are ordered in descending value of <span class="math inline">\(|\hat{\beta}_{OLS}|\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bind_rows</span>(
  <span class="kw">mutate</span>(<span class="kw">tidy</span>(diabetes_map_lm), <span class="dt">model =</span> <span class="st">&quot;OLS&quot;</span>),
  <span class="kw">mutate</span>(<span class="kw">get_glmnet_coef</span>(diabetes_ridge_cv), <span class="dt">model =</span> <span class="st">&quot;ridge&quot;</span>),
  <span class="kw">mutate</span>(<span class="kw">get_glmnet_coef</span>(diabetes_lasso_cv), <span class="dt">model =</span> <span class="st">&quot;lasso&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">term =</span> <span class="kw">if_else</span>(model <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;OLS&quot;</span>),
                        <span class="kw">str_replace</span>(term, <span class="st">&quot;^x&quot;</span>, <span class="st">&quot;&quot;</span>), term)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(model, term, estimate) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">complete</span>(model, term, <span class="dt">fill =</span> <span class="kw">list</span>(<span class="dt">estimate =</span> <span class="dv">0</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>term <span class="op">%in%</span><span class="st"> &quot;(Intercept)&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">term =</span> <span class="kw">fct_reorder</span>(term, <span class="kw">if_else</span>(model <span class="op">==</span><span class="st"> &quot;OLS&quot;</span>, 
                                          <span class="kw">abs</span>(estimate), <span class="ot">NA_real_</span>),
                            mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> term, <span class="dt">y =</span> estimate, <span class="dt">colour =</span> model)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">hat</span>(beta)), <span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</code></pre>
<p><img src="regression-shrinkage_files/figure-html/unnamed-chunk-19-1.png" width="70%" style="display: block; margin: auto;" />
Note that while <code>tc</code> has the largest OLS point estimate, both ridge and lasso
estimate it to be approximately zero.
For the <code>hdl</code> coefficient, the lasso and ridge estimates have a different sign than OLS
and are larger in magnitude.</p>
</div>
<div id="full-bayes" class="section level4">
<h4><span class="header-section-number">19.6.1.2</span> Full Bayes</h4>
<p>We can estimate this with Stan models and rstanarm.
The rstanarm models are faster.
However, at the moment rstanarm does not provide ridge regression.
Additionally, the Stan models provided will also return the shrinkage parameters,
effective number of parameters, and local scales.</p>
<div id="stan-models" class="section level5">
<h5><span class="header-section-number">19.6.1.2.1</span> Stan models</h5>
<ol style="list-style-type: decimal">
<li>Weakly informative priors</li>
<li>Shrinkage with normal priors</li>
<li>Shrinkage with Student t priors</li>
<li>Shrinkage with Laplace priors</li>
<li>Shrinkage with Horseshoe priors</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r">model_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;lm_normal_1&quot;</span>,
                 <span class="st">&quot;lm_shrinkage_normal_1&quot;</span>,
                 <span class="st">&quot;lm_shrinkage_student_t_1&quot;</span>,
                 <span class="st">&quot;lm_shrinkage_laplace_1&quot;</span>,
                 <span class="st">&quot;lm_shrinkage_hs&quot;</span>)
models &lt;-<span class="st"> </span><span class="kw">map</span>(model_names, <span class="cf">function</span>(nm) {
  <span class="kw">stan_model</span>(<span class="kw">file.path</span>(<span class="st">&quot;stan&quot;</span>, <span class="kw">str_c</span>(nm, <span class="st">&quot;.stan&quot;</span>)))
})
<span class="co">#&gt; hash mismatch so recompiling; make sure Stan code ends with a blank line</span>
<span class="co">#&gt; In file included from filed8cb12469916.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:1:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Core:531:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb12469916.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:2:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/LU:47:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb12469916.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:3:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Cholesky:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Jacobi:29:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb12469916.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:3:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Cholesky:43:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb12469916.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/QR:17:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Householder:27:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb12469916.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:5:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SVD:48:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb12469916.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Geometry:58:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb12469916.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:7:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Eigenvalues:58:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb12469916.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:26:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SparseCore:66:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb12469916.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:27:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/OrderingMethods:71:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb12469916.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:29:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SparseCholesky:43:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb12469916.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:32:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SparseQR:35:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb12469916.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:33:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/IterativeLinearSolvers:46:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; 13 warnings generated.</span>
<span class="co">#&gt; In file included from filed8cbdf0834b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:1:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Core:531:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbdf0834b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:2:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/LU:47:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbdf0834b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:3:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Cholesky:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Jacobi:29:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbdf0834b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:3:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Cholesky:43:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbdf0834b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/QR:17:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Householder:27:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbdf0834b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:5:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SVD:48:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbdf0834b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Geometry:58:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbdf0834b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:7:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Eigenvalues:58:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbdf0834b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:26:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SparseCore:66:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbdf0834b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:27:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/OrderingMethods:71:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbdf0834b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:29:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SparseCholesky:43:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbdf0834b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:32:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SparseQR:35:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbdf0834b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:33:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/IterativeLinearSolvers:46:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; 13 warnings generated.</span>
<span class="co">#&gt; hash mismatch so recompiling; make sure Stan code ends with a blank line</span>
<span class="co">#&gt; In file included from filed8cbfb1fc8b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:1:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Core:531:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbfb1fc8b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:2:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/LU:47:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbfb1fc8b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:3:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Cholesky:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Jacobi:29:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbfb1fc8b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:3:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Cholesky:43:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbfb1fc8b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/QR:17:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Householder:27:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbfb1fc8b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:5:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SVD:48:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbfb1fc8b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Geometry:58:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbfb1fc8b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:7:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Eigenvalues:58:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbfb1fc8b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:26:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SparseCore:66:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbfb1fc8b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:27:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/OrderingMethods:71:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbfb1fc8b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:29:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SparseCholesky:43:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbfb1fc8b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:32:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SparseQR:35:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cbfb1fc8b.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:33:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/IterativeLinearSolvers:46:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; 13 warnings generated.</span>
<span class="co">#&gt; In file included from filed8cb6808c138.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:1:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Core:531:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb6808c138.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:2:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/LU:47:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb6808c138.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:3:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Cholesky:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Jacobi:29:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb6808c138.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:3:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Cholesky:43:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb6808c138.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/QR:17:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Householder:27:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb6808c138.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:5:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SVD:48:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb6808c138.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Geometry:58:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb6808c138.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:7:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Eigenvalues:58:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb6808c138.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:26:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SparseCore:66:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb6808c138.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:27:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/OrderingMethods:71:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb6808c138.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:29:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SparseCholesky:43:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb6808c138.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:32:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SparseQR:35:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb6808c138.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:33:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/IterativeLinearSolvers:46:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; 13 warnings generated.</span>
<span class="co">#&gt; In file included from filed8cb7e83cc69.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:1:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Core:531:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb7e83cc69.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:2:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/LU:47:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb7e83cc69.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:3:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Cholesky:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Jacobi:29:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb7e83cc69.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:3:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Cholesky:43:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb7e83cc69.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/QR:17:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Householder:27:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb7e83cc69.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:5:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SVD:48:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb7e83cc69.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Geometry:58:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb7e83cc69.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core.hpp:14:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/core/matrix_vari.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat/fun/Eigen_NumTraits.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Dense:7:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Eigenvalues:58:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb7e83cc69.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:26:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SparseCore:66:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb7e83cc69.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:27:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/OrderingMethods:71:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb7e83cc69.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:29:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SparseCholesky:43:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb7e83cc69.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:32:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/SparseQR:35:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; In file included from filed8cb7e83cc69.cpp:8:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/src/stan/model/model_header.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math.hpp:4:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/rev/mat.hpp:12:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat.hpp:83:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/StanHeaders/include/stan/math/prim/mat/fun/csr_extract_u.hpp:6:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/Sparse:33:</span>
<span class="co">#&gt; In file included from /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/IterativeLinearSolvers:46:</span>
<span class="co">#&gt; /Users/jrnold/Library/R/3.5/library/RcppEigen/include/Eigen/src/Core/util/ReenableStupidWarnings.h:10:30: warning: pragma diagnostic pop could not pop, no matching push [-Wunknown-pragmas]</span>
<span class="co">#&gt;     #pragma clang diagnostic pop</span>
<span class="co">#&gt;                              ^</span>
<span class="co">#&gt; 13 warnings generated.</span>
<span class="kw">names</span>(models) &lt;-<span class="st"> </span>model_names</code></pre>
<p>This preprocesses the data that will be used by all the models.</p>
<pre class="sourceCode r"><code class="sourceCode r">diabetes_standata &lt;-<span class="st"> </span><span class="kw">lst</span>(
  <span class="dt">X =</span> <span class="kw">scale</span>(diabetes<span class="op">$</span>x),
  <span class="dt">K =</span> <span class="kw">ncol</span>(X),
  <span class="dt">N =</span> <span class="kw">nrow</span>(X),
  <span class="dt">y =</span> <span class="kw">as.numeric</span>(<span class="kw">scale</span>(diabetes<span class="op">$</span>y)),
  <span class="dt">scale_alpha =</span> <span class="dv">10</span>,
  <span class="dt">rate_sigma =</span> <span class="dv">1</span>,
  <span class="dt">use_log_lik =</span> <span class="dv">1</span>,
  <span class="dt">use_y_rep =</span> <span class="dv">1</span>
)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">diabetes_standata_winf &lt;-<span class="st"> </span><span class="kw">within</span>(diabetes_standata, {
  scale_beta &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="fl">2.5</span>, K)
})
fit_normal &lt;-<span class="st"> </span><span class="kw">sampling</span>(models[[<span class="st">&quot;lm_normal_1&quot;</span>]],
                       <span class="dt">data =</span> diabetes_standata_winf)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">diabetes_standata_normal &lt;-<span class="st"> </span><span class="kw">within</span>(diabetes_standata, {
  df_tau &lt;-<span class="st"> </span><span class="dv">4</span>
  scale_tau &lt;-<span class="st"> </span><span class="fl">2.5</span>
})
fit_normal &lt;-<span class="st"> </span><span class="kw">sampling</span>(models[[<span class="st">&quot;lm_shrinkage_normal_1&quot;</span>]],
                       <span class="dt">data =</span> diabetes_standata_normal,
                       <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">diabetes_standata_student_t &lt;-<span class="st"> </span><span class="kw">within</span>(diabetes_standata, {
  df_tau &lt;-<span class="st"> </span><span class="dv">4</span>
  scale_tau &lt;-<span class="st"> </span><span class="dv">1</span>
  df_lambda &lt;-<span class="st"> </span><span class="dv">2</span>
})
fit_student &lt;-<span class="st"> </span><span class="kw">sampling</span>(models[[<span class="st">&quot;lm_shrinkage_student_t_1&quot;</span>]], 
                        <span class="dt">data =</span> diabetes_standata_student_t,
                        <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.99</span>, <span class="dt">max_treedepth =</span> <span class="dv">13</span>))
<span class="co">#&gt; Warning: There were 6 divergent transitions after warmup. Increasing adapt_delta above 0.99 may help. See</span>
<span class="co">#&gt; http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</span>
<span class="co">#&gt; Warning: Examine the pairs() plot to diagnose sampling problems</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">diabetes_nonzero &lt;-<span class="st"> </span><span class="kw">lasso_nonzeros</span>(diabetes_lasso_cv)

diabetes_standata_hs &lt;-<span class="st"> </span><span class="kw">within</span>(diabetes_standata, {
  scale_tau &lt;-<span class="st"> </span>diabetes_nonzero <span class="op">/</span><span class="st"> </span>(K <span class="op">-</span><span class="st"> </span>diabetes_nonzero) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(N)
  df_tau &lt;-<span class="st"> </span><span class="dv">1</span>
  df_slab &lt;-<span class="st"> </span><span class="dv">25</span>
  scale_slab &lt;-<span class="st"> </span><span class="dv">4</span>
  df_lambda &lt;-<span class="st"> </span><span class="dv">1</span>
})
fit_hs &lt;-<span class="st"> </span><span class="kw">sampling</span>(models[[<span class="st">&quot;lm_shrinkage_hs&quot;</span>]],
                   <span class="dt">data =</span> diabetes_standata_hs,
                   <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.99</span>))
<span class="co">#&gt; Warning: There were 10 divergent transitions after warmup. Increasing adapt_delta above 0.99 may help. See</span>
<span class="co">#&gt; http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</span>
<span class="co">#&gt; Warning: Examine the pairs() plot to diagnose sampling problems</span></code></pre>
</div>
<div id="rstanarm-1" class="section level5">
<h5><span class="header-section-number">19.6.1.2.2</span> rstanarm</h5>
<p>Estimate a model with a weakly informative prior.</p>
<pre class="sourceCode r"><code class="sourceCode r">fit_diabetes &lt;-<span class="st"> </span><span class="kw">list</span>()
fit_diabetes[[<span class="st">&quot;weak_inf&quot;</span>]] &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(y <span class="op">~</span><span class="st"> </span>x,
         <span class="dt">family =</span> <span class="kw">gaussian</span>(), 
         <span class="dt">prior =</span> <span class="kw">normal</span>(<span class="dt">location =</span> <span class="dv">0</span>, <span class="dt">scale =</span> <span class="fl">2.5</span>, <span class="dt">autoscale =</span> <span class="ot">TRUE</span>),
         <span class="dt">prior_intercept =</span> <span class="kw">normal</span>(<span class="dt">location =</span> <span class="dv">0</span>, <span class="dt">scale =</span> <span class="dv">10</span>, <span class="dt">autoscale =</span> <span class="ot">TRUE</span>),
         <span class="dt">prior_aux =</span> <span class="kw">exponential</span>(<span class="dt">rate =</span> <span class="dv">1</span>, <span class="dt">autoscale =</span> <span class="ot">TRUE</span>),
         <span class="dt">data =</span> diabetes, <span class="dt">refresh =</span> <span class="dv">-1</span>)</code></pre>
<p>Estimate a model using the hierarchical shrinkage prior included in <strong>rstanarm</strong>.</p>
<pre class="sourceCode r"><code class="sourceCode r">tau0 &lt;-<span class="st"> </span><span class="dv">4</span> <span class="op">/</span><span class="st"> </span>(<span class="kw">ncol</span>(diabetes<span class="op">$</span>x) <span class="op">-</span><span class="st"> </span><span class="dv">4</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">nrow</span>(diabetes<span class="op">$</span>x))
fit_diabetes[[<span class="st">&quot;hs&quot;</span>]] &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">stan_glm</span>(y <span class="op">~</span><span class="st"> </span>x,
           <span class="dt">family =</span> <span class="kw">gaussian</span>(), 
           <span class="dt">prior =</span> <span class="kw">hs</span>(<span class="dt">df =</span> <span class="dv">1</span>, 
                      <span class="dt">global_df =</span> <span class="dv">1</span>,
                      <span class="dt">global_scale =</span> tau0, 
                      <span class="dt">slab_df =</span> <span class="dv">25</span>,
                      <span class="dt">slab_scale =</span> <span class="fl">2.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(diabetes<span class="op">$</span>y)),
           <span class="dt">data =</span> diabetes)</code></pre>
<p><code>stan_glm</code>does not adjust for the scale of the outcome or covariates in the
slab.
However, if <code>slab_df</code> is set to a low value, such as the default <code>slab_df = 4</code>, the tails of the Student-t distribution are wid enough that the data can overcome the likelihood even if <code>slab_scale</code> is narrow.
If <code>slab_df</code> is set to a higher number, the narrow tails mean that <code>slab_scale</code> must be set to the a reasonable value.</p>
<p>Estimate a model with Laplace priors.</p>
<pre class="sourceCode r"><code class="sourceCode r">fit_diabetes[[<span class="st">&quot;lasso&quot;</span>]] &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(y <span class="op">~</span><span class="st"> </span>x,
                     <span class="dt">family =</span> <span class="kw">gaussian</span>(), 
                     <span class="dt">prior =</span> <span class="kw">lasso</span>(<span class="dt">df =</span> <span class="dv">1</span>, <span class="dt">location =</span> <span class="dv">0</span>, <span class="dt">scale =</span> <span class="fl">2.5</span>,
                                   <span class="dt">autoscale =</span> <span class="ot">TRUE</span>),
                     <span class="dt">prior_intercept =</span> <span class="kw">normal</span>(<span class="dt">location =</span> <span class="dv">0</span>, <span class="dt">scale =</span> <span class="dv">10</span>),
                     <span class="dt">prior_aux =</span> <span class="kw">exponential</span>(<span class="dt">rate =</span> <span class="dv">1</span>, <span class="dt">autoscale =</span> <span class="ot">TRUE</span>),
                     <span class="dt">data =</span> diabetes)</code></pre>
</div>
</div>
</div>
<div id="example-4" class="section level3">
<h3><span class="header-section-number">19.6.2</span> Example</h3>
<p>Some fake sparse data[^sparse-fake]</p>
<pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">100</span>
p &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co"># number of variables</span>
s &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co"># number of variables with non-zero coefficients</span>
X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n <span class="op">*</span><span class="st"> </span>p), <span class="dt">ncol =</span> p)
beta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">5</span>, s), <span class="kw">rep</span>(<span class="dv">0</span>, p <span class="op">-</span><span class="st"> </span>s))
Y &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>beta <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n)</code></pre>
</div>
</div>
<div id="shrinkage-with-correlated-variables" class="section level2">
<h2><span class="header-section-number">19.7</span> Shrinkage with Correlated Variables</h2>
<p>Up until now, the various approaches modeled regression coefficients hieararchically,
but did not account for correlations between them.
In many cases, theoretical results for them rely upon assuming uncorrelated predictors.</p>
<p>In the MAP case:</p>
<ul>
<li>ridge regression will shrink both correlated variables</li>
<li>lasso will arbitrary shrink one regression</li>
</ul>
<p>In full Bayes, highly correlated variables can produce posteriors that are harder
to sample from. For example, producing divergences.</p>
<p>Some alternative models for correlated variables.</p>
<ul>
<li>using the PCA transformation of <span class="math inline">\(X\)</span> and using the previous</li>
<li><code>rstanarm::stan_lm</code> will shrink the regression QR decomposition by a</li>
<li>Zellner’s g-prior</li>
</ul>
</div>
<div id="variable-selection" class="section level2">
<h2><span class="header-section-number">19.8</span> Variable Selection</h2>
<p>Variable selection is closely related to sparse shrinkage methods.
Sparse shrinkage methods can be seen as offering an alternative.</p>
<p>Can sparse shrinkage estimators do variable selection? It depends on the
what estimator is being used.</p>
<ul>
<li>MAP - posterior mode. Yes, it can se some coefficients to zero.</li>
<li>Posterior mean. No, it only shrinks them.</li>
</ul>
<p>Note that the shrinkage/not selection properties of the posterior mean also
applied to BMA and the mixture methods.
They will assign some probability to both zero and non-zero values of each coefficient values, so the posterior mean will (almost certainly) be non-zero, even if the posterior includes a point mass at zero.</p>
<p>However, we can calculate the posterior distribution and then use a second step to decide on the “sparse” model.</p>
<ul>
<li>HPD: select the combination of coefficients with the highest posterior density (BMA, spike-and-slab).</li>
<li>MPD: select any variables where the median of the probability of inclusion is greater than 0.5 (BMA, spike-and-slab).</li>
<li>Ad hoc-rule for horseshoe priro: select if <span class="math inline">\(\kappa_k &lt; 0.5\)</span> (Datta and Ghosh). This is the equivalent of the MPD rule.</li>
<li>Decision problem: e.g. projpred, and Hahn and Carvalho.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="shrinkage-and-hierarchical-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multilevel-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jrnold/bayesian_notes/edit/master/regression-shrinkage.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
